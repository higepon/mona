ひげぽん<><>02/07/19 21:10<> 独自にOSを作っているまたは、作ろうとしている人たちのための <br> スレッドになればと思います。 <br>  <br> 前スレッド <br> OSをつくろうpart2 <br> http://pc3.2ch.net/test/read.cgi/tech/1024411711/ <>OSをつくろうpart3
ひげぽん<><>02/07/19 21:10<>  <br> 早速ですが、 <br> 現在のhigeposのステータスは、 <br> firstboot　ブート開始＆secondboot以降をディスクからメモリに読み込んでjmp <br> secondboot　プロテクトモードへ移行＆third部にjmp <br> third　Cでソースを書いてコンパイル＆リンク return 'A';してaxレジスタに反映されることを確認 <br>  <br> を試みているのだが <br> third部にjmpするとBochsが異常終了してしまう。 <br>  <br> third部をアセンブラで書いた場合は通常に実行される(third.asm) <br> またうまくいかないCから作成されたバイナリファイルを <br> 逆アセンブルすると出てくるものには、mox eax, ???以外の命令がある。 <br> その命令のせいで不正終了しているのではと思っています。 <br>  <br> なお現在の動かない最新のソースは↓にuploadしました。 <br>  <br> http://oshigepon.tripod.co.jp/ <br>  <br> どなたかお知恵を拝借させて下さい。 <>
デフォルトの名無しさん<>sage<>02/07/19 21:36<> &gt;ひげぽん <br> kernel.cは16bitのコードを生成してるだろ？ <>
ひげぽん<>sage<>02/07/19 21:38<> <a href="../test/read.cgi/tech/1027080631/3" target="_blank">&gt;&gt;3</a> <br> ${CC}&nbsp;-c&nbsp;-ffreestanding&nbsp;-Wall&nbsp;higepos_kernel.c&nbsp;-o&nbsp;${BIN}/higepos_kernel.o <br> gccは32bitコンパイラだと思っていたのですが、16bitコードを吐くんですか？ <>
デフォルトの名無しさん<>sage<>02/07/19 21:52<> プロテクトモードに移行できてないのは気のせい？ <>
ひげぽん<>sage<>02/07/19 21:57<> 多分出来ていると思います。↓ <br> 0153320000i[CPU&nbsp;&nbsp;]&nbsp;protected&nbsp;mode <br> 0153320000i[CPU&nbsp;&nbsp;]&nbsp;CS.d_b&nbsp;=&nbsp;32&nbsp;bit <br> 0153320000i[CPU&nbsp;&nbsp;]&nbsp;SS.d_b&nbsp;=&nbsp;32&nbsp;bit <br> 0153320000i[CPU&nbsp;&nbsp;]&nbsp;|&nbsp;EAX=60000068&nbsp;&nbsp;EBX=00000000&nbsp;&nbsp;ECX=00150002&nbsp;&nbsp;EDX=00000000 <br> 0153320000i[CPU&nbsp;&nbsp;]&nbsp;|&nbsp;ESP=00001000&nbsp;&nbsp;EBP=00000000&nbsp;&nbsp;ESI=000000ee&nbsp;&nbsp;EDI=000b8006 <br> 0153320000i[CPU&nbsp;&nbsp;]&nbsp;|&nbsp;IOPL=0&nbsp;NV&nbsp;UP&nbsp;DI&nbsp;PL&nbsp;NZ&nbsp;NA&nbsp;PE&nbsp;NC <br> 0153320000i[CPU&nbsp;&nbsp;]&nbsp;|&nbsp;SEG&nbsp;selector&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;&nbsp;&nbsp;&nbsp;limit&nbsp;G&nbsp;D <br> 0153320000i[CPU&nbsp;&nbsp;]&nbsp;|&nbsp;SEG&nbsp;sltr(index|ti|rpl)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;&nbsp;&nbsp;&nbsp;limit&nbsp;G&nbsp;D <br> 0153320000i[CPU&nbsp;&nbsp;]&nbsp;|&nbsp;&nbsp;DS:0010(&nbsp;0002|&nbsp;0|&nbsp;&nbsp;0)&nbsp;00000000&nbsp;000fffff&nbsp;1&nbsp;1 <br> 0153320000i[CPU&nbsp;&nbsp;]&nbsp;|&nbsp;&nbsp;ES:0010(&nbsp;0002|&nbsp;0|&nbsp;&nbsp;0)&nbsp;00000000&nbsp;000fffff&nbsp;1&nbsp;1 <br> 0153320000i[CPU&nbsp;&nbsp;]&nbsp;|&nbsp;&nbsp;FS:0000(&nbsp;0000|&nbsp;0|&nbsp;&nbsp;0)&nbsp;00000000&nbsp;0000ffff&nbsp;0&nbsp;0 <br> 0153320000i[CPU&nbsp;&nbsp;]&nbsp;|&nbsp;&nbsp;GS:0000(&nbsp;0000|&nbsp;0|&nbsp;&nbsp;0)&nbsp;00000000&nbsp;0000ffff&nbsp;0&nbsp;0 <br> 0153320000i[CPU&nbsp;&nbsp;]&nbsp;|&nbsp;&nbsp;SS:0018(&nbsp;0003|&nbsp;0|&nbsp;&nbsp;0)&nbsp;00000000&nbsp;00000000&nbsp;1&nbsp;1 <br> 0153320000i[CPU&nbsp;&nbsp;]&nbsp;|&nbsp;&nbsp;CS:0008(&nbsp;0001|&nbsp;0|&nbsp;&nbsp;0)&nbsp;00000000&nbsp;000fffff&nbsp;1&nbsp;1 <>
デフォルトの名無しさん<><>02/07/19 22:27<> OSをつくろうpart1ってないの？ <>
デフォルトの名無しさん<>sage<>02/07/19 22:31<> 俺も思た <>
デフォルトの名無しさん<>sage<>02/07/19 22:31<> <a href="../test/read.cgi/tech/1027080631/2" target="_blank">&gt;&gt;2</a> <br> gccでコンパイルしてオブジェクトファイルにした物を <br> そのままcatしても起動できないのは当たり前。 <br> -cでコンパイルした物は単なるcoff形式のオブジェクトファイルだから。 <>
デフォルトの名無しさん<>sage<>02/07/19 22:34<> <a href="../test/read.cgi/tech/1027080631/4" target="_blank">&gt;&gt;4</a> <br> kernel.o をそのままロードしてるの ? リンクは ? ヘッダーの除去は ? <br> できたらロードしてるバイナリもアップした方が助言しやすいと思う。 <>
9<>sage<>02/07/19 22:36<> gcc -c -ffreestanding -Wall kernel.c <br> strip --output-target=binary kernel.o <br> でどうかな？ <br>  <>
デフォルトの名無しさん<>sage<>02/07/19 22:54<> なぜに strip を使うのか。 <br>  <>
9<>sage<>02/07/19 22:59<> シンボルとセクションを除去して、生のバイナリを吐き出させるため。 <>
9<>sage<>02/07/19 23:01<> &gt;gcc -c -ffreestanding -Wall higepos_kernel.c <br> &gt;strip --output-format=binary higepos_kernel.o <br> &gt;ndisasmw -u higepos_kernel.o <br> 00000000  55                push ebp <br> 00000001  89E5              mov ebp,esp <br> 00000003  B861000000        mov eax,0x61 <br> 00000008  5D                pop ebp <br> 00000009  C3                ret <br> 0000000A  90                nop <br> 0000000B  90                nop <br>  <br> 実行結果がこうなるんで、問題ないと思うが、いかが？ <>
ひげぽん<>sage<>02/07/19 23:20<> <a href="../test/read.cgi/tech/1027080631/14" target="_blank">&gt;&gt;14</a>(9) <br> bochsが↓というエラー出しながら異常終了してしまいます。 <br> 00000232034e[CPU  ] prefetch: running in bogus memory <br>  <br> ${CC}&nbsp;-c&nbsp;-ffreestanding&nbsp;-Wall&nbsp;higepos_kernel.c&nbsp;-o&nbsp;${BIN}/higepos_kernel.o <br> #${LD}&nbsp;--oformat&nbsp;binary&nbsp;-Ttext&nbsp;0x200&nbsp;-o${THIRD}&nbsp;${BIN}/higepos_kernel.o <br> ${STRIP}&nbsp;--output-target=binary&nbsp;${BIN}/higepos_kernel.o&nbsp;-o&nbsp;${THIRD} <br> ${NDISASM}&nbsp;-u&nbsp;$@&nbsp;&gt;${LIST}/third_disasm.asm <br>  <br> make と　ndisasmの結果です。 <br> 00000000&nbsp;&nbsp;55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;ebp <br> 00000001&nbsp;&nbsp;89E5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;ebp,esp <br> 00000003&nbsp;&nbsp;B861000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;eax,0x61 <br> 00000008&nbsp;&nbsp;5D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pop&nbsp;ebp <br> 00000009&nbsp;&nbsp;C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret <br> 0000000A&nbsp;&nbsp;8DB600000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lea&nbsp;esi,[esi+0x0] <>
ひげぽん<>sage<>02/07/19 23:38<> 上のエラーと関係があるかは分かりませんが、 <br> ひとつどうしても納得いかない点があるので質問させてください。 <br>  <br> 前提知識としてブート部のサイズは以下の通りです。 <br> firstboot 　512byte <br> secondboot　512byte <br>  <br> firstbootでは、2セクタ目から18セクタ分 0x100に読み込んでいます。 <br> そのためsecondbootにjmpするときには <br> jmp 0x100:0000 <br> のようにしています。 <br>  <br> secondbootからthirdにjmpするときには、0x100+ 512 = 0x300 <br> と指定していました。 <br> しかしこれだとexceptionがあがるので <br> 0x200を指定したところうまくいきました。 <br> なんだか計算が合わない気がするのですが、どこで間違っているのでしょうか。 <br>  <>
デフォルトの名無しさん<>sage<>02/07/19 23:47<> 一応貼っておこうよ。 <br> http://oshigepon.tripod.co.jp/ <>
ひげぽん<>sage<>02/07/19 23:48<> <a href="../test/read.cgi/tech/1027080631/17" target="_blank">&gt;&gt;17</a> <br> ありがとう。忘れてました。 <>
17<>sage<>02/07/19 23:50<> っつうか、<a href="../test/read.cgi/tech/1027080631/2" target="_blank">&gt;&gt;2</a>で貼ってあるね。スマソ。 <>
デフォルトの名無しさん<><>02/07/20 00:02<> すごい。いきおいだなこのスレッド。 <br> がんばれひげぽん+名無しさん <>
デフォルトの名無しさん<>sage<>02/07/20 00:05<> DJGPP <br> http://www.delorie.com/djgpp/ <br>  <br> NASM <br> http://sourceforge.net/projects/nasm/ <br>  <br> ひげぽんはこの2つを使ってるってことでOK？ <>
デフォルトの名無しさん<>sage<>02/07/20 00:07<> &gt;16 <br> 何かがおかしい。 <br>  <br> jmp 0x100:0000 はリニアアドレス 0x1000 のはず。 <br> 0x200 byte が second なら 0x1200 から third か？ <br> なら jmp 0x200 であってる。 <br> jmp 0x100:0000 で 0x1000 にセグメントを置きなおしてるから。 <br> なぜに 0x100 + 512 なのか？ <br>  <>
ひげぽん<><>02/07/20 00:09<> <a href="../test/read.cgi/tech/1027080631/21" target="_blank">&gt;&gt;21</a> <br> ありがとう。 <br> Bochs <br> http://bochs.sourceforge.net <br> も追加しておきます。 <>
デフォルトの名無しさん<>sage<>02/07/20 00:09<> <a href="../test/read.cgi/tech/1027080631/16" target="_blank">&gt;&gt;16</a> <br> 0x200で上手くいったのは [org 0x100]を指定していないからだろ。 <br> orgを指定すれば 0x300で上手く行くだろうに。 <>
ひげぽん<><>02/07/20 00:11<> <a href="../test/read.cgi/tech/1027080631/22" target="_blank">&gt;&gt;22</a> <br> jmp 0x100:0000 はリニアアドレス 0x1000 のはず。  <br> &gt;0x200 byte が second なら 0x1200 から third か？  <br> &gt;なら jmp 0x200 であってる。  <br> &gt;jmp 0x100:0000 で 0x1000 にセグメントを置きなおしてるから。  <br> &gt;なぜに 0x100 + 512 なのか？  <br> すいません。 <br> 一瞬で自分の勘違いを理解しました。 <br> かなり赤面の勘違いです。 <br> ご指摘ありがとうございました。 <br>  <br>  <>
デフォルトの名無しさん<>sage<>02/07/20 00:13<> <a href="../test/read.cgi/tech/1027080631/22" target="_blank">&gt;&gt;22</a>をみて気づいたが、ひげぽんにつられて俺も間違えちまった。 <br> <a href="../test/read.cgi/tech/1027080631/24" target="_blank">&gt;&gt;24</a>は、 [org 0x1000] で、 jmp 先は 0x1200 だな。 <br> まあ org と jmp 先アドレスがちょうど 0x200ずれてれば上手く行っちゃうんだけど、、、。 <>
ひげぽん<><>02/07/20 00:14<> お詫びに最近の私のお気に入りを提供します。 <br>  <br> http://www.osdev.org/cgi-bin/projects.cgi <br> たくさんのOS開発プロジェクトへのリンク集です。 <br> 多くのプロジェクトはソースを公開していて大変勉強になります。 <br> もちろん英語ですが･･･ <>
ひげぽん<><>02/07/20 00:16<> ひとつ疑問が解決したのですっきりしました。 <br> もうひとつのほうは、いまだ解決しておりません。 <br> 明日がんばってみます。 <>
デフォルトの名無しさん<>sage<>02/07/20 00:18<> #define VRAM ((char*)0xB8000) <br>  <br> void hige(void) { <br> VRAM[0] = '2'; <br> VRAM[2] = 'c'; <br> VRAM[4] = 'h'; <br> for(;;); <br> } <br>  <br> ひげぽん、動いたよ。 <br> エラーになったのは、returnで処理を返していたからだろ。 <br> キッチリhangしないとﾀﾞﾒﾎﾟ <br>  <>
デフォルトの名無しさん<>sage<>02/07/20 00:19<> <a href="../test/read.cgi/tech/1027080631/28" target="_blank">&gt;&gt;28</a> <br> もうひとつのほうとは？ <>
デフォルトの名無しさん<>sage<>02/07/20 00:19<> &gt;22 <br> 相対じゃなかったか、とか言うのは？ <br>  <br> ↓のが良いと思う。 <br>  <br>         jmp  _third <br>         times 512-($-$$) db 0 <br> _third: <br>  <>
ひげぽん<>sage<>02/07/20 00:20<> まだ、だいぶ先の話だとは思うのですが、 <br> OSの設計･開発を本気で始めるときに <br> 共同開発者や、協力者ってどう集めればいいんでしょうか？ <br> source forgeみたいなところで、まずはきちんとプロジェクトとして <br> 始動しておいたほうが良いのでしょうか？ <>
ひげぽん<>sage<>02/07/20 00:25<> <a href="../test/read.cgi/tech/1027080631/29" target="_blank">&gt;&gt;29</a> <br> ありがとう！！！！ <br> できましたよ。 <br> 今日は遅いので明日ちょっと改良してアップロードさせて <br> いただきます。 <br>  <br> すごいやる気が出てきました。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/30" target="_blank">&gt;&gt;30</a> <br> ↑解決しました。 <br> <a href="../test/read.cgi/tech/1027080631/31" target="_blank">&gt;&gt;31</a> <br> ありがとう。それも試してみます。 <br>  <>
デフォルトの名無しさん<>sage<>02/07/20 00:30<> ちょとリフェガメつくてみた。 <br> -------- <br> typedef short word; <br> typedef char  byte; <br>  <br> #define MAX_HEIGHT   24 <br> #define MAX_WIDTH    80 <br> #define VRAM         ((byte *)0xb8000L) <br> #define BUFF         ((word *)0x08000L) <br> #define AT(X,Y)      ((X)+(Y)*80) <br>  <br> void copy_buff() <br> { <br>   int i; <br>   for(i=0;i&lt;MAX_HEIGHT*MAX_WIDTH;i++){ <br>     VRAM[i*2]=BUFF[i]; <br>   } <br>  <br> } <br>  <br> void buff_clean() <br> { <br>   int i; <br>   for(i=0;i&lt;MAX_HEIGHT*MAX_WIDTH;i++){ <br>     BUFF[i]=' '; <br>   } <br> } <br>  <br> void init() <br> { <br>     BUFF[AT(4,4)]='*'; <br>     BUFF[AT(4,5)]='*'; <br>     BUFF[AT(4,6)]='*'; <br>  <br>     BUFF[AT(41,10)]='*'; <br>     BUFF[AT(42,10)]='*'; <br>     BUFF[AT(40,11)]='*'; <br>     BUFF[AT(41,11)]='*'; <br>     BUFF[AT(41,12)]='*'; <br> } <br>  <br>  <>
デフォルトの名無しさん<>sage<>02/07/20 00:30<> つづき <br> ------ <br> int count(int p) <br> { <br>   int i,c; <br>  <br> #if 0 <br>   int around[8]={-81,-80,-79,-1,1,79,80,81}; /* こうしたいところだが */ <br> #else <br>   int around[8];      /* こうしないと上手く行かない */ <br>   around[0]=-81; <br>   around[1]=-80; <br>   around[2]=-79; <br>   around[3]=-1; <br>   around[4]=1; <br>   around[5]=79; <br>   around[6]=80; <br>   around[7]=81; <br> #endif <br>  <br>   for(i=c=0;i&lt;8;i++) <br>     if(VRAM[(around[i]+p)*2]=='*') <br>       c++; <br>   return c; <br>  <br> } <br>  <br> void update() <br> { <br>   int x,y; <br>   for(y=1;y&lt;MAX_HEIGHT-1;y++) <br>     for(x=1;x&lt;MAX_WIDTH-1;x++){ <br>       int c=count(AT(x,y)); <br>       if(c==3 || (c==2 && VRAM[AT(x,y)*2]=='*')) <br> BUFF[AT(x,y)]='*'; <br>       else <br> BUFF[AT(x,y)]=' '; <br>     } <br> } <br>  <br> void c_main() <br> { <br>   buff_clean(); <br>   init(); <br>   for(;;){ <br>     copy_buff(); <br>     update(); <br>   } <br> } <br>  <>
29<>sage<>02/07/20 00:33<> ほんとはもっとCっぽくやりたかったんだけど、 <br> stripでオブジェクトを作ると、 <br> 文字列リテラルとかが入っているオブジェクトが破損されるから出来なかった。 <>
デフォルトの名無しさん<>sage<>02/07/20 00:38<> <a href="../test/read.cgi/tech/1027080631/36" target="_blank">&gt;&gt;36</a> <br> strip しても文字列は消えないんじゃない？ <br> ただリンクを上手くしないとdata領域に上手くアクセスできないってのはあるけど。 <>
ひげぽん<>sage<>02/07/20 00:40<> <a href="../test/read.cgi/tech/1027080631/34" target="_blank">&gt;&gt;34</a> <br> &gt;リフェガメ <br> ってどんなものですか？？ <>
29<>sage<>02/07/20 00:43<> <a href="../test/read.cgi/tech/1027080631/37" target="_blank">&gt;&gt;37</a> <br> たとえば、 <br> #define VRAM ((char*)0xB8000) <br>  <br> void hige(void) { <br> VRAM[0] = '2'; <br> VRAM[2] = 'c'; <br> VRAM[4] = 'h'; <br> for(;;); <br> } <br> char* text="2ch"; <br>  <br> このソースのリスティングが下のようになっちゃう。 <br> やっぱり、きちんとリンカを使わないとだめなようです。 <br> MinGW標準だと-oformat binaryが使えないので、 <br> どっちにしろﾀﾞﾒﾎﾟってかんじですか。 <br>  <br> 00000000  1A00　              sbb al,[eax] <br> 00000002  0000 　             add [eax],al <br> 00000004  0500800B00　        add eax,0xb8000 <br> 00000009  32C6　              xor al,dh <br> 0000000B  0502800B00　        add eax,0xb8002 <br> 00000010  63C6　              arpl si,ax <br> 00000012  0504800B00　        add eax,0xb8004 <br> 00000017  68EBFE3263　        push dword 0x6332feeb <br> 0000001C  68　                db 0x68 <br> 0000001D  00　                db 0x00 <br> 0000001E  90　               nop <br> 0000001F  90 　              nop <br>  <>
デフォルトの名無しさん<>sage<>02/07/20 00:47<> <a href="../test/read.cgi/tech/1027080631/38" target="_blank">&gt;&gt;38</a> 英語で書くと life game <>
デフォルトの名無しさん<>sage<>02/07/20 00:48<> <a href="../test/read.cgi/tech/1027080631/15" target="_blank">&gt;&gt;15</a> <br> &gt; bochsが↓というエラー出しながら異常終了してしまいます。 <br> &gt; 00000232034e[CPU ] prefetch: running in bogus memory <br>  <br> bochs のソースを grep すると... <br>  <br> if ( new_phy_addr &gt;= BX_CPU_THIS_PTR mem-&gt;len ) { <br> 　// don't take this out if dynamic translation enabled, <br> 　// otherwise you must make a check to see if bytesleft is 0 after <br> 　// a call to prefetch() in the dynamic code. <br> 　BX_ERROR(("prefetch: running in bogus memory")); <br> } <br>  <br> となってるから、どうもメモリー容量を越えたみたい。 <br> higepos_kernel.c の hige() は、誰からも呼ばれてないから関数から戻ったら <br> 即暴走してメモリーを使い尽くしたんだと思う。 <br> とりあえず... <br>  <br> static char foo(); <br>  <br> void hige() <br> { <br> 　char a; <br> 　a = foo(); <br> 　while(1){ <br> 　} <br> } <br>  <br> static char foo() <br> { <br> 　return 'A'; <br> } <br>  <br> とでもして試してみて。 <>
デフォルトの名無しさん<>sage<>02/07/20 00:51<> 解決済みだったり <>
デフォルトの名無しさん<>sage<>02/07/20 00:52<> <a href="../test/read.cgi/tech/1027080631/41" target="_blank">&gt;&gt;41</a> <br> つうか、return するならアセンブリではcallにしろよ。&gt;ひげぽん <>
41<>sage<>02/07/20 01:01<> <a href="../test/read.cgi/tech/1027080631/42" target="_blank">&gt;&gt;42</a> <br> ショボーン...。 <>
デフォルトの名無しさん<>sage<>02/07/20 01:22<> "OSを作ろう"と言うスレがありました。 <br> 散々叩かれて消えていったとさ。。。 <>
デフォルトの名無しさん<>sage<>02/07/20 01:36<> <a href="../test/read.cgi/tech/1027080631/45" target="_blank">&gt;&gt;45</a> <br> 叩いたつもりになってるのは、このスレの雰囲気が読めてない君だけだよ。 <br> ちょっと内容が高度になってきて内容が理解できないのはわかるが、おとなしく <br> 他のスレに行きな。 <>
デフォルトの名無しさん<>sage<>02/07/20 01:44<> アドレスをいじったりするようにすると何かと面倒になってくるから、 <br> 今の内からオブジェクト配置のリロケータを書いた方が良いのかな、とか思ﾀﾖ <>
デフォルトの名無しさん<>sage<>02/07/20 01:44<> <a href="../test/read.cgi/tech/1027080631/7" target="_blank">&gt;&gt;7</a>へのレスなんですけど。 <>
デフォルトの名無しさん<>sage<>02/07/20 06:04<> <a href="../test/read.cgi/tech/1027080631/45" target="_blank">&gt;&gt;45</a> <br> どのスレ？ <br> http://pc.2ch.net/tech/kako/1006/10065/1006524791.html <br> http://pc.2ch.net/tech/kako/1022/10226/1022685075.html <br> http://piza2.2ch.net/tech/kako/998/998113110.html <br> http://piza2.2ch.net/tech/kako/998/998502881.html <>
デフォルトの名無しさん<>sage<>02/07/20 07:54<> <a href="../test/read.cgi/tech/1027080631/48" target="_blank">&gt;&gt;48</a> <br> あ〜〜〜、そう言うことか。唐突にでてきたように見えたから、単なる嵐かとおも <br> たよ。スマソ。で、結局どのスレなの ? <>
デフォルトの名無しさん<>sage<>02/07/20 12:11<> <a href="../test/read.cgi/tech/1027080631/50" target="_blank">&gt;&gt;50</a> <br> （　´,_ゝ`）ﾌﾟｯ ﾀﾞｾｪ <>
デフォルトの名無しさん<>age<>02/07/20 13:45<> 結局このスレの開始スレってどれ？ <>
デフォルトの名無しさん<><>02/07/20 13:49<> &gt;&gt;ALL <br> まずはFDにおさまるOSをつくろうぜ <br>  <>
デフォルトの名無しさん<>sage<>02/07/20 15:45<> 誰かブートローダー作ってる？ <br> 漏れFATからロードするローダー今作ってるが、 <br> 誰かが作るならやめる。 <>
デフォルトの名無しさん<>age<>02/07/20 16:07<> 良スレの予感 <>
45<>sage<>02/07/20 17:02<> ごめんよ<a href="../test/read.cgi/tech/1027080631/50" target="_blank">&gt;&gt;50</a> <br> 同じタイトルのスレ見覚えがあったんだけどOS板でした… <br> 結局part1はどれかわからん。とにかくひげぽん頑張ってね〜 <br> 興味あるんだけど漏れじゃ何もできんよ。。。 <br> 初めて読む486読んで勉強してるところです。 <>
ひげぽん<><>02/07/20 20:18<> <a href="../test/read.cgi/tech/1027080631/53" target="_blank">&gt;&gt;53</a> <br> &gt;&gt;ALL <br> &gt;まずはFDにおさまるOSをつくろうぜ <br> そうですね。ひげぽんの当面の目標も↑と一緒です。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/56" target="_blank">&gt;&gt;56</a>=45 <br> ありがとう。 <br> &gt;興味あるんだけど漏れじゃ何もできんよ。。。 <br> &gt;初めて読む486読んで勉強してるところです。 <br> そんなことはないですよ、このスレッドの前スレから目を通してもらえれば <br> すくなくとも、フロッピーからブートするところまではいけると思いますよ。 <br>  <br> OSを作ることに興味がある人はぜひご参加ください。 <br>  <br>  <br>  <br>  <br>  <br>  <>
デフォルトの名無しさん<>sage<>02/07/20 21:02<> <a href="../test/read.cgi/tech/1027080631/54" target="_blank">&gt;&gt;54</a> <br> 俺も、ひげぽんのおかげでフロッピーからブートするところまではいける <br> ようになったよ。(つーか、ひげぽんのソースをちょっといじっただけと <br> も言えるが...。) で、次にカーネルのコアに相当するものを読み込む <br> ローダーを作ろうと考えてたんだけど、もう作っている人いるのか...。 <br>  <br> そろそろファイルシステムとか実行ファイル形式とかメモリー管理とか <br> 決めないといけない状況かな...。 <>
ひげぽん<><>02/07/20 21:09<> <a href="../test/read.cgi/tech/1027080631/58" target="_blank">&gt;&gt;58</a> <br> &gt;そろそろファイルシステムとか実行ファイル形式とかメモリー管理とか <br> &gt;決めないといけない状況かな...。 <br> そうですよね。 <br> ファイルシステムってどの時点で決めざるを得なくなるんだろう。 <br> OSブート部に含まれるシステム初期化部分に含まれるんですよね。 <br> いまは、VGA部のライブラリを書こうと思っているのですが･･･ <br>  <br> 良いサンプルとかありますか？ <br> higeposの方針として <br> 一番ハードウェアよりのレイヤーは、システムライブラリ群として実装し <br> それをcppのクラスでラップしようと思っています。 <br>  <br> たとえばVGA、FILEクラスとか･･･ <br> もしx86以外に移植する場合はライブラリを <br> 直すようにすればよいかな･･･ <br> なんて考えております。 <br>  <br>  <br>  <>
54<>sage<>02/07/20 21:27<> <a href="../test/read.cgi/tech/1027080631/58" target="_blank">&gt;&gt;58</a> <br> フロッピーからブートだけど、 <br> FAT12形式の方が何かと便利なので、 <br> FAT上にファイルとしてhigeboot.bin（2nd boot program）を設置して <br> それに実行を移すプログラムを書いてるって事。 <>
54<>sage<>02/07/20 21:28<> <a href="../test/read.cgi/tech/1027080631/59" target="_blank">&gt;&gt;59</a> <br> フロッピーって時点でFAT12で決定じゃないんですか？ <br> それとも、フロッピーもオリジナルのファイルシステムにする？ <>
ひげぽん<><>02/07/20 21:45<> <a href="../test/read.cgi/tech/1027080631/61" target="_blank">&gt;&gt;61</a> <br> &gt;フロッピーって時点でFAT12で決定じゃないんですか？ <br> &gt;それとも、フロッピーもオリジナルのファイルシステムにする？ <br> ファイルシステム実は良く分かってないっす(笑) <br> ファイルシステムは、どの時点で決定するものなのでしょうか。 <br>  <br>  <>
デフォルトの名無しさん<><>02/07/20 22:10<> bochs-1.4.1で、除数 &lt;= edx <br> の時に除算命令(div)を発行すると、 <br> 除算命令で無限ループになるんだけど、 <br> これってx86の仕様？ <br>  <>
58<>sage<>02/07/20 22:16<> <a href="../test/read.cgi/tech/1027080631/61" target="_blank">&gt;&gt;61</a> <br> &gt; フロッピーって時点でFAT12で決定じゃないんですか？  <br> &gt; それとも、フロッピーもオリジナルのファイルシステムにする？  <br> それ以外にも、EXT2 (Linux), NTFS (WindowsNT), BSD FFS (FreeBSD), <br> HFS (Mac) とかもあるからどうするものかと...。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/62" target="_blank">&gt;&gt;62</a> <br> &gt; ファイルシステムは、どの時点で決定するものなのでしょうか。 <br> 普通、カーネル自体は普通のファイルの形式にすることが多い。そうすれ <br> ば、カーネルを再構築した時に単にそのファイルを置き換えるだけで済む <br> から。その為には、second_boot 当たりがファイルシステムを理解して <br> 読み出すことが必要。と言うことで、そろそろかなぁと思った次第。 <br> とりあえずは、開発システムのファイルシステムに合わせておくのがいい <br> かと思う。 <>
54<>sage<>02/07/20 22:22<> <a href="../test/read.cgi/tech/1027080631/64" target="_blank">&gt;&gt;64</a> <br> えーっと、いきなりハードディスクで動かすのを前提で進めるの？ <br> まず、フロッピー運用でウインドウシステムなりコンソールなりまで出さないの？ <br>  <br> EXT2もNTFSもフロッピーに作れるファイルシステムじゃないし、 <br> 今の時点では考えてなかったんだけど。 <br>  <>
ひげぽん<><>02/07/20 22:23<> <a href="../test/read.cgi/tech/1027080631/64" target="_blank">&gt;&gt;64</a>==58 <br> &gt;普通、カーネル自体は普通のファイルの形式にすることが多い。そうすれ <br> &gt;ば、カーネルを再構築した時に単にそのファイルを置き換えるだけで済む <br> &gt;から。その為には、second_boot 当たりがファイルシステムを理解して <br> &gt;読み出すことが必要。と言うことで、そろそろかなぁと思った次第。 <br> なるほど、ありがとうございます。 <br> まったく勉強不足で申し訳ないのですが、 <br> ファイルシステムの実装はどのくらいのボリュームなのでしょうか。 <br> またファイルシステム毎にやはり難易度は違うのでしょうか。 <br>  <br>  <br>  <>
デフォルトの名無しさん<>sage<>02/07/20 22:30<> <a href="../test/read.cgi/tech/1027080631/63" target="_blank">&gt;&gt;63</a> <br> &gt; 除算命令で無限ループになるんだけど、これってx86の仕様？  <br> 命令が無限ループになるなんて言う仕様/バグがあるとは考えにくい。 <br> (実プロセサはもとより、bochs にも。) 除算エラー例外のハンドラが <br> 単純に IRET してるとかしてない ? <>
58<>sage<>02/07/20 22:52<> <a href="../test/read.cgi/tech/1027080631/65" target="_blank">&gt;&gt;65</a> <br> &gt; EXT2もNTFSもフロッピーに作れるファイルシステムじゃないし、 <br> すまん、NTFS はダメだね。EXT2 もダメなのか...。 <br> ところで、WindowsNT の FD は FAT12 だけど、Linux の FD ってどう <br> いうフォーマットなの ? <br>  <br> <a href="../test/read.cgi/tech/1027080631/66" target="_blank">&gt;&gt;66</a> <br> &gt; ファイルシステムの実装はどのくらいのボリュームなのでしょうか。 <br> とりあえず、FAT を実装したソースが... <br> http://cvsweb.netbsd.org/bsdweb.cgi/syssrc/sys/msdosfs/ <br> からダウンロードできるみたい。これは、FAT12/16/32 を含んでいて、 <br> 更に書き込みをサポートしているから、ブートローダーとしてならこれ <br> の半分ぐらいにはなると思う。 <br>  <br> &gt; またファイルシステム毎にやはり難易度は違うのでしょうか。  <br> これは、当然そう。同じサイトに、ntfs とか isofs とかもあるから <br> 見比べてみればいいかも。 <>
デフォルトの名無しさん<>sage<>02/07/20 22:55<> LinuxもFAT12 <br> つーか、PC互換機ではほとんどのOSで <br> フロッピーのファイルシステムはFAT12。 <>
デフォルトの名無しさん<>sage<>02/07/20 23:00<> FAT12の亜種で、紛れもなくFAT12なんだけど、 <br> 0x0b〜のBPBを潰してある形式もあったね。 <br> たぶん、BPB決め撃ちなんだと思うけど、 <br> ウインドウズからは読めなかったはず。 <>
ひげぽん<>sage<>02/07/21 00:01<> <a href="../test/read.cgi/tech/1027080631/68" target="_blank">&gt;&gt;68</a> <br> <a href="../test/read.cgi/tech/1027080631/69" target="_blank">&gt;&gt;69</a> <br> なるほどフロッピーならFAT12ということですね。 <br> FAT12の規格・仕様がきちんと存在して、 <br> それを実装するということですね。 <br>  <br>  <>
ひげぽん<>sage<>02/07/21 00:10<> リンク時に下記のエラーが出てしまい困っています。 <br> ld.exe: warning: cannot find entry symbol startKernel; defaulting to 00000200 <br> ../bin/higepos_kernel.o(.eh_frame+0x11):higepos_kernel.cpp: undefined reference to `___gxx_personality_v0' <br>  <br> やろうとしていることは、 <br> higepos_kernel.cppに実装していたVRAMアクセス文字列出力関数を <br> vga.cppで実装し、呼び出すことです。 <br>  <br> vga.cppで実装している_sysPrint2ch関数をhigepos_kernel.cppで <br> 呼び出しているのですが、リンク時に <br> higepos_kernel.cpp: undefined reference to `___gxx_personality_v0' <br>  <br> というエラーが出てしまいます。 <br> もちろん`___gxx_personality_v0'というものには、 <br> まったく覚えがありません。 <br> リンカのオプションが悪いのでしょうか。 <br>  <br> このエラーがエラーが出てしまうソースは、 <br> http://oshigepon.tripod.co.jp/ <br> におきました。 <br>  <br>  <>
ひげぽん<><>02/07/21 00:12<> ソースのコメントはDoxygen用に記述することにしました。 <br>  <br> ファイルシステム難しそうだなあ。 <>
デフォルトの名無しさん<>sage<>02/07/21 00:20<> <a href="../test/read.cgi/tech/1027080631/72" target="_blank">&gt;&gt;72</a> <br> リンク時にエントリーを指定しても意味がない。 <br> リンク時先頭にあるコードから実行されるようになる。 <br>  <br> ２つ目のメッセージは、c++のランタイム関数かと。 <br> 例外処理とかその他で利用する奴（要するに必須）でない？ <br>  <br>  <br> <a href="../test/read.cgi/tech/1027080631/73" target="_blank">&gt;&gt;73</a> <br> まだファイルシステムサポートは書く必要ないだろ <br> ルートからファイルを一つ読み出せればいい <br>  <br> 理由： <br> 　プロテクトモード移行前のファイルシステムドライバを書いても、 <br> 　結局2nd bootで利用するだけになり、意味がない。 <br>  <br>  <>
デフォルトの名無しさん<>sage<>02/07/21 00:21<> c++はいろいろあって面倒だから、やめた方が無難だと思うが、どうか。 <>
ひげぽん<><>02/07/21 00:24<> <a href="../test/read.cgi/tech/1027080631/74" target="_blank">&gt;&gt;74</a> <br> &gt;リンク時にエントリーを指定しても意味がない。  <br> &gt;リンク時先頭にあるコードから実行されるようになる。  <br> やっぱりそうですよね。 <br> 私もそう思っていたのですが、自信が無くて････ <br>  <br> &gt;２つ目のメッセージは、c++のランタイム関数かと。  <br> &gt;例外処理とかその他で利用する奴（要するに必須）ではない? <br> リンク時にこの必須でない関数をリンクしないオプションがあるのでしょうか。 <br> それともライブラリを見つけてリンクしなければいけないのかな？ <br>  <>
ひげぽん<>sage<>02/07/21 00:26<> <a href="../test/read.cgi/tech/1027080631/75" target="_blank">&gt;&gt;75</a> <br> &gt;c++はいろいろあって面倒だから、やめた方が無難だと思うが、どうか。 <br> ~~~~~~~~~~~~~~~~~~~~~~~~~ <br> 　　　↑ <br> 　　この辺詳しく聞きたいです。 <br>  <br>  <br>  <>
デフォルトの名無しさん<>sage<>02/07/21 00:31<> <a href="../test/read.cgi/tech/1027080631/76" target="_blank">&gt;&gt;76</a> <br> &gt;リンク時にこの必須でない関数をリンクしないオプションがあるのでしょうか。  <br> &gt;それともライブラリを見つけてリンクしなければいけないのかな？  <br>  <br> gccはよくしらんのだけど、RTTIと例外を無効にするオプションを使ってみたら？ <br>  <br> &gt;c++はいろいろあって面倒だから <br>  <br> たとえば、上に上げた例外や、他言語（アセンブラが主かな）とのシンボル名の整合 <br> あとは、cだとランタイムを使わなければ良いだけでも、 <br> c++ではnew演算子とか言語自体の機能なんで、 <br> デフォルトでいらないコードがリンクされたり、それの準備のための初期化ルーチンが用意される。 <br>  <>
デフォルトの名無しさん<>Sage<>02/07/21 02:14<> ファイルシステムまだ早いやろ。 <br> Second で FAT12 からファイル読めるのは便利だが。 <br> 32bit モードでやるならディスクアクセス BIOS に頼るのもなんだし。 <br> IDT 作ってキーボード割り込み捕まえる辺りのが先では？ <br>  <>
デフォルトの名無しさん<>sage<>02/07/21 02:25<> minix fs とかいってみるテスト <>
デフォルトの名無しさん<>sage<>02/07/21 10:15<> <a href="../test/read.cgi/tech/1027080631/72" target="_blank">&gt;&gt;72</a> <br> &gt; このエラーがエラーが出てしまうソースは、 <br> &gt; http://oshigepon.tripod.co.jp/ <br> &gt; におきました。 <br> ちょっと話題がずれるんだけど、ソースコードアップルーチンにバグない ? <br> なんか、#include の後ろがなくなってるみたいなんだけど...。 <br> HTML は、'&lt;' や '&gt;' は、特別扱いだからそこら当たりが怪しいかと。 <br> あと、& 等も要注意だね。 <>
ひげぽん<>sage<>02/07/21 11:09<> <a href="../test/read.cgi/tech/1027080631/81" target="_blank">&gt;&gt;81</a> <br> 不具合修正いたしました。 <br> 適当に作っていたのでまったくタグの事なんか気にしてなかった(鬱) <>
ひげぽん<>sage<>02/07/21 11:38<> <a href="../test/read.cgi/tech/1027080631/78" target="_blank">&gt;&gt;78</a> <br> &gt;ld.exe: warning: cannot find entry symbol startKernel; defaulting to 00000200 <br> &gt;../bin/higepos_kernel.o(.eh_frame+0x11):higepos_kernel.cpp: undefined reference to `___gxx_personality_v0' <br> のエラーが出てしまう件ですが <br>  <br> &gt;gccはよくしらんのだけど、RTTIと例外を無効にするオプションを使ってみたら？ <br> 例外を無視するオプション　 -fno-exceptions <br> を使ったらばっちりうまくいきました。 <br> ありがとう。 <>
デフォルトの名無しさん<><>02/07/21 12:50<> higepos <br> osask <>
ひげぽん<><>02/07/21 19:10<> vga.cppをちょこっと更新しました。 <br> ↓こんな感じで使えるようになりました。 <br> &nbsp;&nbsp;&nbsp;&nbsp;_sysInitVga(); <br> &nbsp;&nbsp;&nbsp;&nbsp;_sysClearScreen(); <br> &nbsp;&nbsp;&nbsp;&nbsp;_sysPrint("&nbsp;Higepos&nbsp;Kernel&nbsp;start!!\n&nbsp;Powered&nbsp;by&nbsp;2ch\0"); <br>  <br> http://oshigepon.tripod.co.jp/ <br>  <br> [問題点・課題] <br> 文字列の終端を'\0'で捕まえようとしているが出来ない。 <br> '\b', '\t'に対応する。 <br> 日本語の表示 <br>  <>
デフォルトの名無しさん<>sage<>02/07/21 19:45<> <a href="../test/read.cgi/tech/1027080631/85" target="_blank">&gt;&gt;85</a> <br> _sysPrintとか_sysPutCharacterっていわば低レベル文字出力でしょ？ <br> \bとか\tはレイアウトを扱うもっと高レベルな関数でサポートするのが良いと思う <>
デフォルトの名無しさん<>sage<>02/07/21 19:57<> <a href="../test/read.cgi/tech/1027080631/85" target="_blank">&gt;&gt;85</a> <br> &gt; 文字列の終端を'\0'で捕まえようとしているが出来ない。  <br> どうなっちゃうの ? ちょっと意味が良くわからない。 <br>  <br> &gt; '\b', '\t'に対応する。  <br> '\b' は、 <br> if(0 &lt; curX){ <br> 　backwardCursor(); <br> 　_sysPutCharacter(' '); <br> 　backwardCursor(); <br> } <br>  <br> '\t' は、 <br> while((curX % 8) != 0){ <br> 　_sysPutCharacters(' '); <br> } <br> あたりでどうか。(\t の 直後に \b されるとちょっとまずいけどね。) <br>   <br> &gt; 日本語の表示  <br> これは、ちょっと難しい。そもそもフォントをどのように扱うかが問題と <br> なる。とりあえず優先順位は落としたほうがいいと思う。 <>
ひげぽん<>sage<>02/07/21 20:05<> <a href="../test/read.cgi/tech/1027080631/86" target="_blank">&gt;&gt;86</a> <br> &gt;_sysPrintとか_sysPutCharacterっていわば低レベル文字出力でしょ？ <br> &gt;\bとか\tはレイアウトを扱うもっと高レベルな関数でサポートするのが良いと思う <br> あったら便利なのかなと思ったのですが、後述するように\tはめんどくさいですよね。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/87" target="_blank">&gt;&gt;87</a> <br> &gt; '\b', '\t'に対応する。 <br> &gt;'\b' は、・・・ <br> \bはそんな感じですね。 <br>  <br> \tは、\bされたときにどうするかというが非常に面倒くさいですね。 <br> 現時点でそこまでして実装するのか！！みたいな・・・ <br>  <br>  <br>  <br>  <br>  <br>  <br>  <br>  <br>  <>
ひげぽん<>sage<>02/07/21 20:08<> ↑無駄な空白が出来てしまいましたごめんなさい。 <br> <a href="../test/read.cgi/tech/1027080631/87" target="_blank">&gt;&gt;87</a> <br> &gt;&gt; 文字列の終端を'\0'で捕まえようとしているが出来ない。 <br> &gt;どうなっちゃうの ? ちょっと意味が良くわからない。 <br> C言語では文字列の終端は'\0'ですよね？ <br>  <br> そこで <br> vga.cppでは <br>  <br> void&nbsp;_sysPrint(char*&nbsp;str)&nbsp;{ <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(;&nbsp;*str&nbsp;!=&nbsp;'\0';&nbsp;str++)&nbsp;{ <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_sysPutCharcter(*str); <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return; <br> } <br> のように実装しています。 <br>  <br> で呼び出し側で_sysPrint("higepon");とやると <br> 無限ループになってしまうんです。 <br> _sysPrint("higepo\0");だとOK <br>  <br>  <br>  <>
デフォルトの名無しさん<>sage<>02/07/21 20:35<> <a href="../test/read.cgi/tech/1027080631/89" target="_blank">&gt;&gt;89</a> <br> bochsdbgは試してる？ <br> 指定アドレスにブレークポイント張れるから、 <br> ステップ実行してみるといいかも <>
87<>sage<>02/07/21 20:38<> <a href="../test/read.cgi/tech/1027080631/89" target="_blank">&gt;&gt;89</a> <br> &gt; で呼び出し側で_sysPrint("higepon");とやると  <br> &gt; 無限ループになってしまうんです。  <br> &gt; _sysPrint("higepo\0");だとOK  <br> う〜〜〜ん、わからん。_sysPrint("higepon"); とやった時のバイナリ <br> イメージアップできます ? <>
ひげぽん<>sage<>02/07/21 20:43<> <a href="../test/read.cgi/tech/1027080631/91" target="_blank">&gt;&gt;91</a> <br> いま、試してみたら <br> _sysPrint("higepon");  <br> でも正常動作しました。 <br> 何か違うところのバグっぽいので調べてみます。 <br> お騒がせいたしました。 <>
デフォルトの名無しさん<>sage<>02/07/21 20:52<> 質問いいっすか？ <br> firstbootで18セクタ読んで、 <br> 1000h:0000h 2nd boot <br> 1000h:0200h kernel <br> という配置ですよね？ <br> 2nd bootの最後でkernelのアドレスにジャンプしていると思うのですが、 <br> kernelの先頭位置には文字列が来てるじゃないですか。 <br> どうして実行できるんですか？ <>
ひげぽん<>sage<>02/07/21 21:00<> &gt;kernelの先頭位置には文字列が来てるじゃないですか。 <br> &gt;どうして実行できるんですか？ <br> kernelの先頭に文字列とはどういう意味でしょうか？ <br> あれれ何か変なことやらかしてますか？→私 <br>  <br>  <br>  <>
デフォルトの名無しさん<><>02/07/21 21:04<> ていうかひげぽんさあ。 <br> あんたマジすごいよ。 <br> なんですぐ、VGAとか書けちゃうの？？？？ <br>  <br> あー俺って、おちこぼれって感じ。 <>
93<><>02/07/21 21:14<> 逆アセンブルしてみました。 <br>  <br> Kernel.binのダンプ <br> 20 48 69 67 65 70 6f 73 20 4B 65 72 6e 65 6c 20 | Higepos Kernel | <br> 73 74 61 72 74 21 21 0a 20 50 6f 77 65 72 65 64 |start!!. Powered| <br> 20 62 79 20 32 63 68 00 00 90 55 89 e5 83 ec 08 | by 2ch...U.....| <br> 〜（略）〜 <br>  <br> 0008:00001200 20 48 69 　　　　and [eax+0x69],cl ; " Hi" <br> 0008:00001203 67 65 70 6f　　　gs a16 jo 0x76　　; "gepo" <br> 0008:00001207 73 20　　　　　　jnb +0x20　　　　 ; "s " *1 <br> 〜（略）〜 <br> 0008:00001229 90 　　　　　　　nop <br> 0008:0000122a 55 　　　　　　　push ebp <br> 〜（略）〜 <br>  <br> 2nd bootからメッセージの先頭に飛んで、 <br> たまたま*1の時の"s "のオペコードが jnb +0x20で、 <br> とんだ先が正常に実行できるコードだったというだけみたい。 <br>  <br> で、'\0'の問題は、'\0'を入れたことによって、 <br> 「たまたま」とんだ先が正常なコードになっただけで、 <br> cのソースが悪いわけじゃなかったみたい。 <br>  <>
93<>sage<>02/07/21 21:15<> 2nd bootからとんだ先のアドレスが <br> 0008:00001200なので、メッセージ（文字列）の中にjumpしてるって事。 <>
93<>sage<>02/07/21 21:17<> ついでに言うと、正常なエントリポイント（startKernel）のアドレスは <br> 0008:00001261になっているはず <>
デフォルトの名無しさん<>sage<>02/07/21 21:21<> もしかして、ひげぽんって動いたら逆アセンブルとかステップ実行とかやらないの？ <>
ひげぽん<>sage<>02/07/21 21:23<> <a href="../test/read.cgi/tech/1027080631/93" target="_blank">&gt;&gt;93</a> <br> この場合、文字列の中にjmpしてしまうことはどのように回避すれば <br> 良いのでしょうか。 <br>  <br> 文字列部分がkernelの先頭に来てしまうということは、 <br> 文字列を変更した場合は、startKernelのエントリポイントが <br> 変わってしまうんですよね。 <br> 混乱してきました。 <>
ひげぽん<>sage<>02/07/21 21:26<> <a href="../test/read.cgi/tech/1027080631/99" target="_blank">&gt;&gt;99</a> <br> &gt;もしかして、ひげぽんって動いたら逆アセンブルとかステップ実行とかやらないの？ <br> とりあえず、やってませんでした。&lt;(_ _)&gt; <br>  <>
93<>sage<>02/07/21 21:26<> <a href="../test/read.cgi/tech/1027080631/100" target="_blank">&gt;&gt;100</a> <br> ほんとスマン、詳しくないんだけど。 <br> リンカスクリプトで、配置をコントロールできるんじゃないの？ <>
デフォルトの名無しさん<>sage<>02/07/21 21:28<> てな感じでお手軽回避か？ <br>  <br> void startKernel(void) { <br>     body(); <br> } <br>  <br> void body(void) { <br>     _sysInitVga(); <br>     _sysClearScreen(); <br>     _sysPrint(" Higepos Kernel start!!\n Powered by 2ch\0"); <br>     while (true) { <br>     } <br> } <br>  <>
93<>sage<>02/07/21 21:29<> もしかすると、文字列を持ったり、静的変数を使う場合、 <br> オブジェクト形式を規定して適切にリロケーションしないとダメなのかも知れない。 <br> それから、今はstatic int curXとかは0008:00000000に配置されているはず。 <br>  <>
93<>sage<>02/07/21 21:30<> <a href="../test/read.cgi/tech/1027080631/103" target="_blank">&gt;&gt;103</a> <br> それでも回避は不可能。 <br> デフォルトで、リテラルはまとめられて先頭に配置されているみたい。 <>
デフォルトの名無しさん<>sage<>02/07/21 21:39<> // kernel.c <br> void startKernel(void) { <br> body(); <br> } <br>  <br> // body.c <br> void body(void) { <br> _sysInitVga(); <br> _sysClearScreen(); <br> _sysPrint(" Higepos Kernel start!!\n Powered by 2ch\0"); <br> while (true) { <br> } <br> } <br>  <br> // <br> ld -T simple.ls kernel.obj body.obj -o a.exe <br> objcopy a a.bin -O binary <br>  <br> // <br> OUTPUT_FORMAT(pei-i386) <br> SECTIONS <br> { <br> . = 0x1200; <br> .text : { *(.text) } <br> .data : { *(.rodata) } <br> .data : { *(.data) } <br> .bss : { *(.bss) } <br> } <br>  <br> // <br> by MinGW <br> てな感じは？ <br>  <>
デフォルトの名無しさん<>sage<>02/07/21 21:44<> <a href="../test/read.cgi/tech/1027080631/106" target="_blank">&gt;&gt;106</a> <br> 無理みたいですね <>
デフォルトの名無しさん<>sage<>02/07/21 21:55<> 無理というか、コードには反映されているね <br> やっぱり、実際のデータを動的に再配置するしか方法は無いみたいですが。 <>
デフォルトの名無しさん<>sage<>02/07/21 22:07<> 解決法は、以下の二つだと思う... <br> 1. リンカスクリプトで、コードセグメントを先頭に持っていく。 <br> 2. 実行ファイル形式に先頭アドレスの情報を埋め込んで、ローダーがそれを解 <br> 釈して指定された先頭アドレスにジャンプする。 <br> 組み込みなんかでは、1. の方が多い。通常の PC アプリケーションでは 2. の <br> 方が多いと思う。私は、VC++ でやっていて標準の link.exe では、1. ができ <br> ないので、2. でやれないか、.exe ファイルフォーマット (PE 形式) を調査 <br> 中。 <>
106<>sage<>02/07/21 22:18<> む〜 MinGW で試してきた。 <br> 文字列は先頭に来なくなり main が先頭に来ている。 <br> djpp とか linux版 gcc とかは無理なのかな？ <br>  <br> いい加減だったので訂正。 <br>  <br> // りんく手順 <br> ld -T simple.ls kernel.obj body.obj vga.obj -o a.exe <br> objcopy a.exe a.bin -O binary <br>  <br> // simple.ls <br> OUTPUT_FORMAT(pei-i386) <br> SECTIONS <br> { <br> . = 0x1200; <br> .text : { *(.text) } <br> .data : { *(.data) } <br> .bss : { *(.bss) } <br> } <br>  <br> // 以下より参考 <br> ttp://www.sra.co.jp/public/sra/product/wingnut/ <br>  <br> ld マニュアル(binutils-2.11.2)  の  <br> 3. リンカスクリプト の <br> 3.3 簡単なリンカスクリプトの例 から <br>  <>
デフォルトの名無しさん<>sage<>02/07/21 22:27<> <a href="../test/read.cgi/tech/1027080631/110" target="_blank">&gt;&gt;110</a> <br> startKernelからbodyを呼び出すのが重要だったんですね。 <br> リンカスクリプトは要らないようです。 <br> リンクすると、自然に以下の配置になるようです。 <br>  <br> obj0::data <br> obj0::code <br> obj1::data <br> obj1::code <br> 〜 <br> objn::data <br> obj0::code <br>  <br>  <>
ひげぽん<>sage<>02/07/21 23:18<> 上記有用な議論踏まえて(ありがとうございます) <br>  <br> ソース構成を変えたものをアップロードしました。 <br> ばっちりうまく動いております。 <br> http://oshigepon.tripod.co.jp/ <br>  <br> ところで例のMinix本でファイルシステムの勉強をしてました。 <br> 実現したい機能等はMinixのものと同様かそれ以上なのですが <br> かけるコードは、絶対それ以下の自信があります(半分本気) <br>  <br>  <br>  <br>  <>
デフォルトの名無しさん<>sage<>02/07/21 23:34<> http://www.afis.to/~mone/osask/osask_ml/200105/msg00002.html <br> パクリだけど、↑を実装してみるとか <>
デフォルトの名無しさん<>sage<>02/07/21 23:37<> <a href="../test/read.cgi/tech/1027080631/112" target="_blank">&gt;&gt;112</a> <br> ていうか、ファイルシステムの議論って今して意味あるのか？ <br> HDDで運用するfsを決めるより、FDDでの運用をどうするかを決めないといけないし、 <br> カーネルの構造と、デバイスドライバとのインターフェイスを考えないといけない。 <br> 大体、fs非依存ではなく、fs依存型のOSを作るつもりですか？ <>
ひげぽん<>sage<>02/07/21 23:50<> <a href="../test/read.cgi/tech/1027080631/113" target="_blank">&gt;&gt;113</a> <br> <a href="../test/read.cgi/tech/1027080631/114" target="_blank">&gt;&gt;114</a> <br> &gt;ていうか、ファイルシステムの議論って今して意味あるのか？ <br> ファイルシステムに関して、自分の知識不足を感じたので <br> 勉強しただけっす。 <br>  <br> &gt;カーネルの構造と、デバイスドライバとのインターフェイスを考えないといけない。 <br> &gt;大体、fs非依存ではなく、fs依存型のOSを作るつもりですか？ <br> カーネルの構造は考えなければいけないですね。 <br> まあその前にもっと基礎的な部分で足りないところがいろいろとありますが。 <br>  <>
デフォルトの名無しさん<>sage<>02/07/22 00:31<> ファイルシステムまだ早いって。（勉強するのはまた別で） <br> それより、ＩＤＴ作って、キーボード、ＦＤＣ、ＩＤＥインタフェース <br> この辺りの割り込み受け付けて通信できないと。 <br> ディスクアクセスが出来なくてファイルシステムが意味ある訳ない。 <br>  <>
デフォルトの名無しさん<>sage<>02/07/22 01:03<> 基本的なフロッピードライバやIDEドライバって、 <br> マイクロカーネルのOSでもカーネルに内蔵するの？ <br> そうでないなら、どうやってロードしてるんだろ。 <br>  <br> カーネル自体はブートストラップからの一連の処理で起動するのは分かるけど、 <br> カーネルが記憶装置からドライバをロードするには、 <br> その記憶装置へのアクセスを提供するドライバが必要だし。 <br>  <>
デフォルトの名無しさん<>sage<>02/07/22 01:17<> キーボード割り込みどうすればいいのかわかんない <>
過去ログ読んでないから外してたらごめん<>sage<>02/07/22 03:25<> DOSなんかだと確かブートシステムが最小限のFileSystemアクセスのドライバを持っていて <br> FDでもHDDでもルートディレクトリのファイルだけは読みこめるようになってる。 <br> で、そのディスクアクセスはどうやるかっていうとBIOS(int13h)経由でしょ。 <br>  <br> FAT12前提でやるなら、ルートディレクトリの位置は決まっているはず。 <br> これもうろ覚え(というよりPC98の記憶)だけど、 <br> 同じDOSでも古いバージョンだとIO.SYSのディレクトリエントリの位置も <br> ファイル本体の開始位置も決まってたような気がする。 <br> 「IO.SYSはこのセクタから始まる」って決め打ちで読みこみね。 <br>  <br> まあ、ブートセクタ(ミニマムローダ)読みこみ→ローダー読みこみ(bios経由)として、 <br> この後のカーネルイメージとドライバの読みこみを <br> リアルモードでやるかプロテクトモードでやるか、どっちが良い(あるいは楽)かな。 <br> リアルモード(Win9x式)だと、16bitでファイルシステムにアクセスするために <br> 結局同じものをもう１つ作ることになるけど、 <br> biosを使えば手軽だし、読みこんでから配置をいじったりできる。 <br> プロテクトモード(WinNT式)だと、ローダーに制御が渡ったらすぐにモード遷移するから <br> ファイルシステムサポート部の他に、FDDやHDDにアクセスする(最小限の)ドライバも <br> ローダーに組みこむ事になる(ファイルシステムにアクセスできないと、 <br> ドライバを読みこめないから)。 <br> ただ、ドライバやファイルシステム自体は全て32bitモードで管理できる。 <br>  <br> 個人的には、(とりあえずの間は)ブートはブートと割りきって <br> ローダーの位置決め打ちでbiosを使って読みこんで <br> GDT,IDTのセットアップやカーネルイメージのロードまでリアルモードでやっちゃって <br> カーネル本体の動作を見える(楽しめる)ようにした方がいい気がする。 <>
デフォルトの名無しさん<>sage<>02/07/22 18:35<> <a href="../test/read.cgi/tech/1027080631/119" target="_blank">&gt;&gt;119</a> <br> NT系でもBIOSで読んでるだろ。 <br> ブートローダ専用ドライバなんて話、DDKのドキュメントでも見た覚えないし、 <br> 手元のSCSIドライバディスクにも入ってない。 <>
デフォルトの名無しさん<>sage<>02/07/22 18:43<> <a href="../test/read.cgi/tech/1027080631/120" target="_blank">&gt;&gt;120</a> <br> NTでドライバを読んでいるのってプロテクトモード移行後でしょ <br> で、そのドライバを読み込むのにBIOS使ってるの？ <>
デフォルトの名無しさん<>sage<>02/07/22 20:22<> <a href="../test/read.cgi/tech/1027080631/121" target="_blank">&gt;&gt;121</a> <br> BIOS呼ぶときは当然、リアルモードなりV86モードなりになってるだろ。 <br> 各ベンダにブートローダ専用ドライバを作らせるよりよっぽど現実的。 <>
デフォルトの名無しさん<>sage<>02/07/22 20:28<> 各ベンダ毎ってなんだよ。 <br> FDDとIDEドライバ(相当のもの)をNDLDRに入れるだけじゃないか。 <>
デフォルトの名無しさん<>sage<>02/07/22 20:31<> リアルモードなりV86モードなりになってBIOS呼ぶよりよっぽど現実的。 <>
デフォルトの名無しさん<>sage<>02/07/22 20:38<> それだとカーネルやローダーを置くファイルシステムが、 <br> ローダーやカーネルをコンパイルした時点で固定されちゃうじゃん。 <>
デフォルトの名無しさん<>sage<>02/07/22 20:53<> 任意のファイルシステムからブート出来るOSってあまりないと思う <>
デフォルトの名無しさん<>sage<>02/07/22 21:01<> <a href="../test/read.cgi/tech/1027080631/123" target="_blank">&gt;&gt;123</a> <br> ふーん、全てのIDEやSCSIコントローラはまったく同じ方法で制御できるのか。 <br> それならMSが1つドライバ作れば済む話だね。 <>
デフォルトの名無しさん<>sage<>02/07/22 21:13<> 実際にSCSIシステムでは <br> ブート時にntldrやntdetectの他にntbootdd.sysが必要らしいんだけど <br> これはSCSIドライバではないのかな <>
128<>sage<>02/07/22 21:14<> あ、俺は知らないから、純粋に聞いてるだけだよ。 <>
120<>sage<>02/07/22 21:25<> http://www.google.co.jp/search?q=ntbootdd.sys&ie=UTF-8&oe=UTF-8&hl=ja&btnG=Google+%E6%A4%9C%E7%B4%A2&lr=lang_ja <br>  <br> フルバージョンのSCSIドライバらしい。 <br> となると、nsoskrnl.exe、hal.dll、bootvid.sys、pci.sys、scsiport.sys、ntbootdd.sysあたりまでがBIOSでロードか？ <>
ひげぽん<><>02/07/23 00:48<> 次はIDTかな。 <br> キーボート割り込み処理が目標･･･ <>
ろうひ男爵<><>02/07/23 01:25<> FDDオンリーの簡易DOSなら作ったことあるけど、 <br> MINIXみたいなのをつくるの?凄いですね。 <>
デフォルトの名無しさん<>sage<>02/07/23 01:29<> すみません。 <br> このスレに触発されかかって、OSを作ってみたいと思いかけているのですが。 <br> PowerPCをCPUに選びたいんです。 <br> その場合でもIntel系と作る手順というのは変わらないのでしょうか？ <>
デフォルトの名無しさん<>sage<>02/07/23 01:32<> <a href="../test/read.cgi/tech/1027080631/132" target="_blank">&gt;&gt;132</a> <br> *nix系なのかぁ。 <br> BeやBTRONみたいにRT系の方が面白そうだよなぁ <br>  <br> <a href="../test/read.cgi/tech/1027080631/133" target="_blank">&gt;&gt;133</a> <br> ブートはこんなに泥臭くないとおもうが。 <br>  <>
デフォルトの名無しさん<>sage<>02/07/23 01:54<> <a href="../test/read.cgi/tech/1027080631/119" target="_blank">&gt;&gt;119</a> <br> ドライバまで含めてブートローダで読み込みかぁ。 <br>  <br> なら、リアルモードのうちに BIOS でメモリに配置で読み込みのみならできそうか。 <br> ファイルシステム意味あるかも？ <br>  <br> <a href="../test/read.cgi/tech/1027080631/118" target="_blank">&gt;&gt;118</a> <br> PIC(8259A)設定 ＞ IDTに割り込みハンドラ設定 ＞ in al, 60h する <br>   <br> ttp://www.cqpub.co.jp/column/books/2001a/34331PC_Legacy/default.htm <br> でなけりゃ EOTA の boot 以下参照で逝け。 <br>  <>
デフォルトの名無しさん<>sage<>02/07/23 02:10<> <a href="../test/read.cgi/tech/1027080631/135" target="_blank">&gt;&gt;135</a> <br> ポート60hにコマンドを送ると割り込み処理されるのに <br> キーボードを押してもなんにも反応ないのですが <br> そういうものなんでしょうか。 <br>  <>
135じゃないけど<>sage<>02/07/23 03:33<> ん、よく知らないないけど、IDTに処理アドレスを設定してあるとして、 <br> ・その処理ルーチン内でON/OFF(make/breakだっけ?)のどちらであるかを読み、 <br> ・リングバッファなりに記録(あるいはシフト状態フラグを変化させる)して、 <br> ・処理した事を8259Aに知らせる(どっかのポートを叩く) <br> じゃなかったかな？ <br> で、他の方法(システムコール等)でそのバッファに記録された内容を読み出すことで <br> キーボードからの入力を受け取ると思うんだけど。 <>
デフォルトの名無しさん<>sage<>02/07/23 03:37<> とりあえず反応を確かめるなら、割りこみ処理時にVRAMに何か書きこんでみては？ <>
デフォルトの名無しさん<><>02/07/23 03:57<> <a href="../test/read.cgi/tech/1027080631/133" target="_blank">&gt;&gt;133</a> <br> http://www.google.com/search?q=%E6%AD%BB%E3%81%AD%E3%81%B0%EF%BC%9F&sourceid=opera&num=0&ie=utf-8&oe=utf-8 <br> これ見れ。 <>
45<>sage<>02/07/23 05:55<> <a href="../test/read.cgi/tech/1027080631/133" target="_blank">&gt;&gt;133</a> <br> &gt;すみません。  <br> &gt; このスレに触発されかかって、OSを作ってみたいと思いかけているのですが。  <br> &gt; PowerPCをCPUに選びたいんです。  <br> &gt; その場合でもIntel系と作る手順というのは変わらないのでしょうか？  <br>  <br> CPUの違いはあるけど基本は同じだべ。 <br> そんな事もわからないんですか？ <>
デフォルトの名無しさん<>sage<>02/07/23 09:13<> <a href="../test/read.cgi/tech/1027080631/137" target="_blank">&gt;&gt;137</a> <br> 他のソースをみると割り込み処理の基本的な部分は自分で用意したバッファに <br> コードを保存するということのように思ったのですけど、そのような作業を実は <br> してるんでしょうか。 <br> <a href="../test/read.cgi/tech/1027080631/138" target="_blank">&gt;&gt;138</a> <br> 作った処理はの内容は６０番ポートからデータを読み込んで、そのコードを <br> 画面に表示し、20hに20hを送るというものです。 <br>  <br> bochsにキーボードのログをとるように指定すると、何回もKeyboard mouse disable <br> calledっていうのがあるのと、押したときにputting scancode * in internal buffer <br> ってなっているのが気になります。 <>
ひげぽん<><>02/07/23 13:53<> [まじめ話です] <br> sourceforge.jp <br> sourceforge.net　使っている人いますか？ <br>  <br> もしいたら、使い心地、メリット、デメリット等を <br> 教えてください。 <>
デフォルトの名無しさん<>sage<>02/07/23 18:47<> http://www.os-omicron.org/~takano/doc/mksvc.html <br> 参考になるかﾅｰ <>
デフォルトの名無しさん<>sage<>02/07/23 21:55<> <a href="../test/read.cgi/tech/1027080631/136" target="_blank">&gt;&gt;136</a> <br> 送るんでなく，キーボード押すて割り込まれたら 60h から in する。 <br> それと PIC に EOI の発行も忘れずに。 <br>  <br> 137, 141 の書いてることはあってるような雰囲気。 <br>  <br> 割り込みハンドラではリングバッファなどに入れるだけに留めとく。 <br> 後で，キーコードを読み出したいルーチンがバッファから読む。 <br>  <>
デフォルトの名無しさん<><>02/07/23 22:10<> higeposプロジェクト化？ <br> 応援するよ。微力ながら <>
 <>sage<>02/07/23 23:15<> ﾋﾞｸｯ　∧ ∧ ∧ ∧　 　／￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣  <br> 　 Σ(ﾟДﾟ；≡；ﾟдﾟ) ＜　うお！なんかすごいところに迷いこんじまったぞｺﾞﾙｧ！  <br> 　　 　 ./ つ　つ　　　 ＼＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿  <br> 　　〜（＿⌒ヽ　ﾄﾞｷﾄﾞｷ  <br> 　　　　 )ノ ｀Jззз  <>
デフォルトの名無しさん<><>02/07/23 23:59<> 2ch <>
デフォルトの名無しさん<><>02/07/24 01:02<> 3Dを叩けるようになりますか？ <>
デフォルトの名無しさん<>sage<>02/07/24 01:17<> Higepos / 2ch Monax <>
デフォルトの名無しさん<>sage<>02/07/24 03:35<> どうせならEROSで。 <br>  <br> それはそうと、バイナリフォーマットはどうするん？＞ひげぽん <br> COFFかELFを採用するのが妥当だと思うけど、もしかして独自にするつもり？ <br> そうなると専用リンカを作るか、ldのパッチも作らないといけなくなるね。 <>
ろうひ男爵<><>02/07/24 12:29<> eoiはスレーブに送る場合、マスターにも送らないとだめだからね。 <br> キーボードはマスターだから、20hをたたけば良いだけだと思う。 <br> 8259_MS,8259_MSMSK,8259_SL,8259_SLMSKのうち、8259_MSでok。 <br>  <>
os4gd </b>◆PRisauvg <b><>sage<>02/07/24 13:49<> 仮想３Dメモリー定義で処理を軽快にしてみました。 <br> まだ取り入れられてない定義なのでもうしばらくしたら <br> 完成できそうです。ただ問題もたくさんあるので <br> 相談していこうかと思います。よろしく <>
デフォルトの名無しさん<>sage<>02/07/24 15:09<> ﾃﾞﾑﾊﾟ? <>
デフォルトの名無しさん<>sage<>02/07/24 21:52<> <a href="../test/read.cgi/tech/1027080631/153" target="_blank">&gt;&gt;153</a> <br>  <br> ﾋﾞｸｯ ∧ ∧ ∧ ∧  ／￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣ <br>  Σ(ﾟДﾟ；≡；ﾟдﾟ) ＜ うお！妄想厨が来ちまったぞｺﾞﾙｧ！ <br>    ./ つ つ   ＼＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿ <br>   〜（＿⌒ヽ ﾄﾞｷﾄﾞｷ <br>     )ノ ｀Jззз <>
デフォルトの名無しさん<><>02/07/24 22:33<> age <>
ひげぽん<><>02/07/24 23:01<> idtあまり進まず <br> ↓定義して終わってるていうか勉強中です。 <br>  <br> typedef&nbsp;struct&nbsp;idtr_st&nbsp;{ <br> &nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;int&nbsp;limit;&nbsp;&nbsp;&nbsp;&nbsp;/*!&nbsp;idtr&nbsp;limit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/ <br> &nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;int&nbsp;highbase;&nbsp;/*!&nbsp;base&nbsp;address&nbsp;of&nbsp;idtr&nbsp;*/ <br> &nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;int&nbsp;lowbase;&nbsp;&nbsp;/*!&nbsp;base&nbsp;address&nbsp;of&nbsp;idtr&nbsp;*/ <br> }; <br>  <br> <a href="../test/read.cgi/tech/1027080631/150" target="_blank">&gt;&gt;150</a> <br> &gt;それはそうと、バイナリフォーマットはどうするん？＞ひげぽん  <br> 正直に言うと、バイナリフォーマットにどんな種類があって <br> どのような特性があるか、不勉強のため分からないので <br> 勉強させてください。 <br>  <br> IDT早く終わらせたい。 <br>  <br> &gt;どうせならEROSで <br> これって何ですか？ <br>  <>
ひげぽん<><>02/07/24 23:04<> どこぞのサイト(英語)で読んだのですが、 <br> OS開発の際にC++を使おうとするならば <br> new,delete演算子を自分で実装しなければならない <br> みたいな事が書かれていたのですが、 <br> この辺を実装した例(ソース)とかないですかね。 <>
デフォルトの名無しさん<>sage<>02/07/24 23:12<> <a href="../test/read.cgi/tech/1027080631/157" target="_blank">&gt;&gt;157</a> <br> mallocだとしても自前で定義しないとダメでしょ <br> 少なくとも、今のところは管理すらされてない生のアドレスが露出してるだけだから。 <>
ひげぽん<>sage<>02/07/24 23:14<> <a href="../test/read.cgi/tech/1027080631/158" target="_blank">&gt;&gt;158</a> <br> そうですよね。 <br> そのへんて、メモリ管理をどうするか？ <br> ということが、きちんと設計できた時点で実装するんですよね。 <>
デフォルトの名無しさん<>sage<>02/07/24 23:25<> &gt;157 <br> EOTA の memory.c に malloc と free があった。 <br> あと K&R にも malloc と free が載ってる。 <br>  <>
ひげぽん<>sage<>02/07/24 23:35<> <a href="../test/read.cgi/tech/1027080631/160" target="_blank">&gt;&gt;160</a> <br> ありがとう！！ <>
デフォルトの名無しさん<>sage<>02/07/24 23:37<> <a href="../test/read.cgi/tech/1027080631/160" target="_blank">&gt;&gt;160</a> <br> だめだって。 <br> それをサポートするための低レベルメモリ管理を書かないと。 <br> MMUって言われている奴。 <>
ひげぽん<>sage<>02/07/24 23:43<> MMUってはじめて読む486で読んだんですけど・・・ <br> 486はハードウェアとしてMMUを持っているそうです。 <br> それをソフトウェアとして実装するということですか？ <>
デフォルトの名無しさん<>sage<>02/07/24 23:57<> <a href="../test/read.cgi/tech/1027080631/150" target="_blank">&gt;&gt;150</a>  <br>  　EROSはOSの名前のことだと思うけど・・・先越されてる？  <br>  http://www.eros-os.org/  <br>   <>
デフォルトの名無しさん<>sage<>02/07/25 01:04<> だめか・・。なら仕方なく K&R か、この辺りで、というのは？ <br> MMU は後回しで、まず、リニアアドレスでメモリ管理の練習ってのは悪くないと思う。 <br> ttp://www.amazon.co.jp/exec/obidos/ASIN/4797304952/ref%3Dlm%5Flb%5F11/249-4037071-2369146 <br>  <>
デフォルトの名無しさん<>sage<>02/07/25 01:10<> １０年程前に作りかけた仮想EMSドライバのソース(コメント少なくて理解できん)を <br> 眺めてたんだけど、プロテクトモードに移行する時に <br> ハードウェア割りこみ(IRQ)のベクタを変更してる。 <br> というのは、186以降で定義された無効命令とかの例外とベクタ番号が重なり <br> 処理が面倒くさくなるから。 <br> だから、8259Aを再初期化して、例外と重ならないように変更するといいかも。 <br> で、例外もエラーコードをスタックに残すのと残さないのがあるから、 <br> 何種類かにハンドラを分類してるな。 <br> それと、一般保護例外は特別扱いで、逆アセンブルして <br> ソフトウェア割りこみやHLT,I/Oポートの違反かを検出しているようだ。 <br> (ページングをONにしているので、DMAアクセスはアドレス変換が必要だから) <br> その他の割りこみ等はリアルモードの処理ルーチンをセットしてiretdしてた(V86だから)。 <br>  <br> 特別な処理が必要ない場合は、ハンドラの先頭で <br> 　push imm　; ←割りこみ番号 <br> 　jmp short INTR_Handler <br> みたいな感じでまとめてしまってる。 <br> ハンドラの最後は必ずiretdしなければいけないからアセンブラになるけど、 <br> その中からCのルーチンを呼ぶようにしておいて <br> 実際の処理はC/C++で書くのが楽なんじゃないのかな。 <>
デフォルトの名無しさん<>sage<>02/07/25 01:23<> <a href="../test/read.cgi/tech/1027080631/166" target="_blank">&gt;&gt;166</a> <br> ちょっとオーバーヘッドが気になるね。 <br> x86はせっかく割り込みベクタテーブル式で提供してくれてるんだから、 <br> 俺は有効活用したいと思うな。 <br>  <br> あと、割り込みハンドラであんまりスタック使いたくないしね。 <>
デフォルトの名無しさん<>sage<>02/07/25 01:54<> &gt; x86はせっかく割り込みベクタテーブル式で提供してくれてるんだから、 <br> うん、これはその通りだと思うけど、 <br> 実際、アセンブラソースに256個書いて保守するのはどうかと思ってさ。 <br>  <br> でも <br> &gt; ちょっとオーバーヘッドが気になるね。 <br> はどうだろ。 <br> そもそも、割りこみ処理は特権レベルの移行やらタスクの移行やらで <br> 普通のjump/callとは比較にならないほど複雑な処理をしてるよ。 <br> スタックもゲートに指定したパラメータサイズ分だけコピーされて <br> 一般的にカーネルスタックが使われるし。 <br> 確かに、カーネル内部でのスタック使用量は僅かに増えるかもしれないけどさ、 <br> それでも気にするほどのことかな。 <br>  <br> まあ、俺はコード書かないで口を出してるだけなんで、 <br> 変だと思ったら聞き流してくださいな。 <>
デフォルトの名無しさん<>sage<>02/07/25 02:06<> 直接スレの流れと関係なくてすんませんが、少し質問させてください。 <br> ハードリアルタイムのOSを実装できたらいいなと思い、勉強しているのですが <br>  <br> ・特定タスクのデッドラインを守れなかった場合はどうしたら良いんでしょうか。 <br> ・タイマーで厳密な意味で1msを計ることが出来ないのですが（n.nとなり、多少誤差が生じる）、 <br> 　この揺らぎってどうしたら良いんでしょうか。 <br>  <>
168<>sage<>02/07/25 02:19<> なんか適当なこと書いてた気がする。 <br> 割りこみでタスクが切り替わるのはタスクゲートだけだね、確か。 <br> 割りこみゲートやトラップゲートではコールゲート呼び出しと同じなので、 <br> タスクは切り替わらない(当たり前)。 <br> スタックの切替はゲートの特権レベルによって違うかも。 <br> もしかしたらユーザーモード実行中に割り込みが発生した場合のみかも。 <br>  <br> よく覚えてないや。ごめん、ホントいい加減で。 <>
超先生@OS板  </b>◆OS/dd1Xc <b><>sage<>02/07/25 02:37<> 　∧＿∧ <br>  ＜ ｀ー´＞y-~~~ OS板より出張。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/169" target="_blank">&gt;&gt;169</a> <br> &gt; ・特定タスクのデッドラインを守れなかった場合はどうしたら良いんでしょうか。 <br>  <br> 何があろうとdeadlineを死守する必要があるからhard-realtimeなのだが。。。 <br>  <br> &gt; ・タイマーで厳密な意味で1msを計ることが出来ないのですが（n.nとなり、多少誤差が生じる）、 <br> &gt; 　この揺らぎってどうしたら良いんでしょうか。 <br>  <br> そのプラットフォームは？ <br> PC/ATの場合は1.19318MHzでドライブされてるから、 <br> 8254Aのカウント値を補正する必要があるけど。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/170" target="_blank">&gt;&gt;170</a> <br> スタックが切り替わるのは、non-conformingで上位のprivilaged-levelへ遷移する場合だったと思う。 <>
デフォルトの名無しさん<>sage<>02/07/25 02:54<> <a href="../test/read.cgi/tech/1027080631/171" target="_blank">&gt;&gt;171</a> <br> レスどうもです。 <br>  <br> &gt;何があろうとdeadlineを死守する必要があるからhard-realtimeなのだが。。。 <br>  <br> 勿論それは承知してますし、普通は起きそうもないケースなのですが、 <br> 動的タスク生成をサポートする非組み込みのRTOSって出来ないかなって思ってるので、 <br> 最高優先度のタスクが処理能力の上限を超えて作られた場合の心配をしてます。 <br>  <br> &gt;8254Aのカウント値を補正する必要があるけど。  <br>  <br> やっぱり補正する必要があるんですね、適当なOSのソースを見るのがよさげですね。 <>
ろうひ男爵<><>02/07/25 06:18<> バイナリーの形式だけど、  <br> linkers&loadersっていうズバリの本がオーム社から出てるよ。  <br> coffもomfも出てて3200円は安いっす。  <br>  <br> 386関連の本は、  <br> 80486の使い方 スルヤント オーム社  <br> で、用語を覚える  <br>  <br> はじめて読む486 アスキー  <br> で、動かしてみる  <br>  <br> 386BSDカーネルソースの秘密　アスキー  <br> で、大規模実装の例を見る  <br>  <br> 自分はといった感じで読み進めました。  <br> それとは別に8259A,8251,8253,8255の各サンプルを読みました <>
デフォルトの名無しさん<><>02/07/25 09:11<> このスレって年齢層高い？ <>
デフォルトの名無しさん<>sage<>02/07/25 09:22<> 正直、インテル・アーキテクチャソフトウェア・ディベロッパーズ・マニュアル <br> の下巻だけあれば事足りる感じなんだが。 <br>  <>
デフォルトの名無しさん<>sage<>02/07/25 09:29<> <a href="../test/read.cgi/tech/1027080631/175" target="_blank">&gt;&gt;175</a>  <br>  事足りるって？ <>
デフォルトの名無しさん<>sage<>02/07/25 09:38<> <a href="../test/read.cgi/tech/1027080631/176" target="_blank">&gt;&gt;176</a> <br> はじめて読む〜系の本は必要ないと思う <>
ひげぽん<>sage<>02/07/25 23:14<> idtコーディング中。 <br> 突破口が開けたかも・・・ <>
デフォルトの名無しさん<><>02/07/25 23:54<> 前スレあげた馬鹿がいるからage <>
デフォルトの名無しさん<><>02/07/26 01:03<> ひげぽんがんばれ。 <br>  <>
ろうひ男爵<><>02/07/26 15:52<> やっと読み終わった。 <br> lodsでcsの時には、 <br> lods byte ptr cs:[si] <br> ですよ&gt;ひげぽん <br>  <>
ひげぽん<><>02/07/26 20:18<> &gt;&gt;ろうひ男爵 <br> &gt;odsでcsの時には、 <br> &gt;lods byte ptr cs:[si] <br> &gt;ですよ&gt;ひげぽん <br> すいませんもう少し詳しくお願いします。 <br>  <br> だれか。 <br> idtの8byteのうち先頭から <br> 2byte <br> 2byte <br> 1byte <br> 1byte →ここ。 <br> 2byte <br>  <br> の部分って0xf、0xeとかが入ると思うんですけど <br> 値とその意味の詳細とか載っている資料とかWeb上でありましたら <br> 教えてください。 <br>  <br>  <br>  <br>  <>
デフォルトの名無しさん<>sage<>02/07/26 20:24<> Intelの例の３部作の下巻 <br> 5.9.IDTディスクリプタ <br> に詳細が書いてある <>
ひげぽん<><>02/07/26 20:36<> <a href="../test/read.cgi/tech/1027080631/183" target="_blank">&gt;&gt;183</a> <br> ありがとう。 <br> 覚悟を決めて読むしかなくなくなってきた(笑) <>
デフォルトの名無しさん<>sage<>02/07/26 20:37<> http://www.intel.co.jp/jp/developer/design/pentium/manuals/ <br> http://www.intel.co.jp/jp/developer/design/pentium4/manuals/ <br> ここからだね。 <br> でも、どっちが良いんだろ。なんかサイズ違うし。 <br> pen4向けのガイドが少し増えてるのかな。 <br> (俺が昔落としたpen3向けのpdfは見当たらない) <>
デフォルトの名無しさん<>sage<>02/07/26 20:40<> 覚悟を決めてっていうか・・・ <br> すごく丁寧に書いてあると思うんだけど。 <>
デフォルトの名無しさん<>sage<>02/07/26 20:44<> 下の方で良いんじゃないの？ <br> 将来P4についても調べたくなったとき、差分を探して読む手間が省ける。 <>
ろうひ男爵<><>02/07/26 20:53<> <a href="../test/read.cgi/tech/1027080631/182" target="_blank">&gt;&gt;182</a> <br> ごめん、ひげほんさんじゃなかったですね。 <br> お詫びに、IDT <br> 07bit P <br> 06bit DPL <br> 05bit DPL <br> 04bit 0 <br> 03bit 1 <br> 02bit 1 <br> 01bit 1 <br> 00bit 0:割り込みゲート,1:トラップゲート <br> です。 <br>  <>
ひげぽん<><>02/07/26 21:22<> <a href="../test/read.cgi/tech/1027080631/188" target="_blank">&gt;&gt;188</a> <br> ありがとう。 <br> 軽く読んでみたところでは <br> 11101110=0x76 <br> かなと思っています。 <br>  <>
超先生@OS板  </b>◆OS/dd1Xc <b><>sage<>02/07/26 21:58<> <a href="../test/read.cgi/tech/1027080631/189" target="_blank">&gt;&gt;189</a> <br> interrupt-requestを受け付ける用途には、 <br> P=1,DPL=0,interrupt-gate <br> で10001110=0x8eが一般的だと思う。 <>
ひげぽん<><>02/07/26 22:19<> <a href="../test/read.cgi/tech/1027080631/190" target="_blank">&gt;&gt;190</a>　OS板の方ですか。 <br> &gt;interrupt-requestを受け付ける用途には、 <br> &gt;P=1,DPL=0,interrupt-gate <br> &gt;で10001110=0x8eが一般的だと思う。 <br> 最も大きい特権レベルとして安易に1としてはだめということですね。 <br>  <br> load idtrを実行するところまで一応実装してみたのですが、 <br> 見事に3rd exceptionになりました。 <br> load idtrまでは、一応何事もなく。動くのですが <br> 割り込み許可(_sysUnlock=sti)すると例外があがります。 <br>  <br> そもそも、いまWebにアップロードしている <br> ひとつ古いバージョンでも_sysUnlockすると例外があがる気がする。 <br>  <br> なんでだ・・・・・ <br>  <br>  <br>  <br>  <>
超先生@OS板  </b>◆OS/dd1Xc <b><>sage<>02/07/27 00:37<> 　∧＿∧ <br>  ＜ ｀ー´＞y-~~~  <br> <a href="../test/read.cgi/tech/1027080631/191" target="_blank">&gt;&gt;191</a> <br> &gt;3rd exception <br>  <br> IDTが正しく指されていないか、もしくは <br> GateのSegment-selector値が不正というところか。。。 <br>  <br> &gt;load idtrを実行するところまで一応実装してみたのですが、 <br>  <br> PIC側でINTRを止めておかないと、 <br> stiした瞬間に設定されていないベクタ(ゲート)へ飛び込んでしまうけど。 <br> もしくはダミーでもよいのでIRQハンドラを立てておく必要あり。 <>
ひげぽん<><>02/07/27 00:43<> <a href="../test/read.cgi/tech/1027080631/192" target="_blank">&gt;&gt;192</a> 超先生@OS板さん <br> ありがとうございます。 <br>  <br> &gt;IDTが正しく指されていないか、もしくは <br> &gt;GateのSegment-selector値が不正というところか。。。 <br> この辺からですかね。 <br>  <br> &gt;PIC側でINTRを止めておかないと、 <br> &gt;stiした瞬間に設定されていないベクタ(ゲート)へ飛び込んでしまうけど。 <br> &gt;もしくはダミーでもよいのでIRQハンドラを立てておく必要あり <br> ダミーでハンドラを立てる場合は0から255のうち必要ないものはすべて <br> ダミーにすればよいんですよね。 <br>  <br> セレクタが違うのかなあ。 <br>  <br>  <br>  <br>  <>
デフォルトの名無しさん<>sage<>02/07/27 00:58<> なぜ超先生がム板にいるんだろ <>
デフォルトの名無しさん<>sage<>02/07/27 01:37<> <a href="../test/read.cgi/tech/1027080631/194" target="_blank">&gt;&gt;194</a> <br> 超先生プログラム書けるじゃない。 <br> おまけゲーム作ってたような。 <br>  <>
デフォルトの名無しさん<>sage<>02/07/27 01:48<> シナリオよりソッチの才があるんだろ。スレ違いsage <>
ひげぽん<><>02/07/27 10:47<> うーん。動かず。 <br> 今週末の目標は何とかこいつを動かすことですね。 <br> ↓ <br> http://oshigepon.tripod.co.jp/ <br>  <br> とりあえずダミーのハンドラを用意したので <br> またアドレス違いとかなのかな･･ <br>  <br> ここがおかしいじゃないかなど、突っ込み募集です。 <>
超先生@OS板  </b>◆OS/dd1Xc <b><>sage<>02/07/27 13:37<> 　∧＿∧ <br>  ＜ ｀ー´＞y-~~~  <br> &gt;_sysLoadIdtr((idtr_st*)IDT_BASE); <br>  <br> &gt;void _sysLoadIdtr(idtr_st* idtr) { <br> &gt; <br> &gt;    asm("lidt (%0) ": :"p" (idtr)); <br> &gt;   return; <br> &gt;} <br>  <br>  <br> IDTとIDTRの扱いがゴチャゴチャになってるような・・・。 <br> _sysLoadIdtrにはIDTへのポインタを渡すのが正解。 <br>  <br> void _sysLoadIdtr(idt_st* idt) { <br> 　　idtr_st idtr; <br>  <br> 　　idtr.limit = sizeof(idt_st)*HANDLER_NUM-1; <br> 　　idtr.highbase = hiword(idt); <br> 　　idtr.lowbase  = loword(idt); <br> 　　..... <br>  <br> 　　asm("lidt (%0) ": :"p" (idtr)); <br> 　　return; <br> } <>
デフォルトの名無しさん<>sage<>02/07/27 14:47<> /*! struct for idtr */ <br> typedef struct idtr_st { <br>     unsigned int limit;    /*! idtr limit           */ <br>     unsigned int highbase; /*! base address of idtr */ <br>     unsigned int lowbase;  /*! base address of idtr */ <br> }; <br>  <br> 32ビットコンパイラならunsigned int = 32bitじゃ？ <br> で、IDTRはlimit 16bit、base 32bitの48bit。 <>
デフォルトの名無しさん<>sage<>02/07/27 14:57<> 構造体の詰め物も考慮してる？ <>
ひげぽん<><>02/07/27 18:05<> <a href="../test/read.cgi/tech/1027080631/198" target="_blank">&gt;&gt;198</a>,<a href="../test/read.cgi/tech/1027080631/199" target="_blank">&gt;&gt;199</a> 超先生@OS板さん <br> ありがとうございます。 <br> ご指摘のIDTR IDTの混同部分と、 <br> IDTRのサイズ間違いを修正いたしました。 <br> http://oshigepon.tripod.co.jp/ <br>  <br> あいかわらず3rd exceptionが発生いたします。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/200" target="_blank">&gt;&gt;200</a> <br> 構造体の詰め物とは何でしょうか。 <br> 構造体が自分の期待しているサイズと異なってしまうということでしょうか。 <br>  <br>  <>
デフォルトの名無しさん<>sage<>02/07/27 18:15<> 「構造体　パディング」で検索して見ましょう。 <>
超先生@OS板  </b>◆OS/dd1Xc <b><>sage <>02/07/27 18:44<> IDT_LOWBASE・IDT_HIGHBASEというのは一体・・？ <br> ↓で十分だと思う。。 <br>  <br> typedef struct idtr_st { <br> 　　unsigned short limit;　　/*! idtr limit           */ <br> 　　unsigned int base;　　　/*! base address of idtr */ <br> }; <br>  <br>     /* idtr set up */ <br>     idtr.limit    = sizeof(idt_st) * HANDLER_NUM -1; <br>     idtr.base = IDT_BASE; <br>      <>
超先生@OS板  </b>◆OS/dd1Xc <b><>sage<>02/07/27 18:55<> もう一点。要点は、 <br>  <br> /*! struct for interrupt handler */ <br> typedef struct handler_st { <br> 　　int number;       /* handler number              */ <br> 　　int (*handler)(); /* pointer to handler function */ <br> }; <br>  <br> &gt;/* set idt */ <br> &gt;idt-&gt;offsetL  = (int)(p-&gt;handler) & 0x0000FFFF; <br> &gt;idt-&gt;offsetH  = ((int)(p-&gt;handler) & 0xFFFF0000) &gt;&gt; 16; <br>  <br> ・戻り値や引数を伴う関数は直接ゲートには置けない。 <br> ・外部割り込み要因からの復帰はiretd命令を使用する必要がある。 <br> ・なので、stack frameを破棄するコードは自分で実装する必要がある。(例えばenter,leave命令) <>
ひげぽん<><>02/07/27 19:51<> _sysPrintIntを作成して <br> 構造体のサイズを調べました。 <br> size of idtr_st = 6byte <br> size of idt_st  = 8byte <br> となりました。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/203" target="_blank">&gt;&gt;203</a>, 204 超先生@OS板さん <br> ありがとうございます。 <br>  <br> &gt;・戻り値や引数を伴う関数は直接ゲートには置けない。 <br> handlerの戻り値をvoidにしました。 <br>  <br> とりあえず割り込みがあったら、ハンドラにジャンプし <br> そのなかで無限ループに入るというのを最初の第一歩として <br> やろうかと思っております。 <br>  <br> 3rd exception 発生中。 <br> http://oshigepon.tripod.co.jp/ <br>  <br>  <br>  <>
デフォルトの名無しさん<><>02/07/27 19:57<> <a href="../test/read.cgi/tech/1027080631/201" target="_blank">&gt;&gt;201</a> <br> ねえねえこれ間違ってない ? (外出だったらスマソ) <br>  <br> #define IDT_HIGHBASE 0x6800 /* idt low base address */ <br>  <br> たぶん上の行をコピベしたと思うけど、0x0000 だと思うが...。 <br> (ついでに、コメントも直しておいた方がいいと思う。) <br>  <br> というか、俺なら IDT_HIGHBASE と IDT_LOWBASE の定義を止めて <br> /* idtr set up */ <br> idtr.limit    = sizeof(idt_st) * HANDLER_NUM -1; <br> idtr.highbase = (IDT_BASE &gt;&gt; 16) & 0x0000FFFF; <br> idtr.lowbase  = (IDT_BASE &gt;&gt;  0) & 0x0000FFFF; <br>  <br> と書くと思う。 <br>  <br> あと、3rd Exception が発生した時のログ (レジスタの値) を見せて <br> あげると、わかる人ならバグの場所が特定しやすくなると思うよ。 <br> (俺には、無理だけど...。) がんばってね。 <>
ひげぽん<><>02/07/27 20:04<> <a href="../test/read.cgi/tech/1027080631/206" target="_blank">&gt;&gt;206</a> <br> 間違っております。やらかしてました。 <br> 訂正いたしました。 <br>  <br> 3rd exceptionがおきたときのレジスタ内容です。 <br> #&nbsp;In&nbsp;bx_gui_c::exit(void)! <br> 00000309028i[CPU&nbsp;&nbsp;]&nbsp;protected&nbsp;mode <br> 00000309028i[CPU&nbsp;&nbsp;]&nbsp;CS.d_b&nbsp;=&nbsp;32&nbsp;bit <br> 00000309028i[CPU&nbsp;&nbsp;]&nbsp;SS.d_b&nbsp;=&nbsp;32&nbsp;bit <br> 00000309028i[CPU&nbsp;&nbsp;]&nbsp;|&nbsp;EAX=00000fc4&nbsp;&nbsp;EBX=00000000&nbsp;&nbsp;ECX=0000a7c0&nbsp;&nbsp;EDX=0000a7c0 <br> 00000309028i[CPU&nbsp;&nbsp;]&nbsp;|&nbsp;ESP=00000fd8&nbsp;&nbsp;EBP=00000fec&nbsp;&nbsp;ESI=000000ee&nbsp;&nbsp;EDI=0000ffe4 <br> 00000309028i[CPU&nbsp;&nbsp;]&nbsp;|&nbsp;IOPL=0&nbsp;NV&nbsp;UP&nbsp;EI&nbsp;PL&nbsp;NZ&nbsp;AC&nbsp;PE&nbsp;NC <br> 00000309028i[CPU&nbsp;&nbsp;]&nbsp;|&nbsp;SEG&nbsp;selector&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;&nbsp;&nbsp;&nbsp;limit&nbsp;G&nbsp;D <br> 00000309028i[CPU&nbsp;&nbsp;]&nbsp;|&nbsp;SEG&nbsp;sltr(index|ti|rpl)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;&nbsp;&nbsp;&nbsp;limit&nbsp;G&nbsp;D <br> 00000309028i[CPU&nbsp;&nbsp;]&nbsp;|&nbsp;&nbsp;DS:0010(&nbsp;0002|&nbsp;0|&nbsp;&nbsp;0)&nbsp;00000000&nbsp;000fffff&nbsp;1&nbsp;1 <br> 00000309028i[CPU&nbsp;&nbsp;]&nbsp;|&nbsp;&nbsp;ES:0010(&nbsp;0002|&nbsp;0|&nbsp;&nbsp;0)&nbsp;00000000&nbsp;000fffff&nbsp;1&nbsp;1 <br> 00000309028i[CPU&nbsp;&nbsp;]&nbsp;|&nbsp;&nbsp;FS:0000(&nbsp;0000|&nbsp;0|&nbsp;&nbsp;0)&nbsp;00000000&nbsp;0000ffff&nbsp;0&nbsp;0 <br> 00000309028i[CPU&nbsp;&nbsp;]&nbsp;|&nbsp;&nbsp;GS:0000(&nbsp;0000|&nbsp;0|&nbsp;&nbsp;0)&nbsp;00000000&nbsp;0000ffff&nbsp;0&nbsp;0 <br> 00000309028i[CPU&nbsp;&nbsp;]&nbsp;|&nbsp;&nbsp;SS:0018(&nbsp;0003|&nbsp;0|&nbsp;&nbsp;0)&nbsp;00000000&nbsp;00000000&nbsp;1&nbsp;1 <br> 00000309028i[CPU&nbsp;&nbsp;]&nbsp;|&nbsp;&nbsp;CS:0008(&nbsp;0001|&nbsp;0|&nbsp;&nbsp;0)&nbsp;00000000&nbsp;000fffff&nbsp;1&nbsp;1 <br> 00000309028i[CPU&nbsp;&nbsp;]&nbsp;|&nbsp;EIP=000012cf&nbsp;(000012cf) <br> ======================================================================== <br> Bochs&nbsp;is&nbsp;exiting&nbsp;with&nbsp;the&nbsp;following&nbsp;message: <br> [CPU&nbsp;&nbsp;]&nbsp;exception():&nbsp;3rd&nbsp;exception&nbsp;with&nbsp;no&nbsp;resolution <br> ======================================================================== <br>  <>
ひげぽん<>sage<>02/07/27 20:05<> _sysPrintIntもっと早く作ればよかった。 <br> 結構重宝するかも。 <>
超先生@OS板  </b>◆OS/dd1Xc <b><>sage<>02/07/27 20:48<> &gt;/* idt size = 64bit */ <br> &gt;idt_st* idt = (idt_st*) IDT_BASE + p-&gt;number * sizeof(idt_st); <br>  <br> 演算が間違っているのでは。 <br> ↓こうだと思う。 <br>  <br> idt_st* idt = ((idt_st*) IDT_BASE) + p-&gt;number; <>
ひげぽん<><>02/07/27 21:18<> <a href="../test/read.cgi/tech/1027080631/209" target="_blank">&gt;&gt;209</a> 超先生@OS板さん <br> たびたびありがとうございます。 <br>  <br> &gt;/* idt size = 64bit */ <br> &gt;idt_st* idt = (idt_st*) IDT_BASE + p-&gt;number * sizeof(idt_st); <br> この計算の意図は、IDTをnumber番目にセットする <br> ためのアドレス計算なのですが・・・ <br> sizeof(idt)倍しなくて良いんですか？？？ <br> うーーん、でもとりあえず直してみるです。 <br> きっとおいらが間違えているんだろうな・・・ <br>  <br> 3rd exception 発生中。 <br> http://oshigepon.tripod.co.jp/ <br> rb2html.rbに感謝！ <br>  <br>  <>
デフォルトの名無しさん<><>02/07/27 21:40<> hige age <br> ここが踏ん張りどころだ。がんばれ。 <>
超先生@OS板  </b>◆OS/dd1Xc <b><>sage<>02/07/27 22:24<> 21| typedef struct idtr_st { <br>  22|     unsigned short limit;    /*! idtr limit           */ <br>  23|     unsigned short highbase; /*! base address of idtr */ <br>  24|     unsigned short lowbase;  /*! base address of idtr */ <br>  25| }; <br>  <br> little-endianなのでhighbaseとlowbaseは逆かな。 <>
ひげぽん<><>02/07/27 23:20<> <a href="../test/read.cgi/tech/1027080631/212" target="_blank">&gt;&gt;212</a>　超先生@OS板さん <br> 大変ありがとうございます。 <br> 3rd exception 回避できました。 <br>  <br> たぶん自分ひとりでは絶対気づきませんでした。 <br>  <br> とりあえず画面上にdummyと表示されたので <br> 何らかの割り込みが発生を捕まえたようです。 <br> ありがとうございます。 <br>  <br> http://oshigepon.tripod.co.jp/ <br> 割り込みcatch成功版 <br>  <>
ひげぽん<>sage<>02/07/27 23:22<> <a href="../test/read.cgi/tech/1027080631/212" target="_blank">&gt;&gt;212</a>　超先生@OS板さん  <br> 大変お世話になっております。 <br> 超先生@OS板さんって、どんな人なんですか。 <br> OSを作られたりしているのでしょうか？ <br> 今の私からすると、かなりすごい人です・・・・ <br>  <br>  <>
デフォルトの名無しさん<>sage<>02/07/27 23:30<> 最近忙しくて、ひさしぶりに来れたんだけど。 <br> なんか、偉い人召喚しちゃったの？ <>
デフォルトの名無しさん<><>02/07/27 23:47<> 割り込み成功？？？ <br> おめでとう。 <>
デフォルトの名無しさん<><>02/07/28 00:34<> 　 <>
デフォルトの名無しさん<>sage<>02/07/28 03:09<> <a href="../test/read.cgi/tech/1027080631/215" target="_blank">&gt;&gt;215</a> <br> OS板で最も実力を持っていると思われるﾔｼ。 <br> 当地ではチョンのAAを使って話をするので時々チョン先生と呼ばれることもある。 <>
デフォルトの名無しさん<><>02/07/28 11:55<> 久しぶりに来たら、ひげぽんがまだがんばってる･･･ <br> しかも、かなり進化してる･･･ <br> ひげぽんお前さん本気だな。 <br> source forgeでプロジェクト申請したら？？？ <>
デフォルトの名無しさん<>sage<>02/07/28 14:29<> そろそろOSの設計部分について語ろうぜ。 <br> APIはどうするの？ <>
デフォルトの名無しさん<><>02/07/28 15:26<> チョン先生！！ <>
ひげぽん<><>02/07/28 16:16<> <a href="../test/read.cgi/tech/1027080631/219" target="_blank">&gt;&gt;219</a> <br> &gt;source forgeでプロジェクト申請したら？？？ <br> もうすこし成熟してからにしようかと･･･ <br> 後は賛同者がいればって感じです。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/220" target="_blank">&gt;&gt;220</a> <br> &gt;APIはどうするの？ <br> C++のクラスライブラリとして提供できればと思っているのですが、、、 <br> まだ先ですね。 <br>  <br>  <br>  <br>  <>
デフォルトの名無しさん<>sage<>02/07/28 16:43<> <a href="../test/read.cgi/tech/1027080631/222" target="_blank">&gt;&gt;222</a> <br> C++のクラスはやめとけ。 <br> どうしてもというのなら、低レベルAPIをC互換で作り、 <br> WinのCOMのような形で提供するべき。 <>
ひげぽん<><>02/07/28 16:49<> <a href="../test/read.cgi/tech/1027080631/223" target="_blank">&gt;&gt;223</a> <br> &gt;C++のクラスはやめとけ。 <br> &gt;どうしてもというのなら、低レベルAPIをC互換で作り、 <br> &gt;WinのCOMのような形で提供するべき。 <br> 理由も教えていただけるとありがたいのですが、 <br> 何かの経験上でしょうか。 <br>  <br> もちろん低レベルAPIはCの関数として実装するとは思いますが、 <br> C++のクラスでメインの機能を提供しようと思っています。 <br>  <br> OSの主要な機能は、そのインスタンスを介して利用する形にしたいです。 <br> インスタンス間(OSのさまざまな機能間)の連携は <br> observerパターンなどを使おうと思っています。 <br>  <br>  <br>  <br>  <br>  <>
デフォルトの名無しさん<>sage<>02/07/28 16:52<> <a href="../test/read.cgi/tech/1027080631/224" target="_blank">&gt;&gt;224</a> <br> C++の名前修飾や呼び出し規約はコンパイラ間で互換性がまったくない。 <>
ひげぽん<>sage<>02/07/28 16:58<> <a href="../test/read.cgi/tech/1027080631/225" target="_blank">&gt;&gt;225</a> <br> ということは、C++でクラスライブラリを提供する場合は <br> 特定コンパイラ向けになってしまうということでしょうか。 <br> 良く分からないのですが、C++の標準の機能を利用するだけでも <br> 大きな影響があるのでしょうか。 <>
デフォルトの名無しさん<><>02/07/28 17:10<> 荒らしに来ました。 <br> 今からここをメチャクチャにします。 <br> 応援ヨロシク！ <>
デフォルトの名無しさん<>sage<>02/07/28 17:11<> <a href="../test/read.cgi/tech/1027080631/226" target="_blank">&gt;&gt;226</a> <br> シンボルをすべてextern "C"にするか、 <br> OSのコンパイルに使ったコンパイラの呼び出し規約と修飾された名前を <br> 理解してくれる処理系でないと、ネイティブの実行ファイルが作れなくなる。 <>
ひげぽん<>sage<>02/07/28 17:22<> <a href="../test/read.cgi/tech/1027080631/228" target="_blank">&gt;&gt;228</a> <br> ということは、 <br> higeposはgccでコンパイルしているので <br> g++用クラスライブリになってしまうということですね。 <br>  <br> ということは、higeposのアプリケーションを作るときに <br> C++コンパイラは、g++を使わなければいけなくなるということですね。 <br>  <br> これってアプリ開発者側から見て大きなデメリットでしょうか。 <br> この辺の切り分けが出来ればよいかと思っています。 <br>  <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/07/28 17:40<> これからは↑でいきます。 <>
デフォルトの名無しさん<>sage<>02/07/28 17:42<> <a href="../test/read.cgi/tech/1027080631/229" target="_blank">&gt;&gt;229</a> 非常に制限が大きくなると思います <br> 　将来GCCがバージョンアップされたらOS毎再コンパイルが必要だし <>
ひげぽん </b>◆zcp/NZpA <b><><>02/07/28 17:45<> <a href="../test/read.cgi/tech/1027080631/231" target="_blank">&gt;&gt;231</a>　うーんなるほど・・・・ <br> gccが下位互換になるとは限らないということですね。 <br> こまったなあ。 <br>  <br> 独自コンパイラ作るのきっとしんどいだろうし・・・ <br> うーんどうしよう。 <br> 今頭の中にあるOSは、オブジェクト指向なんですよ･･･ <br> Cでオブジェクト指向実装するのは面倒だな･･(不可能ではないが) <br>  <>
デフォルトの名無しさん<>sage<>02/07/28 17:52<> <a href="../test/read.cgi/tech/1027080631/232" target="_blank">&gt;&gt;232</a> <br> C++からしか使うことが出来ないようになるから、 <br> やっぱり言語に依存しないインターフェイスモデルを構築した方がいい。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/07/28 18:04<> 既存のOSはどういう、アプローチをとっているんだろう。 <br> やっぱりCでAPIを提供しているんだろうか。 <br>  <>
デフォルトの名無しさん<>sage<>02/07/28 18:07<> c++で提供しているのはBeくらい <br>  <>
デフォルトの名無しさん<>sage<>02/07/28 18:10<> 便乗　Beはどのようなアプローチ？ <br> C++でも提供してるの？それともC++ only? <br>  <>
デフォルトの名無しさん<>sage<>02/07/28 18:13<> OS作った奴が近大の理工学部で教授やってるから <br> 聞いてみれ。 <br> アドバイスくれるかも。 <>
デフォルトの名無しさん<>sage<>02/07/28 18:37<> <a href="../test/read.cgi/tech/1027080631/225" target="_blank">&gt;&gt;225</a> <br> &gt; C++の名前修飾や呼び出し規約はコンパイラ間で互換性がまったくない。 <br> なんか誤解してない ? そんなこと言うと C だって互換性 100% じゃないよ。 <br>  <br> もし、OS の保護機構なんて要らないと言うことで、ユーザープログラムも OS <br> も全て C++ 等で書いて直接 (あたかもサブルーチンコールのように) 呼び出す <br> と言うのならその通りなんだけど、普通そんなことはしない。 <br>  <br> 最近 OS では、API は最終的にはソフトウェア割込みで行っているのが普通。 <br> 大概のプロセッサは割込み以外の方法ではユーザーモードからシステムモード <br> への切替をできないようになってるから、保護機能等を使うのであれば、これ <br> はほぼ必須。 <br>  <br> 通常 read(fp, buff, size) とか言ってる API は、全部その言語用のラッ <br> パーだよ。だから、 <br> <a href="../test/read.cgi/tech/1027080631/231" target="_blank">&gt;&gt;231</a> <br> &gt; 将来GCCがバージョンアップされたらOS毎再コンパイルが必要だし <br> と言うことは無い。第一そんなことしたら、その時動作しているコマンドや <br> サービス等のプログラムも再コンパイルが必要になる。 <br> ただし、コンパイラが変わったらライブラリの再コンパイルは必要。 <>
デフォルトの名無しさん<>sage<>02/07/28 18:44<> <a href="../test/read.cgi/tech/1027080631/238" target="_blank">&gt;&gt;238</a> <br> あんたも古いな。 <br> 最近は割り込み〜じゃなくて、割り込み自体は昔から使われていた。 <br> それより一歩進んだ方法として、たとえばIA32ではコールゲートがある <>
デフォルトの名無しさん<>sage<>02/07/28 18:46<> &gt;と言うことは無い。第一そんなことしたら、その時動作しているコマンドや  <br> &gt;サービス等のプログラムも再コンパイルが必要になる。  <br>  <br> 名前修飾に互換性がある保証がないから、 <br> 存在しないシンボルを呼び出すことになる可能性があるって事だろ <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/07/28 19:07<> この辺はこれからの設計にもかかわる重要項目ですね。 <br> ところで <br> OSのカーネルがC++で組まれている事と <br> OSの提供するAPIがC++のクラスライブラリであることは <br>  <br> ある程度別問題として考えることって出来ますか？ <br> うーん日本語が変ですね・・・ <>
デフォルトの名無しさん<>sage<>02/07/28 20:10<> <a href="../test/read.cgi/tech/1027080631/239" target="_blank">&gt;&gt;239</a> <br> &gt; それより一歩進んだ方法として、たとえばIA32ではコールゲートがある <br> コールゲートが一歩進んでいるかは別にして、コールゲートを使っても <br> 話は一緒だよ。IA32 プロセッサは保護モードの時に far Call を割り込 <br> みの様に扱うだけだよ。(スタックのコピーとか特権チェックとか色々プロ <br> セッサでやってくるけどね。) 普通のサブルーチン呼び出しと同じように <br> は呼べないよ。 <br> コンパイラを改造して OS 呼び出しって言うのを認識する (例えば、関数 <br> の属性として API 属性と言うのを定義できるようにして、その関数を呼び <br> 出す時は far Call を生成する。) ようにすれば、呼び出すことはできる <br> ようになるとは思うけど、ポインタ経由で呼び出された時にも対応する <br> (=ポインタにそう言う属性をつける ?) とか考えると、あんまり実用的に <br> は思えない。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/241" target="_blank">&gt;&gt;241</a> <br> 基本的には別問題。 <br> ファイル操作 API を C++ 風に... <br> file f; <br> f-&gt;open("foo", ReadOnly); <br> f-&gt;read(buff, size); <br> f-&gt;close(); <br> となるけど、これアセンブラレベルで見たら全て this ポインタを伴って <br> 呼び出されている。結局今時の OS で、ファイルディスクリプタを使うの <br> と (OS から見れば) 大して変わらない。 <br> 今時の OS は、デバイスでもファイルでも同じ方法で、read/write でき <br> るけど、結局これも OS 内で C++ で言うところの仮想関数呼び出しをし <br> て実現している。そう言う意味で、カーネル (特にデバイスドライバ) を <br> C++ で書くとそれなりにきれいになるのではとちょっと期待している。 <>
デフォルトの名無しさん<>sage<>02/07/28 20:29<> &gt;コンパイラを改造して OS 呼び出しって言うのを認識する （略） <br>  <br> windowsのdllのインポートライブラリのように、 <br> スタブを用意すればいいんじゃないの？ <>
デフォルトの名無しさん<>sage<>02/07/28 21:31<> <a href="../test/read.cgi/tech/1027080631/243" target="_blank">&gt;&gt;243</a> <br> dll 作成した時にできるヘッダーファイル見たことありませんか ? <br> __declspec(dllimport) と言う思いっきり Microsoft 独自 (とは限らないけ <br> ど、ANSI 非互換の) 関数属性が定義されてますよ。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/242" target="_blank">&gt;&gt;242</a> に書いたコンパイラの改造は、あくまでも一例です。他にも、OS の API <br> 関数は例えば、0x00010000 以下に置くと決めといて、その領域はわざとユー <br> ザー空間にはマップしないでおく。API 関数が呼び出されたら、アクセスエラー <br> の例外が発生するので、これをトラップしておもむろに OS 側でどのように呼び <br> 出されたかを調べて本物の関数を呼び出すようにすれば、コンパイラの改造はい <br> らない。 <>
デフォルトの名無しさん<>sage<>02/07/28 21:33<> <a href="../test/read.cgi/tech/1027080631/241" target="_blank">&gt;&gt;241</a> <br> &gt; この辺はこれからの設計にもかかわる重要項目ですね。 <br> そろそろ、作ろうとしている OS の特徴を決める時期かも...。 <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/07/28 21:57<> <a href="../test/read.cgi/tech/1027080631/242" target="_blank">&gt;&gt;242</a> <br> &gt;基本的には別問題。 <br> &gt;ファイル操作 API を C++ 風に... <br> &gt;file f; <br> &gt;f-&gt;open("foo", ReadOnly); <br> &gt;f-&gt;read(buff, size); <br> &gt;f-&gt;close(); <br> OSのカーネルをC++で実装したとします。 <br> 例えばファイルシステムの一部を <br> 構造体や連結リストで表現するのではなく <br> クラスで表現したとします。 <br> しかし公開するAPIはCの関数で、その関数の中でクラスライブラリを操作 <br> している場合も何か問題が発生するのでしょうか。 <br> 分かりづらい質問かもしれませんが・・・ <br> よろしくお願いいたします。 <br>  <>
デフォルトの名無しさん<>sage<>02/07/28 21:58<> <a href="../test/read.cgi/tech/1027080631/244" target="_blank">&gt;&gt;244</a> __declspec(dllimport) これは省略できますがなにか？ <>
デフォルトの名無しさん<>sage<>02/07/28 22:01<> <a href="../test/read.cgi/tech/1027080631/246" target="_blank">&gt;&gt;246</a> <br> 問題ない。 <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/07/28 22:16<> <a href="../test/read.cgi/tech/1027080631/245" target="_blank">&gt;&gt;245</a> <br> &gt;そろそろ、作ろうとしている OS の特徴を決める時期かも...。 <br> まさに、今その時期かも。 <br> とりあえず開発側から見たつくりの特徴としては <br> ・カーネルの機能をコンポーネント化して、そいつらの結びつき <br> 　は疎結合(メッセージング?) <br> ・当面は、CUIだけ。unixのようにGUIはサーバーを通す? <br> ・入出力を何らかの方法で高度に抽象化したい。 <br> ・当然日本語OK(マルチバイト対応) <br> ・ネットワーク機能はOSにくみこむ？？ <br> ・出来れば分散環境を意識したつくりにしたい。 <br> ・とにかくつくりをすっきりしたい、設計･実装どちらもスマートに <br> 　ある程度パフォーマンスを犠牲にしてもきれいなつくりを維持する。 <br> ・過去の遺産は引きずらない <br>  <br> いま思いつくのはこれくらいかな。 <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/07/28 22:24<> <a href="../test/read.cgi/tech/1027080631/248" target="_blank">&gt;&gt;248</a> <br> ありがとう。 <br> そういうことであれば、自分のやりたいことは <br> 最低限実現できそうです。 <>
デフォルトの名無しさん<>sage<>02/07/28 22:36<> &gt;・入出力を何らかの方法で高度に抽象化したい。  <br>  <br> unixでもデバイスをファイルとして扱えるけど、 <br> 具体的にどう抽象的でないと思う？ <br>  <br> &gt;・当然日本語OK(マルチバイト対応)  <br>  <br> これは何？ <br> CES依存で作るの？ <br>  <br> &gt;・出来れば分散環境を意識したつくりにしたい。  <br>  <br> 分散カーネルなんて聞いたこともないけど、どうすんの？ <br> DCOMのような分散システムをもっとアプリケーションよりの層に作るのなら、 <br> 他OSでも実現されているし、実現自体は特に問題ないと思うけど。 <br>  <>
デフォルトの名無しさん<>sage<>02/07/28 22:59<> <a href="../test/read.cgi/tech/1027080631/247" target="_blank">&gt;&gt;247</a> <br> そん時は、リンカがサンクコードとリンクするだけのこと。(一段階の間接参照 <br> だけだけど) API のラップと概念的には変わらないよ。 <>
DQN<>sage<>02/07/28 23:23<> よくわからんがplan9に近いんでない？ <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/07/28 23:31<> <a href="../test/read.cgi/tech/1027080631/251" target="_blank">&gt;&gt;251</a> <br> こんばんわ <br> &gt;unixでもデバイスをファイルとして扱えるけど、 <br> &gt;具体的にどう抽象的でないと思う？ <br> うーん。すいませんまだきっちりと固まってないので <br> 表現しきれないのです。インターフェースとしては同じですが。 <br> 内側の仕組みをもっとすっきり出来ないかなと･･･ <br>  <br> &gt;&gt;・当然日本語OK(マルチバイト対応) <br> &gt;これは何？ <br> &gt;CES依存で作るの？ <br> 無知ですいません。CESってなんですか。 <br> 2byte文字もきちんと意識しようってことです。 <br>  <br>  <br>  <>
デフォルトの名無しさん<><>02/07/28 23:47<> ruby内蔵 <br>  <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/07/28 23:51<> <a href="../test/read.cgi/tech/1027080631/255" target="_blank">&gt;&gt;255</a> <br> &gt;ruby内蔵 <br> シェルとしてということですか？ <br> 可能と思いますがOSのカーネルの設計段階ではあまり <br> 関係ないかなと思います。 <>
ひげぽん </b>◆zcp/NZpA <b><>higepon@tokyo24.com<>02/07/29 00:19<> 板を汚してすいません。 <br> 以下の募集を行います。 <br> まじめです。 <br> http://pc3.2ch.net/test/read.cgi/tech/1024411711/ <br> [募集] <br> higepos(仮称)の開発PJの要員 <br> higeposとは、2002/06/18から開発が始まった新しいOSです。 <br> とりあえずひげぽんは本気でOSを作ろうと考えています。 <br>  <br> [現在のメンバー] <br> プロジェクトリーダーのひげぽんだけです。 <br>  <br> [これからの予定タスク] <br> (1)簡単なプロトタイプの実装。http://oshigepon.tripod.co.jp <br> (2)OSの設計。 <br>  <br> (1)(2)を並行して行っていこうと思います。 <br>  <br> [注] <br> ひげぽんは、仕事をしているため <br> higeposの開発ばかりに完全には専念できません。 <br> ご了承ください。 <br>  <br> 興味がある方は、ひげぽん宛にメールをください。 <br> Subjectを[higepos]としていただけるとありがたいです。 <br>  <br> Webデザイナーさんとかも来てくれたらうれしいです。 <br> ひげぽんはデザインセンスが0なので・・・ <br>  <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/07/29 00:23<> すいません1点書き忘れました <br> 現状の知識は問いません。 <br> そのとき必要な知識を勉強すれば良いですし。 <br> 役割分担があると思うので。 <br>  <br> メールはすぐに返事を出します。 <br> もし2日たっても返事が来ない場合は、すいませんがここに書き込みしてくれると <br> ありがたいです。 <br>  <>
デフォルトの名無しさん<>sage<>02/07/29 00:33<> <a href="../test/read.cgi/tech/1027080631/254" target="_blank">&gt;&gt;254</a> <br>  <br> &gt;内側の仕組みをもっとすっきり出来ないかなと･･･  <br> 内側の仕様ってドライバ依存では？ <br>  <br> &gt;無知ですいません。CESってなんですか。 <br> 検索しようよ。 <br>  <br> &gt;2byte文字もきちんと意識しようってことです。 <br> 2byte文字をOSが意識すると言うことは、2byte文字を特別視すると言うことでしょ？ <br> 要するに2byte文字に依存してる。 <br> たとえば、UNICODEとか、もっと別のコードは想定しないって事？ <>
デフォルトの名無しさん<><>02/07/29 00:36<> 分散カーネル <br> ttp://korbit.sourceforge.net/ <>
デフォルトの名無しさん<>sage<>02/07/29 00:46<> <a href="../test/read.cgi/tech/1027080631/260" target="_blank">&gt;&gt;260</a> <br> どこまでをカーネルと呼ぶかによって変わってくるけど、 <br> システムコールのリクエストを複数のサーバーへの分散要求に変換してくれるわけでもないし、 <br> 基本部分はやっぱり各マシン毎で動いているから、分散カーネルとは言えないと思うんだが。 <br>  <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/07/29 00:46<> <a href="../test/read.cgi/tech/1027080631/259" target="_blank">&gt;&gt;259</a> <br> &gt;&gt;内側の仕組みをもっとすっきり出来ないかなと･･･ <br> &gt;内側の仕様ってドライバ依存では？ <br> I/Oの下層レイヤー(ドライバレベル)を上位のレイヤーでラップして <br> 抽象化するときにすっきりとしたいなと考えています。 <br> でもこれは、現状のUNIXがどういうアプローチを採っているのか <br> 正確には知らないので、車輪の再発明っぽくなるかも･･･ <br>  <br> &gt;&gt;無知ですいません。CESってなんですか。 <br> &gt;検索しようよ。 <br> そうですね。しばらく時間をください。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/2" target="_blank">&gt;&gt;2</a>byte文字もきちんと意識しようってことです。 <br> &gt;2byte文字をOSが意識すると言うことは、2byte文字を特別視すると言うことでしょ？ <br> &gt;要するに2byte文字に依存してる。 <br> OS内部で採用する文字コードをマルチバイト(2byteとは限らない) <br> の文字コードにするという意味です。 <br> なので、2byte文字を特別視するという意味ではないです。 <br>  <br>  <br>  <br>  <br>  <br>  <>
デフォルトの名無しさん<><>02/07/29 00:59<> &gt;カーネルの機能をコンポーネント化して、そいつらの結びつき <br> &gt;は疎結合(メッセージング?) <br>  <br> マイクロカーネルとか調べてみては？ <>
sage<><>02/07/29 01:04<> Hobby OS を目指してるぽん？ <br> それならいっぱいあるぽん！ <br> とりあえず↓あたりは有名だぽん・・ <br> ttp://www.menuetos.org/ <br> ttp://www.skyos.org/index2.html <br> ttp://www.atheos.cx/ <br> ttp://cosmoe.com/ <br> ttp://syllable.sourceforge.net/ <>
デフォルトの名無しさん<>sage<>02/07/29 02:43<> ぽんぽんぽんぽんぽんぽんぽんぽんぽんぽんぽんぽんぽんぽん <>
デフォルトの名無しさん<>sage<>02/07/29 04:13<> もしトンデモだったら聞き流してくれ。 <br> <a href="../test/read.cgi/tech/1027080631/262" target="_blank">&gt;&gt;262</a> <br> ＞OS内部で採用する文字コードをマルチバイト(2byteとは限らない)  <br> ＞の文字コードにするという意味です。  <br> ＞なので、2byte文字を特別視するという意味ではないです。  <br> てことは、1byte、2byte、4byteとかいろんなバイトの文字コードを扱えるようにするって事？ <br> 結構処理きつくならないか？ <br> それならいっそunicodeで統一(以下略 <>
ろうひ男爵<><>02/07/29 07:47<> <a href="../test/read.cgi/tech/1027080631/232" target="_blank">&gt;&gt;232</a> <br> yaccとlexを使うのが良いのでは? <br> 自分は使わずに手で実装しましたが、大変でしたよ。 <br> 特にスタック関連の再帰が面倒でした。 <br> 字句解析には、力業で文字列のコンペア取ってましたが、 <br> ハッシュに変えたらスゲー早くなりました。 <br>  <br> でも、c言語レベルの物を作るならならそんなに大変ではないと思いますよ。 <br> といっても、フルにやって２ヶ月はかかるでしょうけど。 <br>  <br> しかも、os側でmmuを使って0からのアドレスにマップすれば、 <br> アロケータは必要ありませんし、セグメントの用途固定にすればokですしね。 <br>  <br> コンパイラは、ネイティブコード出力だけでなく、 <br> 共通の中間コードも出力できたら楽しいかもしれませんね。 <br>  <>
デフォルトの名無しさん<>sage<>02/07/29 07:53<> FreePascalベースにしたら？ あれは一応オブジェクト指向言語だし <>
デフォルトの名無しさん<>sage<>02/07/29 12:55<> Pascalのオブジェクト指向はいまいち <>
デフォルトの名無しさん<>sage<>02/07/29 14:24<> <a href="../test/read.cgi/tech/1027080631/267" target="_blank">&gt;&gt;267</a> <br> せっかくOS開発として形になろうとしてきたところに、 <br> 言語から作れなんて言う水を差すような発言はどうかと思うぞ <>
ろうひ男爵<><>02/07/29 17:01<> <a href="../test/read.cgi/tech/1027080631/270" target="_blank">&gt;&gt;270</a> <br> すまぬ。 <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/07/29 20:00<> <a href="../test/read.cgi/tech/1027080631/267" target="_blank">&gt;&gt;267</a> <br> なるほど言語ごと作るとは･･･ <br> フルにやって2ヶ月って、宝くじが当たったらやろうかな。 <br> 仕事がなけりゃ、やってみたら面白いと思うけど <br> 生活できない･･･ <br>  <br> <a href="../test/read.cgi/tech/1027080631/270" target="_blank">&gt;&gt;270</a>,<a href="../test/read.cgi/tech/1027080631/271" target="_blank">&gt;&gt;271</a> <br> いえいえ。 <br> 確かにそこまでやったらかなり面白い！！ <br> とは思います。でも今は無理です。 <br>  <br> 募集したのに誰もメールくれないと言ってみるテスト。 <br> 当分一人やるしかないようです。 <br> もっとレベルが上がってから再募集します。 <br>  <>
デフォルトの名無しさん<>sage<>02/07/29 20:45<> <a href="../test/read.cgi/tech/1027080631/272" target="_blank">&gt;&gt;272</a> <br> 漏れはsourceforgeにプロジェクトが立ち上がったら参加したいです <br> 少なくとも、今の段階ではひげぽん一人で楽しみながらやるのが良いと思う。 <br> 個人で把握しきれない規模でもないしね。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/07/29 20:49<> ハードウェア割り込みをキャッチしようと試みています。 <br> が、つまずいています。 <br> キーボード割り込みハンドラを作成してIDTを登録しました。 <br> Bochs上でキー入力をしてもハンドラが呼ばれた形跡はありませんが <br> 裏のコンソールに「nternal keyboard buffer full, ignoring scancode.(a1)」 <br> と出るのでbochs自体は、キー入力は受け付けていると思います。 <br>  <br> ハンドラは以下のようなものです。キーボード割り込み以外のハンドラも <br> 下記と同様の作りです。 <br> void&nbsp;keyStrokeHandler()&nbsp;{ <br> &nbsp;&nbsp;&nbsp;&nbsp;_sysPrint("key&nbsp;stroke\n"); <br> &nbsp;&nbsp;&nbsp;&nbsp;asm("mov&nbsp;%ebp,%esp"); <br> &nbsp;&nbsp;&nbsp;&nbsp;asm("pop&nbsp;%ebp"); <br> &nbsp;&nbsp;&nbsp;&nbsp;asm("iret"); <br>  <br> &nbsp;&nbsp;&nbsp;&nbsp;return; <br> } <br>  <>
ひげぽん </b>◆zcp/NZpA <b><><>02/07/29 20:52<> <a href="../test/read.cgi/tech/1027080631/273" target="_blank">&gt;&gt;273</a> <br> おお！結構うれしいです。 <br> ちなみに募集をしたのもそろそろsource forgeでプロジェクト化しようと <br> 思ったからです。 <br> 誰もメールをくれないのでめげていたところです。 <br> source forgeってオープンソースでなければいけないんでしたっけ？ <br> のちのち面倒なことにならないようにその辺はしっかりと <br> 調べなければと思いつつ後回しになっています。 <br>  <>
デフォルトの名無しさん<>sage<>02/07/29 21:16<> <a href="../test/read.cgi/tech/1027080631/262" target="_blank">&gt;&gt;262</a> <br> <a href="../test/read.cgi/tech/1027080631/259" target="_blank">&gt;&gt;259</a> <br> OS関連の用語としてのCESは下記のようなことでよろしい？ <br> CES = Character Encoding Schemeの略。 文字符号化方式。 <br>  <br> 参考リンク(google で "CES 依存 文字" で検索してめぼしいものをピックアップ) <br> ttp://www.inac.co.jp/~maki/ruby/ruby-i18n.html <br> ttp://tsukuba.m17n.org/mule-ja-archive/2000-1/msg00033.html <br> ttp://tsukuba.m17n.org/mule-ja-archive/2000-1/msg00034.html <br> ttp://www.emaillab.org/mutt/linuxjapan/mutt200111.pdf <br>  <br> # この辺りの話は glibc のようなものを作るときに問題にすればよいのでは？ <br>  <>
デフォルトの名無しさん<>sage<>02/07/29 21:26<> <a href="../test/read.cgi/tech/1027080631/274" target="_blank">&gt;&gt;274</a>  <br>  とりあえず、不正なアドレスへのアクセスなどは捕まえられるのかな。  <br>  キー入力を捕らえるなら 8259A の初期化辺りはどうなった？  <br>  それと、キー入力ならマスターへのＥＯＩ撃たないとダメだけど。  <br>    <br>  <a href="../test/read.cgi/tech/1027080631/272" target="_blank">&gt;&gt;272</a>  <br>  いや、だって、ちゃんとしたページもなけりゃ解説もなし。  <br>  内容は「はじめての４８６」もカバーしきれず。  <br>  もし遊ぶならもう少し気合が見たいかも知れず。  <br>   <>
超先生@OS板  </b>◆OS/dd1Xc <b><>sage<>02/07/29 21:34<> <a href="../test/read.cgi/tech/1027080631/274" target="_blank">&gt;&gt;274</a> <br> 　∧＿∧  <br> ＜ ｀ー´＞y-~~~ それはおそらく <br>  <br> 最もプライオリティの高いsystem timer割り込みがEOIされてないから <br> プライオリティの低いキーボード割り込みを拒否してるだけだと。 <br>  <br> stiする前にkeyboard以外のIRQをmaskするなどPICを設定しておく必要がある。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/07/29 21:34<> <a href="../test/read.cgi/tech/1027080631/276" target="_blank">&gt;&gt;276</a> <br> ありがとうございます。 <br> こういう書き込みは大変助かります。 <br> 文字オブジェクトという考え方はなかなか新鮮でした。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/277" target="_blank">&gt;&gt;277</a> <br> &gt;とりあえず、不正なアドレスへのアクセスなどは捕まえられるのかな。 <br> &gt;キー入力を捕らえるなら 8259A の初期化辺りはどうなった？ <br> &gt;それと、キー入力ならマスターへのＥＯＩ撃たないとダメだけど。 <br> bochs起動時に08h(タイマー?)への割り込みが1回キャッチされてます。 <br> 8259A,マスターEOI、調べます。キーワードをありがとうございます。 <br>  <br> &gt;いや、だって、ちゃんとしたページもなけりゃ解説もなし。 <br> &gt;内容は「はじめての４８６」もカバーしきれず。 <br> &gt;もし遊ぶならもう少し気合が見たいかも知れず。 <br> 力不足は認めます。 <br> まずはカーネルのプロトタイプの完成を第一優先に <br> 考えているので暖かく見守っていただけたらありがたいです。 <br>  <br>  <br>  <br>  <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/07/29 21:39<> 超先生@OS板さんありがとうございます。 <br> &gt;最もプライオリティの高いsystem timer割り込みがEOIされてないから  <br> &gt;プライオリティの低いキーボード割り込みを拒否してるだけだと。  <br> &gt;stiする前にkeyboard以外のIRQをmaskするなどPICを設定しておく必要がある <br> 勉強不足で申し訳ありません。 <br> でも、超先生の予想が当たっている気がします。 <>
デフォルトの名無しさん<>sage<>02/07/29 21:43<> 超先生顔はﾁｮｿなのに何か素敵･･･ﾎﾟｯ。 <>
デフォルトの名無しさん<>sage<>02/07/29 21:51<> しかし、面倒なところまで来たね。 <br> IOとかになってくると、もう資料を集めるスキルも多大に要求される。 <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/07/29 22:44<> <a href="../test/read.cgi/tech/1027080631/282" target="_blank">&gt;&gt;282</a> <br> そうですね。いままでははじめて読む･･　+ アマチュアOSのソースを <br> いくつか眺めながら作っていたのですが <br> 資料集めスキルは本当に重要だと痛感しています。 <br> Minix本は、偏りがあるし･･･ <>
デフォルトの名無しさん<><>02/07/29 23:11<> がんばれよ <>
デフォルトの名無しさん<>sage<>02/07/29 23:49<> この本は必要不可欠です。 <br> ttp://www.amazon.com/exec/obidos/ISBN%3D0201596164 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/07/29 23:51<> EOI(End Of Interrupt)をsystem timer割り込みに対して発行したところ <br> キーボード入力に対して、「一度だけ」ハンドラ呼び出しに成功しました。 <br> その後キーボード入力をしても、何も反応しなくなります。 <br> キーボードハンドラの中でも、EOIしているのですが、 <br> 次の割り込みを捕まえることが出来ません。 <br>  <br> ところでsystem timerのハンドラってとりあえずは空回りさせとけば良いのでしょうか。 <br>  <>
ひげぽん </b>◆zcp/NZpA <b><><>02/07/29 23:54<> <a href="../test/read.cgi/tech/1027080631/286" target="_blank">&gt;&gt;286</a> <br> 日本語版とかないですかね。 <br> 割り込みの資料も英語のものしか見つからなかったので <br> がんばって読んだのですが、ちょっと疲れました。 <>
ろうひ男爵<><>02/07/30 04:40<> タイマーは、 <br>  <br> 1)古いハンドラを呼ぶ <br> 2)EOIを発行 port 20hに20hを出力 <br>  <br> が普通だと思う。 <br>  <>
ろうひ男爵<><>02/07/30 05:04<> ちなみに、タイマーは、ワンショットではなく、方形派のハズなので、 <br> 周期的に何回も割り込みがかかってきているかチェックしてくださいね。 <>
LightCone<>sage<>02/07/30 07:33<> 　横から失礼しますが、上の方を読む限り話がIDTの方に移行した <br> ようですが、Cソースをコンパイルした結果の .data セグメントや <br> .bss セグメントを正しく扱う事の方が優先順位的には高いと思います。 <br>  <br> 　OBJファイル群をリンクした後に出来る実行形式のフォーマット(ELF等) <br> の資料を入手し、IPLに続く部分もしばらくはアセンブラで書いて、 <br> その実行形式に対するローダーを書いておくか、自分でコンバータを <br> 作って、予めロードしやすい形式にしておくといいです。 <br>  <br> 　それから、32 BIT のCコンパイラが吐き出すコードは、32BIT <br> プロテクトモードへ移行して、各種の環境を整えてやらないと、 <br> そもそも全く正しく実行できません。 <br> 　初期時のしばらくの間、安定した32BITのアドレッシングモード <br> に移行するまではアセンブラで書くのが安全で楽だと思います。 <br>  <br> 　Cコンパイラの吐くコードを実行するのに重要なことは、DS,ES,SSの <br> セッティングです。そのコンパイラがFLATモデルのコードを吐いている <br> なら、DS,ES,SS を全て 4GB FLAT に設定する代わりに、ちゃんと <br> 命令中の OFFSET アドレスを全てリロケートする必要があります。 <br> 逆に、セグメントモデルのコードを掃いているなら、DS,ES,SSを <br> 正しく設定すれば、リロケート作業は必要有りませんが、ポインタ <br> を far ポインタで扱う必要が出てきます。お勧めはFLATモデルです。 <br> 　FLAT モデルの場合のリロケートする方法ですが、それは、実行形式 <br> に埋め込んである「再配置情報」を利用します。そこからは、絶対 <br> OFFSET アドレスが書かれているアドレスと、それに関係した <br> セグメントの情報が得られます。 <>
LightCone<>sage<>02/07/30 07:59<> 　ちょっと、#93が指摘されているように、文字列の入っているセクション <br> (多分.data）が最初に来ていると言う状態や、#89,#92 で、文字列の <br> 終端コードが読めないと思っていたら、読めることも有ったりするのは、 <br> 実は全てセクションの配置や、OFFSETの再配置問題が関係しているように <br> 思えますので、そこをうまく乗り越えれば、ひとまず小安定した <br> 環境がやってくると思います。 <br>  <br> 　この掲示板を読む限り、なんとなく勘で試したら、動く時も有った、 <br> かのような感じを受けるのですが、そういう姿勢はやめて、もっと <br> 精密に一歩一歩石橋を渡るように前に進んでいくことをお勧めします。 <br> まず、ブートさせる前に、イメージファイルなどをバイナリエディタで <br> くまなく観察することがお勧めです。 <br>  <br> 　あたりまえのことですが、配置が１バイトでも狂っていれば、 <br> プログラムの論理的なバグがもし一切無くても、全く動くこと <br> さえできません。 <br> 　OS作りとは、環境作りであって、カーネルを、Cソースでスイスイ <br> と書ける状態に持っていけたらば、既にかなり進展したと言っていいと <br> 思いますので、まずはそこに一週間かけても問題は無いと思います。 <br>  <br> 　なお、少しまともなOSを作ろうとすれば、ページングを実装しなければ <br> なりませんが、アドレスを精密に決める癖がついていないと多分挫折する <br> ことになるでしょうから、ここで踏ん張りを効かせて、Cソースが完全に <br> 正常に動く所まで持っていけるように、自分の腕を鍛え上げてください。 <>
デフォルトの名無しさん<>sage<>02/07/30 08:36<> &gt;LightCone <br> なんか偉そうだね。 <br>  <br> プロテクトモードへは移行しているが？ <br> しかも、raw binaryを吐き出させているから、 <br> DS=ES=SS前提の、offset 0ベースでアドレス情報もキッチリ出力されてます。 <br>  <br> &gt;終端コードが読めないと思っていたら、読めることも有ったりするのは、  <br>  <br> <a href="../test/read.cgi/tech/1027080631/96" target="_blank">&gt;&gt;96</a>で原因調査をして、<a href="../test/read.cgi/tech/1027080631/111" target="_blank">&gt;&gt;111</a>で解決策が出ています。 <br> スレをもっとよく読みましょう。 <br>  <br> んで、あなたの云う安定したアドレッシングモードってなんですか？ <>
デフォルトの名無しさん<>sage<>02/07/30 08:42<> まぁ、なんだ。 <br> 俺がいいたいのは、たとえ行き当たりばったりだとしても、 <br> 今は好きな順番で好きなようにやらせるべきだと思うんだ。 <br> 第一にひげぽんの知識が全然無いこと。 <br> 今は何をやっても無駄ということはなく力になる段階であると思う。 <br> そして、最も重要な事は、モチベーションを持続させる事であるため、 <br> お仕着せで作業順を決定するのはどうかと。 <>
LightCone<>sage<>02/07/30 10:26<> <a href="../test/read.cgi/tech/1027080631/292" target="_blank">&gt;&gt;292</a> <br> そうだったんですか。 <br> でも、raw binary と言う言葉も、offset 0 ベースでアドレス情報が <br> 出ていると言うことも、このスレだけでは読み取れないと思います（gcc <br> に詳しくなければ。）。 <br>  <br> ともかく、ひげぽんさん、頑張ってくださいね。 <br> #293 さんが言う、モチベーションの維持は一番難しいと思います。 <br> 私だって、NWSOSが何を目的に作っているのかも分かっていませんし、 <br> 暫定版でもいいから公開しろという声が一部から上がったので、公開したく <br> 無かったバージョンを無理やり公開したら、非難轟々を浴びたわけで、 <br> もともとナケナシのモチベーションは下がりまくりです。 <br>  <br> 偉そうにしていると思う人もいるようですが、私もひげぽんさんも、立場 <br> は何も変わらないんですよ。最初は何にも無い所から作り始めたんですか <br> ら、、、。今でもたいしたことは全然無いんですけれど。 <br> まあ、そもそも、コンピュータソフト自体は、その中に使われている <br> 純粋な理論以外の部分では、「簡単」と思われても仕方が無い部分を <br> 持っていて、私自身も、他の分野に比べてかなり簡単だと思っている <br> わけで、いまさら、OSを作れたぐらいで偉そうにするなと言われても、 <br> 私自身が、OSを作ることなんて大したことが無いと自分で思っている <br> わけで、そういうことを言う人が、何がいいたいのかわからないで困っ <br> ています。 <br>  <br> はっきり言いまして、OSなんてある種の人たちには簡単に作れるはずなん <br> です。しかし、全世界が、Windowsの呪縛からなかなか離れないでいるこ <br> ともまた事実で、それは技術的なものよりも、背景事情から来ていること <br> なんですが、かといって、万人にOSが簡単に作れてしまうと言うわけでも <br> 無いのは事実だと思います。NWSOSごとき、OSと考えるなというのは <br> 最もな意見ですが、それと同様なものさえも、日本ではあまり見かけない <br> という事実もまたあるんじゃないでしょうか、、、。 <>
デフォルトの名無しさん<>sage<>02/07/30 10:29<> この本読まなきゃ <br> ttp://www.linux.or.jp/bookreview/BR56.html <>
デフォルトの名無しさん<>sage<>02/07/30 11:14<> &gt;LightCone <br> なんか偉そうだね。 <>
デフォルトの名無しさん<>sage<>02/07/30 12:22<> この作者さん？ <br> ttp://homepage2.nifty.com/nowsmart/nwsos.htm <br>  <br> ここまでがんばってるんだから多少エラソウに見えてもしょうがない <>
デフォルトの名無しさん<>sage<>02/07/30 12:24<> でも、作って喜ばれるのは Windowsと互換性が大きいOSだろうな <>
デフォルトの名無しさん<>sage<>02/07/30 13:23<> WindowsCE互換のほうが喜ばれる <br> またWindows互換でかつ下位互換なら狂喜する <>
デフォルトの名無しさん<>sage<>02/07/30 13:51<> x86ベースのCEなんてあったか？ <br> API互換でも動くソフトが存在しないんじゃ？ <>
デフォルトの名無しさん<>sage<>02/07/30 14:03<> <a href="../test/read.cgi/tech/1027080631/297" target="_blank">&gt;&gt;297</a> <br> &gt;この作者さん？  <br> &gt; ttp://homepage2.nifty.com/nowsmart/nwsos.htm  <br> &gt;   <br> &gt; ここまでがんばってるんだから多少エラソウに見えてもしょうがない  <br>  <br> だから偉そうにしていいのか？ノータリンですか？ <>
デフォルトの名無しさん<>sage<>02/07/30 14:14<> <a href="../test/read.cgi/tech/1027080631/301" target="_blank">&gt;&gt;301</a> <br>  ご本人はそういうつもりじゃないと思うけどなあ・・・ <br> それなりに情報もってるんだろから排斥しなくてもいいのにと思ったからさ <>
ろうひ男爵<><>02/07/30 14:23<> &gt;x86ベースのCEなんてあったか？ <br> MSのエミュレーターであるよ。 <br> コンシューマ向けでも何度か企画されたことがある。 <>
デフォルトの名無しさん<>sage<>02/07/30 16:49<> <a href="../test/read.cgi/tech/1027080631/303" target="_blank">&gt;&gt;303</a> <br> 企画つーか、高木産業から一機種発売になってます。 <>
デフォルトの名無しさん<>sage<>02/07/30 20:23<> <a href="../test/read.cgi/tech/1027080631/296" target="_blank">&gt;&gt;296</a> <br> <a href="../test/read.cgi/tech/1027080631/301" target="_blank">&gt;&gt;301</a> <br> 　このスレを覗いている人たちや助言をしてくださっている方々のモチベ <br> ーションを下げる傾向にある（と自分には受け取れた）発言は慎むべきか <br> と思われ。。。 <br> 　だって、情報が集まらなくなるじゃないですか？そうなったらお互いに <br> 損ですよね？;-)  <br>  <br> <a href="../test/read.cgi/tech/1027080631/293" target="_blank">&gt;&gt;293</a> <br> 　モチベーションの持続・・・大事ですね。最近切に感じます。 <br> とりあえず、 <br> 「最初はみんな素人だ、失敗し、学び一人前になる」 <br> 「壁を意識できるやつは壁を乗り越える素質を持っている」 <br> とか言ってみるテスト。 <br>  <br> # 関係ないレスでスマソ。 <br>  <>
ひげぽん </b>◆zcp/NZpA <b><><>02/07/30 21:32<> <a href="../test/read.cgi/tech/1027080631/289" target="_blank">&gt;&gt;289</a> ろうひ男爵さん <br> &gt;ちなみに、タイマーは、ワンショットではなく、方形派のハズなので、 <br> &gt;周期的に何回も割り込みがかかってきているかチェックしてくださいね。 <br> これは確認できました。 <br> 確かに一定の間隔の割り込みで発生しています。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/290" target="_blank">&gt;&gt;290</a>,<a href="../test/read.cgi/tech/1027080631/291" target="_blank">&gt;&gt;291</a> LightConeさん <br> まずは書き込みありがとうございます。 <br> 実際にOSを作っている方からの意見は大変貴重でありがたいです。 <br>  <br> &gt;　この掲示板を読む限り、なんとなく勘で試したら、動く時も有った、 <br> &gt;かのような感じを受けるのですが、そういう姿勢はやめて、もっと <br> &gt;精密に一歩一歩石橋を渡るように前に進んでいくことをお勧めします。 <br> &gt;まず、ブートさせる前に、イメージファイルなどをバイナリエディタで <br> &gt;くまなく観察することがお勧めです。 <br> そうですね。確かに、本来であればその姿勢が正しいと思います。 <br> 現状自分では、手探り状態でOSを作っている状態です。 <br> 本来であれば気を付けなければいけないところに、手が回らず <br> とりあえず動くものを・・・という姿勢でやっています。 <br> もちろん不定な動きがあれば、原因追求すべきだと思います。 <br>  <br> 現状作っているものは、位置づけとしてプロトタイプと考えています。 <br> 出来がよければそのまま使い続けるかもしれません。 <br>  <br> &gt;ともかく、ひげぽんさん、頑張ってくださいね。 <br> &gt;#293 さんが言う、モチベーションの維持は一番難しいと思います <br> ありがとうございます。 <br> これは最重要項目ですね（笑） <br> この掲示板に書き込みを下さる方もありがたいです。 <>
デフォルトの名無しさん<><>02/07/30 21:34<> ひげぽんさん、頑張れ！！ <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/07/30 21:35<> ありがとうございます。 <br> さあがんばろう。 <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/07/30 22:54<> おれは何も出来ない。 <br> でもこのスレは好き。 <br> だからage <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/07/30 22:56<> スレッドを間違えました。 <br> 恥ずかしい･･･ <br> そもそもageてないし。 <br> 反省して今日はもう寝ます。 <>
デフォルトの名無しさん<>sage<>02/07/31 00:12<> <a href="../test/read.cgi/tech/1027080631/309" target="_blank">&gt;&gt;309</a> ? <>
デフォルトの名無しさん<>sage<>02/07/31 01:56<> <a href="../test/read.cgi/tech/1027080631/309" target="_blank">&gt;&gt;309</a> <br> ｺﾞﾊﾞｸ（・∀・）ﾆﾔﾆﾔ <>
デフォルトの名無しさん<><>02/07/31 02:08<> 誤爆じゃなくて自演だろ。（　´_ゝ`） <>
デフォルトの名無しさん<>sage<>02/07/31 02:22<> 内容からして7行スレかメーラスレ？ <>
ひげぽん </b>◆zcp/NZpA <b><>age<>02/07/31 08:26<> <a href="../test/read.cgi/tech/1027080631/311" target="_blank">&gt;&gt;311</a>,312,313,314 <br> プログラム板の某スレッドと間違えました。 <br> 大変失礼しました。 <br>  <br> こっそり報告です。 <br> sourceforge.jpに昨晩申請し、今朝PJ登録されました。 <br> プロジェクト名は、higeposです。 <br>  <>
ろうひ男爵<><>02/07/31 12:44<> <a href="../test/read.cgi/tech/1027080631/306" target="_blank">&gt;&gt;306</a> <br> では、ちゃんと割り込みは入っているみたいですね。 <br> では、キーボード割り込み単体の問題みたいですねぇ。 <br> タイマーの方もEOIしてるでしょうし、 <br> 他の割り込みをmaskしてみてはどうでしょうか。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/304" target="_blank">&gt;&gt;304</a> <br> フォローありがとう。 <br> そーいえば、高木産業からノーパソの筐体を使ったCEが出てたんですよね。 <>
デフォルトの名無しさん<>sage<>02/07/31 13:04<> <a href="../test/read.cgi/tech/1027080631/309" target="_blank">&gt;&gt;309</a> <br> ひげぽん・・・俺は気にしないぞ。がんばれ。 <br> 俺は自演でも気にしないぞ。 <br> ・・・ぁ〜あ。 <>
デフォルトの名無しさん<>sage<>02/07/31 13:36<> http://sourceforge.jp/projects/higepos/ <br> http://higepos.sourceforge.jp/ <>
ひげぽん </b>◆zcp/NZpA <b><>age<>02/07/31 20:45<> <a href="../test/read.cgi/tech/1027080631/318" target="_blank">&gt;&gt;318</a> <br> ありがとう。 <br> 引き続き協力者募集中です。 <br>  <br> しばらくはsourceforge用の環境構築に時間が取られそうです。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/316" target="_blank">&gt;&gt;316</a>　ろうひ男爵さん <br> ありがとうございます。 <br> 他の割り込みをMASKする方針でちょっとやってみます。 <br>  <br> ところで会社から2chを見ようと思うのですが←ダメ社員 <br> どこかのサービスで、ページにアクセスしてURLを入力すると <br> CGIかなんだかが、URLのページ内容を代わりに表示するみたいなのって <br> ありませんでしたっけ？ <br> どなたか知っていたら教えてください。 <>
デフォルトの名無しさん<><>02/07/31 21:03<> CGIプロクシは <br> http://www.age.ne.jp/x/babya/download/#EseXy <br> これをどっかにおけばいいんでねの？ <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/07/31 21:05<> <a href="../test/read.cgi/tech/1027080631/320" target="_blank">&gt;&gt;320</a> <br> おおありがとう。でもどこに置こう。 <br> どこかに既存のものがあったら、さらにありがたいっす。 <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/07/31 21:58<> Windowsでcygwin,Meadow,djgppをいれていて <br> なんちゃってunix環境なのでssh,scp,cvsの設定は楽かと思ってたけど <br> もう少し時間がかかりそうです。 <>
デフォルトの名無しさん<>sage<>02/07/31 22:07<> 確かに最初は面倒かも。 <>
デフォルトの名無しさん<>sage<>02/08/01 20:36<> 開発停止中？ <>
デフォルトの名無しさん<><>02/08/01 20:46<> ひげぽんはフォーラムにも既に書き込んでいるが <br> 質問やらなんやらはこのスレでした方が良くないか？ <br> フォーラムの方はあれたときの非難用か何かの方が都合良いと思うぞ。 <>
デフォルトの名無しさん<>sage<>02/08/02 00:36<> <a href="../test/read.cgi/tech/1027080631/325" target="_blank">&gt;&gt;325</a> <br> そうね。 <br> 今のとこ、こちらのが気楽に書き込みできそうだし。 <br> とりあえず、様子見。 <br>  <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/08/02 00:54<> やっとSSHでシェルログインできました。 <br>  <br> sourceforge.jpのドキュメントは一部古いものがあったり <br> .netのものだったりして苦労しました。 <br> 分かりづらかったのでメモ代わりに方法を書いておきます。 <br>  <br> 私の環境は <br> cygwinの <br> OpenSSH_3.1p1, SSH protocols 1.5/2.0, OpenSSL 0x0090603f <br> Bad escape character 'rsion'. <br>  <br> ■キー作成 <br> ssh-keygen -t rsa <br> パスフレーズの入力をすると <br> .ssh/id_rsa.pubというファイルが出来る。 <br>  <br> ■キー登録 <br> sourceforge.jpにログインし、メニューのアカウント管理を選び <br> シェルアカウント　鍵の編集で <br> 上記ファイルの内容をそのままペーストする。 <br>  <br> 数分待ってから <br>  <br> ■ログイン <br> ssh -l username shell.sourceforge.jp <br>  <br> パスフレーズを入力するとめでたくログインできる。 <br>  <br> ちなみにcvsは本を買ったので勉強中です。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/325" target="_blank">&gt;&gt;325</a> <br> 了解です。 <br>  <br> 引き続き協力者募集中です。see <a href="../test/read.cgi/tech/1027080631/257" target="_blank">&gt;&gt;257</a> <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/02 20:13<> sourceforge.jpのhigeposプロジェクトに <br> 現状のソースをCVS importをしました。 <br> 下記からたどっていただけたらと思います。 <br> http://sourceforge.jp/projects/higepos/ <br>  <br> 本日より開発を開始いたします。 <br>  <>
デフォルトの名無しさん<><>02/08/02 21:24<> 再開したね。 <>
デフォルトの名無しさん<>sage<>02/08/02 21:27<> 放置すると自演するもんな。 <>
デフォルトの名無しさん<>sage<>02/08/02 21:46<> とりあえず荒らすなよ <br>  <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/02 23:10<> キーボード割り込みが1回しか取れない現象で困っています。 <br>  <br> 割り込み許可の前に以下の作業をしています。 <br> &nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;Enable&nbsp;IRQ0&nbsp;(timer)&nbsp;and&nbsp;IRQ1&nbsp;(keyboard)&nbsp;at&nbsp;the <br> &nbsp;&nbsp;&nbsp;&nbsp;8259&nbsp;PIC&nbsp;chips,&nbsp;disable&nbsp;others:&nbsp;*/ <br> &nbsp;&nbsp;&nbsp;&nbsp;outportb(0x21,&nbsp;~0x03); <br> &nbsp;&nbsp;&nbsp;&nbsp;outportb(0xA1,&nbsp;~0x00); <br> キーボード割り込みハンドラでは <br> &nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;EOI&nbsp;is&nbsp;below&nbsp;for&nbsp;IRQ&nbsp;0-7&nbsp;*/ <br> &nbsp;&nbsp;&nbsp;&nbsp;outportb(0x20,&nbsp;0x20); <br>  <br> &nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;iret&nbsp;*/ <br> &nbsp;&nbsp;&nbsp;&nbsp;asm("mov&nbsp;%ebp,%esp"); <br> &nbsp;&nbsp;&nbsp;&nbsp;asm("pop&nbsp;%ebp"); <br> &nbsp;&nbsp;&nbsp;&nbsp;asm("iret"); <br> をしています。 <br>  <br> timerイベントは、定期的取得できているのですが、 <br> キーボードイベントは一度しかとれないです。 <>
FreeDOS教徒<>osage<>02/08/02 23:41<> SourceForge進出おめでとうございます。  <br>    <br>  一度しかキーボードイベントが取れないのでしたら、  <br>  出力バッファが満杯なフラグが立ったままなのでは？  <br>    <br>  これは私の勘なのですが、キーボードコントローラが  <br>  フラグを感知して割り込みを発行しないのかも。。  <br>  ハンドラでステータスレジスタを操作してやれば如何？ <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/03 00:10<> &gt;&gt;SourceForge進出おめでとうございます。 <br> ありがとうございます。 <br> 最近ちょっとモチベーションが下がり気味だったのですが回復しました。 <br>  <br> &gt;一度しかキーボードイベントが取れないのでしたら、 <br> &gt;出力バッファが満杯なフラグが立ったままなのでは？ <br> おっしゃるとおりでした。 <br> まずはキーボードハンドラが呼ばれることを実現するという方針で <br> 進めていたのがあだとなったようです。 <br>  <br> importb(0x60)でscan codeを取得するようにしたら <br> 複数回のキーボードイベントを感知できるようになりました。 <br>  <br> キーボードイベント取得成功版をcommitしました。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/03 01:17<> キーボードイベントの取得のめどがたったので <br> ちょっと考えてみました。 <br> 以下私の思考の流れです。 <br>  <br> キーボード処理を書いてるけどこれってドライバーだよなあ。 <br> OSからみて、ハードウェア割り込みって受動的だ。 <br> とりあえずキーイベント情報は、バッファにためるべきかな。 <br> でもためたキーボードイベントって、アプリケーションはどうやって <br> 受け取るんだろう。 <br>  <br> 1.アプリケーションに取りに来てもらう。 <br> 2.アプリケーションはキーハンドラを用意して、OSはそいつにキー情報 <br> を与えてやる。 <br>  <br> どっちにしろ、OSとドライバーの関係をきっちり決めなければ <br> いけない気がしてきた・・・・ <br> でもその前にメモリをどう管理するかを決めたほうがよいかな。 <br> そうすればmalloc,newもできるようになるし、幅が広がるかも。 <br>  <br> ということで、当面の目標は、メモリ管理について調べて実装するという事に <br> なりそうなのですが、 <br> 間違った方向に行ってませんか？ <br> 上記よりも大事なことがあるだろ！みたいな突っ込みお待ちしています。 <>
デフォルトの名無しさん<>sage<>02/08/03 01:31<> メモリマネージャ-&gt;ABI-&gt;実行イメージの順でいいとおもうよ <>
FreeDOS教徒<>osage<>02/08/03 06:54<> それが基本でしょう <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/03 10:15<> <a href="../test/read.cgi/tech/1027080631/336" target="_blank">&gt;&gt;336</a>, <a href="../test/read.cgi/tech/1027080631/337" target="_blank">&gt;&gt;337</a> <br> ありがとうございます。 <br> メモリマネージャ作成を次の目標とさせていただきます。 <>
デフォルトの名無しさん<><>02/08/03 10:24<> ｷﾀ━━━(ﾟ∀ﾟ)━━━!! <br>  <br> ひげぽんぽん(ハッカー)◆zcp/NZpA  <br>  <br> の誕生だ！ <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/03 21:12<> MemoryManagerという抽象クラスを継承したX86MemoryManagerクラスを <br> 作るという設計方針でテストしていたのですが････ <br>  <br> リンク時に以下のエラーが出てしまうのですが、 <br> これの解決方法をご存知の方がいたら教えてください。 <br> なお、継承をしなければ以下のエラーは出ません。 <br> ld.exe: warning: cannot find entry symbol start; defaulting to 00001200 <br> ../../bin/X86MemoryManager.o(.gnu.linkonce.d._ZTI16X86MemoryManager+0x0):X86MemoryManager.cpp: undefined reference to `__ZTVN10__cxxabiv120__si_class_type_infoE' <br> ../../bin/X86MemoryManager.o(.gnu.linkonce.d._ZTI13MemoryManager+0x0):X86MemoryManager.cpp: undefined reference to `__ZTVN10__cxxabiv117__class_type_infoE' <br> make.exe: *** [../../bin/third.bin] Error 1 <br>  <br>  <>
デフォルトの名無しさん<>sage<>02/08/04 00:40<> <a href="../test/read.cgi/tech/1027080631/340" target="_blank">&gt;&gt;340</a> <br> RTTI関連じゃないか？ <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/04 11:49<> <a href="../test/read.cgi/tech/1027080631/341" target="_blank">&gt;&gt;341</a> <br> ありがとうございます。 <br> -fno-rtti オプションでコンパイル後 <br> リンクすると <br> ld.exe: warning: cannot find entry symbol start; defaulting to 00001200 <br> ../../bin/MemoryManager.o(.gnu.linkonce.d._ZTV13MemoryManager+0x8):MemoryManager.cpp: undefined reference to `___cxa_pure_virtual' <br>  <br> というエラーが出てしまいます。 <br> 仮想関数を使っているのが怒られているのでしょうか。 <br> でももう一息で解決しそうな････ <>
超先生@OS板  </b>◆OS/dd1Xc <b><>sage<>02/08/04 12:09<> <a href="../test/read.cgi/tech/1027080631/342" target="_blank">&gt;&gt;342</a> <br> 　∧＿∧ <br> ＜ ｀ー´＞y-~~~ 典型的なC++コンパイラの実装に従えば、 <br> ___cxa_pure_virtualは純粋仮想関数の不正な呼び出しを受け止める関数かな。 <br>  <br> ダミーでvoid ___cxa_pure_virtual() {}とかしておけばいいかと。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/04 13:54<> <a href="../test/read.cgi/tech/1027080631/343" target="_blank">&gt;&gt;343</a> <br> ありがとうございます。 <br> 自分の実験でも純粋仮想関数を使うと上記のエラーが出ることが分かりました。 <br> 基底クラスのクラス宣言で <br>     void MemoryManager::___cxa_pure_virtual() {} <br> としてみましたが、リンク時に同じエラーが出てしまいます。 <br>  <br> 純粋仮想関数が使えなくても、何とかなるといえばなるのですが、 <br> のちのちクラスの設計･実装者の意図がうまく伝わらないことが起こりそうで心配です。 <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/08/04 13:55<> ひとつ書き忘れました。 <br> ただの仮想関数なら大丈夫でした。 <>
デフォルトの名無しさん<>sage<>02/08/04 13:57<> <a href="../test/read.cgi/tech/1027080631/344" target="_blank">&gt;&gt;344</a> <br> extern "C" void __cxa_pure_virtual(); <br> void __cxa_pure_virtual() {} <br>  <>
デフォルトの名無しさん<>sage<>02/08/04 14:00<> ttp://ponta.kit.to/doc/develop/ <br> [libstdc++] <br> pure virtual な 関数を定義すると <br> undefined reference to `__cxa_pure_virtual' <br> や <br> undefined reference to `vtable for __cxxabiv1::__class_type_info' <br> が出る。 <br> ↓ <br> -lstdc++ <br> ライブラリをリンクするのを忘れてた。 <br> 以上。  <br>  <br>  <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/08/04 14:10<> <a href="../test/read.cgi/tech/1027080631/346" target="_blank">&gt;&gt;346</a> <br> &gt;extern "C" void __cxa_pure_virtual(); <br> &gt;void __cxa_pure_virtual() {} <br> これは、別ファイルでこの関数を定義して <br> pure virtual関数宣言時にヘッダーをincludeして、リンクするということでしょうか？ <br>  <br> それとも基底クラス内でのお話ですか。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/347" target="_blank">&gt;&gt;347</a> <br> OS開発時にライブラリをリンクしてしまってよいのでしょうか。 <br>  <>
超先生@OS板  </b>◆OS/dd1Xc <b><>sage<>02/08/04 14:25<> 　∧＿∧  <br> ＜ ｀ー´＞y-~~~  <br>  <br> <a href="../test/read.cgi/tech/1027080631/348" target="_blank">&gt;&gt;348</a> <br> &gt; これは、別ファイルでこの関数を定義して  <br> &gt; pure virtual関数宣言時にヘッダーをincludeして、リンクするということでしょうか？  <br>  <br> ヘッダをincludeする必要すらなく、全く別のモジュールとして <br> __cxa_pure_virtual関数をlinkするだけでOK。 <>
デフォルトの名無しさん<>sage<>02/08/04 14:27<> <a href="../test/read.cgi/tech/1027080631/348" target="_blank">&gt;&gt;348</a> そうじゃなくてC++の名前変換の仕掛けを止める為に extern "C" を付けろという意味です <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/04 14:33<> <a href="../test/read.cgi/tech/1027080631/349" target="_blank">&gt;&gt;349</a> <br> <a href="../test/read.cgi/tech/1027080631/350" target="_blank">&gt;&gt;350</a> <br> ありがとうございます。 <br> 出来ました。別モジュールとしてリンクしたらばっちりでした。 <br> この関数はいずれ、OSレベルで何らかのエラー処理を実装したほうが <br> 良いのでしょうか。 <br>  <>
デフォルトの名無しさん<>sage<>02/08/04 14:33<> &gt; OS開発時にライブラリをリンクしてしまってよいのでしょうか。  <br>  <br> 好きにやったらいいと思うけど、こういうややこしい問題は暫く続くよ <br>  <br> だって、仮想関数テーブルはどこに配置されてるとか、そんなレベル <br> をコントロールしなくちゃいけないでしょ <br>  <br> このレベルだとまだ C で書いた方がいいんじゃないの？ <br> 仮想関数の代わりに　関数ポインタ構造体にしておけば？ <>
名無しさんだよもん<><>02/08/04 16:48<> <a href="../test/read.cgi/tech/1027080631/349" target="_blank">&gt;&gt;349</a> <br> それもパクリですか？（藁 <>
デフォルトの名無しさん<>sage<>02/08/04 17:00<> え？ <br> 超先生がパクリ？ <>
赤紫超先生@OS板  </b>◆OS/dd1Xc <b><>sage<>02/08/04 17:17<> <a href="../test/read.cgi/tech/1027080631/353" target="_blank">&gt;&gt;353</a> <br> 　∧＿∧  <br> ＜ ｀ー´＞y-~~~ バイナリ〜 <>
デフォルトの名無しさん<>sage<>02/08/04 17:20<> なになに？ <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/04 21:21<> http://sourceforge.jp/projects/higepos/ <br>  <br> メモリ管理勉強中。 <br> デマンドページング <br> セグメント <br> アドレス変換 <br>  <br> 難しいですね。 <br> これはなかなか大きな壁だ。 <br> でもやる気出てきた。最近あまり頭使ってないし･･･ <br> たまにはじっくり考えよう。 <br>  <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/05 23:26<> メモリマネージャの外部インターフェースは、 <br> 大雑把に言えば <br> 　　・メモリを確保する(malloc,new系) <br>     ・メモリを開放･後処理(free,delete系) <br> ですよね。 <br> この二つのインターフェースの実装はたくさんの選択肢があると <br> 思います。 <br> 仮想メモリ、ページング等の技術を駆使して賢く作るのが <br> 理想でしょう。 <br>  <br> ですが、今の私の技術レベルからする一からそれを実装するのは <br> 難しいと思います。 <br>  <br> そこで最低限のメモリ管理機能を実装しようと思うのですが、 <br> どのような管理機能を実装すると勉強になるでしょうか。 <br> もし経験者の方がいたらアドバイス頂けたらうれしいです。 <>
デフォルトの名無しさん<><>02/08/06 15:42<> Windowsとか、LinuxとかのメジャーなOSでは <br> どうやってるのかを調べることからはじめると <br> 理解が進むと思いますよ。 <br>  <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/07 00:07<> <a href="../test/read.cgi/tech/1027080631/359" target="_blank">&gt;&gt;359</a> <br> ありがとうございます。 <br> メジャーなOSだときちんとした（実装するのは難しい)メモリ管理機能 <br> を搭載していて、ちょっとボリュームありすぎます･･･ <br>  <br> 昨日今日とメモリ管理について勉強して気づいたのですが、 <br> 実験段階であればとりあえず要求されたメモリをただ割り当てて <br> 後始末出来ればよいのではないでしょうか。 <br>  <br> とりあえず勉強ばかりだとモチベーションが維持できなくなるので <br> そろそろ簡単な実装には入れればと思います。 <br>  <>
デフォルトの名無しさん<>sage<>02/08/07 00:19<> <a href="../test/read.cgi/tech/1027080631/360" target="_blank">&gt;&gt;360</a> <br> &gt; 実験段階であればとりあえず要求されたメモリをただ割り当てて  <br> &gt; 後始末出来ればよいのではないでしょうか。  <br> 極論すれば、とりあえず割り当てだけして解放はほっとくというのでも <br> 良いかも... <br>  <br> static void *Last = 0x10000; // 管理領域の最初 <br>  <br> void *Malloc(size_t Size) <br> { <br> 　void *OldLast = Last; <br> 　Last += Size; <br> 　return Last; <br> } <br>  <br> void Free(void *p) <br> { <br> } <br>  <br> みたいな...。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/07 00:30<> <a href="../test/read.cgi/tech/1027080631/361" target="_blank">&gt;&gt;361</a> <br> ありがとうございます。 <br> そうですね。 <br> この方針で明日にでも実装してみます。 <br> その後 new演算子も実装しようかなあ。 <>
デフォルトの名無しさん<>sage<>02/08/07 01:00<> OSもできていない段階で聞くのもなんですが。  <br>  higepos上で動作するアプリケーションなんてのは  <br>  どうやって作っていくんでしょう？  <br>  専用のコンパイラとか必要になるんですか？ <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/07 01:12<> <a href="../test/read.cgi/tech/1027080631/363" target="_blank">&gt;&gt;363</a> <br> &gt;higepos上で動作するアプリケーションなんてのは・・・ <br> 興味深い質問です。 <br> 今のところ未定ですが、 <br> 実行ファイルの形式を決定すればある程度形は決まると思います。 <br>  <br> 理想は、標準のCおよびC++クラスライブラリとAPI <br> を提供してフリーのコンパイラでコンパイルすればOK！という形です。 <br>  <br> その辺にもし御興味があるなら <br> ぜひhigeposプロジェクトへご参加ください（笑） <br> http://sourceforge.jp/projects/higepos/ <>
デフォルトの名無しさん<><>02/08/07 01:53<> <a href="../test/read.cgi/tech/1027080631/360" target="_blank">&gt;&gt;360</a> <br> 確かMINIXは仮想メモリ実装してなかったと思う。参考になるかも。 <br>  <>
デフォルトの名無しさん<>sage<>02/08/07 02:03<> <a href="../test/read.cgi/tech/1027080631/364" target="_blank">&gt;&gt;364</a> <br> &gt;を提供してフリーのコンパイラでコンパイルすればOK！という形です。 <br> こういうことに突っ込むのもアレだがリンクはしないの? <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/07 19:52<> <a href="../test/read.cgi/tech/1027080631/365" target="_blank">&gt;&gt;365</a> <br> ありがとうございます。 <br> Minix本は一応持っているのですが、ソースまでは追ってないです。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/366" target="_blank">&gt;&gt;366</a> <br> おっしゃるとおり、リンクしなければならないので <br> フリーのリンカでうまくいけば吉かと。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/08 00:21<> X86MemoryManagerをsingltonパターンで実装していたらリンクエラーに <br> くじけるもんか･･･ <br>  <>
デフォルトの名無しさん<><>02/08/08 20:58<> age <>
デフォルトの名無しさん<>sage<>02/08/08 21:21<> シングルトンパターンなら C言語の領域（関数ポインタ）で書けばいいんじゃないの？ <br> それが出来ないJAVAの為のパターンをわざわざ踏襲する必要ないだろうに <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/08 21:36<> <a href="../test/read.cgi/tech/1027080631/370" target="_blank">&gt;&gt;370</a> <br> &gt;シングルトンパターンなら C言語の領域（関数ポインタ）で書けばいいんじゃないの？ <br> それも選択肢のひとつだとは思います。 <br>  <br> &gt;それが出来ないJAVAの為のパターンをわざわざ踏襲する必要ないだろうに <br> 今回のX86MemoryMangerは、メモリを管理するクラスで <br> インスタンスが2つ以上あることは許されません。 <br> そのためシングルトンパターンが必要なのです。 <br>  <br> また、MemoryMangerという抽象クラスを継承していて <br> いることにより、インターフェースが確定しているので <br> 容易に他のMemoryManagerと入れ替えることが出来るはず・・・ <br> という計画です。 <br>  <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/08 21:48<> class&nbsp;X86MemoryManager:virtual&nbsp;MemoryManager&nbsp;{ <br>  <br> &nbsp;&nbsp;private: <br> &nbsp;&nbsp;&nbsp;&nbsp;X86MemoryManager()&nbsp;{} <br> &nbsp;&nbsp;&nbsp;&nbsp;~X86MemoryManager(); <br> &nbsp;&nbsp;&nbsp;&nbsp;X86MemoryManager(const&nbsp;X86MemoryManager&); <br> &nbsp;&nbsp;&nbsp;&nbsp;X86MemoryManager&&nbsp;operator&nbsp;=&nbsp;(const&nbsp;X86MemoryManager&); <br> &nbsp;&nbsp;public: <br> &nbsp;&nbsp;&nbsp;&nbsp;char*&nbsp;getMessage(); <br> &nbsp;&nbsp;&nbsp;&nbsp;char*&nbsp;getName(); <br> &nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;long&nbsp;allocateMemory(unsigned&nbsp;long); <br> &nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;long&nbsp;freeMemory(unsigned&nbsp;long); <br> &nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;X86MemoryManager&&nbsp;instance()&nbsp;{ <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;X86MemoryManager&nbsp;theInstance; <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;theInstance; <br> &nbsp;&nbsp;&nbsp;&nbsp;} <br> }; <br> のように実装したのですが、 <br> link時に <br> ld.exe: warning: cannot find entry symbol start; defaulting to 00001200 <br> ../../bin/higepos_kernel.o(.gnu.linkonce.t._ZN16X86MemoryManager8instanceEv+0x2f):higepos_kernel.cpp: undefined reference to `_atexit' <br> というエラーが出てしまいます。 <br>  <br> extern "C" int _atexit(); <br> int  _atexit() {} <br> としてもだめでした。 <br> うーん。なぜだろう。 <>
超先生@OS板  </b>◆OS/dd1Xc <b><>sage<>02/08/08 21:57<>  　∧＿∧  <br> ＜ ｀ー´＞y-~~~ いよいよ夏の祭典が始まりか。。。 <br>  <br> _atexitはANSIだと↓だと思うけど。 <br>  <br> int _atexit( void (__cdecl *func)(void)); <>
超先生@OS板  </b>◆OS/dd1Xc <b><>sage<>02/08/08 22:02<> 訂正： int _atexit( void (*func)(void));  <>
デフォルトの名無しさん<>sage<>02/08/08 22:11<> atexitが呼ばれないようにすればいいんじゃない？  <br>    <br>  static X86MemoryManager *theInstance;  <br>  if (!theInstance) theInstance = new X86MemoryManager;  <br>  return *theInstance;   <br>    <br>  あとさ、何で atexit にアンダーバー付けて定義してるの？  <br>   <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/08 23:13<> <a href="../test/read.cgi/tech/1027080631/373" target="_blank">&gt;&gt;373</a> 374 375 <br> &gt;int _atexit( void (*func)(void)); <br> ありがとうございます。この定義でも同じエラーが出てしまいました。 <br>  <br> atexitが呼ばれないようにすればいいんじゃない？ <br>  <br> &gt;static X86MemoryManager *theInstance; <br> &gt;if (!theInstance) theInstance = new X86MemoryManager; <br> &gt;return *theInstance; <br> 実はこのクラスに限っては上記の方法を使いたくんないんです。 <br> このクラスのallocateMemory()が、newや、mallocの元となる関数なんです。 <br> このクラスが完成したらnewや、mallocが <br> 使えるようになって、幸せになる予定です。 <br>  <br> &gt;あとさ、何で atexit にアンダーバー付けて定義してるの？ <br> _を除いて、コンパイルしてリンクしたら幸せになりました。 <br> ありがとうございます <br>  <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/08/08 23:27<> ところで <br> &gt;超先生@OS板 <br> &gt;いよいよ夏の祭典が始まりか? <br> 夏の祭典てなんですか？ <>
デフォルトの名無しさん<>sage<>02/08/08 23:48<> 甲子園！ <br>  <br> 違うか。。。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/08 23:50<> 甲子園か・・・ <br> 超先生@OS板さんは、謎多し <br>  <br>  <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/09 00:18<> higepos開発時に簡単な図を含んだドキュメントを作ろうと思っているのですが、 <br> 何かお勧めな、フリーのツールで一般的なファイル形式のものってないでしょうか。 <br>  <br> 複数人で開発するので少なくともWindowsおよびunix系のどちらでも編集閲覧 <br> が可能でないとまずいのですが、今のところ候補は、 <br> open office???とかしか思い浮かばないです・・・ <br>  <br> UMLが描けたら最高ですが、簡単な図が描けるだけでも十分です。 <br> メモリの図やら簡単なクラス図とか･･･ <br>  <>
デフォルトの名無しさん<>sage<>02/08/09 00:23<> ぉぉ、超先生！こんなところに出張してるとは（ワラ <>
デフォルトの名無しさん<>sage<>02/08/09 00:38<> 自分で超だの先生だの名乗る人間は碌な人間じゃない。 <>
デフォルトの名無しさん<>sage<>02/08/09 10:29<> <a href="../test/read.cgi/tech/1027080631/380" target="_blank">&gt;&gt;380</a> 一般的なファイル形式 と言うならHTMLでしょ　次は .pdf  <>
デフォルトの名無しさん<><>02/08/09 10:41<> ちょっと違うかもしれんが… <br> http://pc3.2ch.net/test/read.cgi/tech/1008775775/l50 <>
デフォルトの名無しさん<>sage<>02/08/09 12:43<> <a href="../test/read.cgi/tech/1027080631/382" target="_blank">&gt;&gt;382</a>  <br>  10点 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/09 22:12<> <a href="../test/read.cgi/tech/1027080631/383" target="_blank">&gt;&gt;383</a> 384  <br>  ありがとうございます。  <br>  htmlは図形描画が厳しいですね。  <br>  pdfって、adobeのWriter以外の編集手段ってあるんでしょうか？  <br>    <br>  ところで  <br>  Gnu diaってどうなんでしょうか? <>
デフォルトの名無しさん<>sage<>02/08/09 22:30<> TeXとかは? 一応図も書けるし. <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/09 22:35<> <a href="../test/read.cgi/tech/1027080631/387" target="_blank">&gt;&gt;387</a> <br> texいいですね。 <br> 学生のとき愛用してました。 <br> でもtexの本、友達にあげちゃいました。 <br> texかあ、すっかり忘れたなあ。卒論のときは重宝しました。 <br> Wordで卒論かいてるやつが気の毒だった・・・ <>
387<>sage<>02/08/09 22:40<> &gt;&gt;Wordで卒論かいてるやつが気の毒だった・・・ <br> 禿同. <br>  <br> …とか言ってる俺がWordで仕様書書きながらこのスレを <br> 見てるわけだ. もう見てらんない…. <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/09 22:46<> <a href="../test/read.cgi/tech/1027080631/389" target="_blank">&gt;&gt;389</a> <br> 卒論って、画像とか張りまくって <br> 表とかが多いのでWordがすごい不安定になるんですよね。 <br>  <br> とかいいながら、わたしもテスト仕様書をExcelでかいてたりする・・・ <>
デフォルトの名無しさん<>sage<>02/08/09 23:02<> 馴れ合いはsageでいこうや <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/08/09 23:04<> りょうかい！！！ <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/08/09 23:12<> 機能は、X86MemoryManagerのSingleton化と <br> そいつのメソッドを使って <br> new,delete演算子を定義しました。 <br> でも怖くてまだ使えてません。 <br> 土日にじっくりと実験してみようと思います。 <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/08/09 23:14<> 機能→昨日m(_ _)m <>
デフォルトの名無しさん<>sage<>02/08/10 11:02<> sourceforge.jp　に行ったら、Higeposプロジェクトが活発な <br> プロジェクト一覧に入ってたよ。 <br> すごいじゃん。 <br>  <>
デフォルトの名無しさん<><>02/08/10 18:28<> GNU Dia  <br>  http://www.lysator.liu.se/~alla/dia/ <>
デフォルトの名無しさん<>sage<>02/08/10 18:49<> <a href="../test/read.cgi/tech/1027080631/395" target="_blank">&gt;&gt;395</a> <br> 俺も見た。すごいねー。 <>
デフォルトの名無しさん<><>02/08/10 19:25<> 自分もひげぽんさんに感化されてOS作ろうとしているんですが <br> http://pcmania.jp/~osdev/echo/first_boot.asm <br> これをNASMでコンパイルして実行するだけで3rd exceptionが出てしまいます。 <br> どこらへんが悪いか誰か御教授お願いします… <>
デフォルトの名無しさん<>sage<>02/08/10 19:56<> OS Developer's Siteの管理人さんですか <br>  <br> &gt;これをNASMでコンパイルして実行するだけで3rd exceptionが出てしまいます。 <br> 画面には何か表示された？ <br> 関連ファイルはすべて提示したほうがきっと、玄人さんたちが <br> 答えやすいと思うよ <br> OSを作りたいなら、higeposに参加するのもあり <>
398<><>02/08/10 21:45<> <a href="../test/read.cgi/tech/1027080631/398" target="_blank">&gt;&gt;398</a> <br> 自己レス。 <br> 恥ずかしながら単にセグメントレジスタについて勘違いしておかしな設定をしてしまっていただけのようです。 <br> それを直したらうまく動いてくれました。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/399" target="_blank">&gt;&gt;399</a> <br> &gt;&gt;OSを作りたいなら、higeposに参加するのもあり <br> 自分ではペースが遅くてあまり貢献できなさそうなので１人マイペースで作っていく予定です。 <>
デフォルトの名無しさん<>sage<>02/08/10 22:11<> higeposはGPLなのか…。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/10 22:49<> <a href="../test/read.cgi/tech/1027080631/395" target="_blank">&gt;&gt;395</a> 397 <br> &gt;sourceforge.jp　に行ったら、Higeposプロジェクトが活発な <br> &gt;プロジェクト一覧に入ってたよ。 <br> &gt;すごいじゃん <br> ありがとうございます。でもあれって、何が基準なんだろう。 <br> 75.555%みたいな表示があるけど･･･ <br>  <br> <a href="../test/read.cgi/tech/1027080631/401" target="_blank">&gt;&gt;401</a> <br> &gt;&gt;higeposはGPLなのか…。 <br> sourceforge.jpの申請時にライセンスを選ばなければいけなかったので <br> GPLにしました。 <br> でもGPLの説明英語だったから多分3/4位しか理解してない。 <br>  <br> GPLのデメリットとかあるんですかね。 <br> ちょっと不安になってきた。 <br> 一応ライセンスは、変えられるらしいけど。 <br>  <br> ただいま、new実験中。 <br> ２重インクルード防止を忘れてたので、でいろいろと書き換え中。 <br>  <>
デフォルトの名無しさん<>sage<>02/08/10 23:01<> オープンソフトのライセンスについて <br> ttp://icrouton.as.wakwak.ne.jp/pub/e-law/opensource.html <br>  <br> 個人的にはBSDが好き。GPLは縛りがきついので使えない事が多い。 <br> でも、ひげぽんがｲｲ!と思うライセンス形態にすればいいと思うよ。 <>
403<>sage<>02/08/10 23:03<> オープンソフト→オープンソースだ。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/10 23:42<> <a href="../test/read.cgi/tech/1027080631/403" target="_blank">&gt;&gt;403</a> <br> 大変有用なリンクをありがとうございます。 <br> とりあえず、GPLのままで行こうかなと思います。 <br> GPLに必要な、COPYINGを追加しました。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/11 00:19<> メモリを割り当てる実験をしているのですが、 <br> mallocやnew演算子の元となる関数で返す、割り当てられたメモリの <br> 先頭アドレスって、CSのなかでのオフセットアドレスで良いんでしょうか。 <br>  <br> bochsで以下のエラーが出てしまいます。 <br> 実装方法は、<a href="../test/read.cgi/tech/1027080631/361" target="_blank">&gt;&gt;361</a>のような感じです。 <br>  <br> &gt;0000311650e[CPU  ] prefetch: running in bogus memory <br> &gt;0000311652i[CPU  ] write_virtual_checks(): write beyond limit, r/w <br> &gt;0000311687p[CPU  ] &gt;&gt;PANIC&lt;&lt; iret: return CS selector null <br>  <>
超先生@OS板  </b>◆OS/dd1Xc <b><>sage<>02/08/11 01:01<> <a href="../test/read.cgi/tech/1027080631/406" target="_blank">&gt;&gt;406</a> <br> 　∧＿∧  <br> ＜ ｀ー´＞y-~~~ 念のため確認しておくと、 <br> 仮想関数の呼び出し(allocateMemory)自体は問題ないのかな？ <br>  <br> 仮想関数テーブルが初期化されていないため、 <br> running in bogus memoryになってる気がする。 <>
デフォルトの名無しさん<>sage<>02/08/11 01:06<> ひげぽんも知ってると思うけど, GPLの和訳もネットに転がってるから,  キチンと理解したいのなら探してみるのもいいかもしんない. <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/11 09:32<> <a href="../test/read.cgi/tech/1027080631/407" target="_blank">&gt;&gt;407</a> <br> 超先生@OS板さん、いつもありがとうございます。 <br>  <br> &gt;仮想関数テーブルが初期化されていないため、 <br> &gt;running in bogus memoryになってる気がする。 <br>  <br> X86MemoryManager& mm = X86MemoryManager::instance(); <br> _sysPrintInt(mm.allocateMemory(500)); <br>  <br> と実行すると意図どおりの動きをするので <br> 仮想関数呼び出しは問題ないと思います。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/408" target="_blank">&gt;&gt;408</a> <br> &gt;ひげぽんも知ってると思うけど, GPLの和訳もネットに転がってるから, キチンと理解したいのなら探してみるのもいいかもしんない <br> ありがとうございます。 <br> そうですね。上であげていただいたリンクも結構詳しい解説が載っていましたよ。 <>
デフォルトの名無しさん<>sage<>02/08/11 10:22<> あのさー、そろそろ最小のCランタイム書いた方が良いんじゃない？ <br> atexitだって存在しないと静的なクラスのデストラクタ呼び出しが出来なくなるだろうし。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/11 15:51<> <a href="../test/read.cgi/tech/1027080631/410" target="_blank">&gt;&gt;410</a>  <br>  Cで書いた方がOS作りに集中でき、余計な面倒がかからないと  <br>  仰ってくれてるのは大変ありがたいのですが、  <br>  もう少しだけがんばってみます。m(__)m  <br>    <br>  <a href="../test/read.cgi/tech/1027080631/409" target="_blank">&gt;&gt;409</a>  <br>  メモリ割り当てのエラーに関して問題の切り分けをしてみたところ  <br>  どうやら超先生@OS板さんのご指摘の通りかもと思われます。  <br>    <br>  --&nbsp;テスト用&nbsp;--  <br>  int*&nbsp;num&nbsp;=&nbsp;(int*)malloc(sizeof(int));  <br>  *num&nbsp;=&nbsp;8885;  <br>  _sysPrintInt(*num);  <br>    <br>    <br>  --&nbsp;これは動きました&nbsp;--  <br>  void*&nbsp;malloc(unsigned&nbsp;long&nbsp;size)&nbsp;{  <br>  &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(void*)0x10000;  <br>  }  <br>    <br>  --&nbsp;これはエラーでした&nbsp;--  <br>  void*&nbsp;malloc(unsigned&nbsp;long&nbsp;size)&nbsp;{  <br>  &nbsp;&nbsp;&nbsp;&nbsp;X86MemoryManager&&nbsp;mm&nbsp;=&nbsp;X86MemoryManager::instance();  <br>  &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(void*)mm.allocateMemory(size);  <br>  }  <br>    <br>  unsigned&nbsp;long&nbsp;X86MemoryManager::allocateMemory(unsigned&nbsp;long&nbsp;size)&nbsp;{  <br>  &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0x10000;  <br>  }  <br>    <br>  --&nbsp;エラー内容&nbsp;--  <br>  00000311654i[CPU&nbsp;&nbsp;]&nbsp;write_virtual_checks():&nbsp;no&nbsp;write&nbsp;access&nbsp;to&nbsp;seg  <br>  00000311654p[CPU&nbsp;&nbsp;]&nbsp;&gt;&gt;PANIC&lt;&lt;&nbsp;exception():&nbsp;3rd&nbsp;exception&nbsp;with&nbsp;no&nbsp;resolution  <br>    <br>  超先生@OS板さんのご指摘の通り  <br>  仮想関数テーブルの初期化辺りが怪しいのかといろいろ調べたのですが  <br>  ちょっと行き詰っています。  <br>  WEBで調べたところ仮想関数テーブルは、GCCが作成してくれるみたいな  <br>  記述があったのですが、この認識は間違っているのでしょうか。  <br>   <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/08/11 15:52<> <a href="../test/read.cgi/tech/1027080631/409" target="_blank">&gt;&gt;409</a>で書いたように <br> 一部の関数はきちんと動いているので余計混乱しています。 <br> うーん。 <>
デフォルトの名無しさん<><>02/08/11 16:42<> <a href="../test/read.cgi/tech/1027080631/405" target="_blank">&gt;&gt;405</a> <br> gcc使っているなら絶対gplでなきゃだめジャン。 <>
デフォルトの名無しさん<>sage<>02/08/11 16:43<> <a href="../test/read.cgi/tech/1027080631/413" target="_blank">&gt;&gt;413</a> ん？　なぜ？　まあいいか別のスレでやっておくれ <>
デフォルトの名無しさん<>sage<>02/08/11 17:39<> <a href="../test/read.cgi/tech/1027080631/411" target="_blank">&gt;&gt;411</a> <br> &gt;Cで書いた方がOS作りに集中でき、余計な面倒がかからないと  <br> &gt;仰ってくれてるのは大変ありがたいのですが、  <br> &gt;もう少しだけがんばってみます。m(__)m  <br>  <br> ちゃうちゃう。 <br> シングルトンにするとリンクエラーが出るんだろ？ <br> つーことは、静的領域にあるインスタンスの解放（デストラクタ呼び出し）は <br> Cランタイムのatexitを利用して実装してるって事になる。 <br> 勝手にatexitを何もしない物で置き換えたら、メモリマネージャのデストラクタが呼ばれなくなるはず。 <>
デフォルトの名無しさん<>sage<>02/08/11 17:40<> <a href="../test/read.cgi/tech/1027080631/413" target="_blank">&gt;&gt;413</a> <br> gccを使っても問題ない。 <br> 古いバージョンのglibcを使うとGPLに縛られることになるけど、 <br> このプロジェクトでは標準ライブラリも使ってないしね。 <>
デフォルトの名無しさん<>sage<>02/08/11 17:43<> <a href="../test/read.cgi/tech/1027080631/413" target="_blank">&gt;&gt;413</a> <br> (ﾟДﾟ)ﾊｧ? <br> http://www.gnu.org/licenses/gpl-faq.ja.html#CanIUseGPLToolsForNF <br>  <br> (´-`).｡ｏＯ(なんでこういう誤解する香具師が減らないんだろう・・・) <>
デフォルトの名無しさん<>sage<>02/08/11 18:09<> <a href="../test/read.cgi/tech/1027080631/413" target="_blank">&gt;&gt;413</a> <br> ライセンスも理解してないバカが発言するな。 <>
デフォルトの名無しさん<><>02/08/11 18:45<> <a href="../test/read.cgi/tech/1027080631/416" target="_blank">&gt;&gt;416</a> <br> 標準ライブラリを使ってもgplに引っかかるのか？ <>
デフォルトの名無しさん<>sage<>02/08/11 19:46<> <a href="../test/read.cgi/tech/1027080631/419" target="_blank">&gt;&gt;419</a> <br> 新しいバージョンのglibcはLGPLだったはず。 <br> 昔はGPLだった。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/11 19:54<> <a href="../test/read.cgi/tech/1027080631/415" target="_blank">&gt;&gt;415</a> <br> &gt;シングルトンにするとリンクエラーが出るんだろ？ <br> &gt;つーことは、静的領域にあるインスタンスの解放（デストラクタ呼び出し）は <br> &gt;Cランタイムのatexitを利用して実装してるって事になる。 <br> &gt;勝手にatexitを何もしない物で置き換えたら、メモリマネージャのデストラクタが呼ばれなくなるはず <br> すいません。大きな誤解をしていたようで・・・ <br> つまり、リンクエラーの回避のためにatexitを実装するなら <br> 静的領域にあるインスタンスのデストラクタが呼ばれるように <br> きちんと実装しないとだめということですね。 <br> これであってますでしょうか。 <br>  <br>  <>
デフォルトの名無しさん<><>02/08/11 23:45<> <a href="../test/read.cgi/tech/1027080631/420" target="_blank">&gt;&gt;420</a>  <br>  LGPLって、GPLよりゆるいんだよね。 <>
デフォルトの名無しさん<>sage<>02/08/12 15:11<> &gt;つーことは、静的領域にあるインスタンスの解放（デストラクタ呼び出し）は <br> &gt;Cランタイムのatexitを利用して実装してるって事になる。 <br>  <br> やっぱりC++のソースから吐き出されるアセンブラソースが完璧に <br> 想定できるようでないと、カーネル組むのは難しいね。 <br> ひげぽんがC++でがんばってるの見るといろいろと参考になります。 <br>  <br> ところで、oskitはMSのCOMを真似てC++でもOSが作れるようにしてる <br> みたいだけど、そのあたりの技術はかっぱらってこれないかしら？ <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/12 22:14<> <a href="../test/read.cgi/tech/1027080631/423" target="_blank">&gt;&gt;423</a>  <br>  oskitダウンロードしてみました。  <br>  ソースはかなり参考になりますね。  <br>  ありがとうございます。  <br>    <br>  今も暴走中・・・  <br>   <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/12 23:11<> AtheOSがC++で書かれているようですね。 <br> あれくらいのOS作りたいなあと思う今日この頃 <br>  <br> やっぱり仮想関数呼び出し辺りが非常に怪しい。 <br> すごい怪しい・・・ <br>  <br>  <>
デフォルトの名無しさん<>sage<>02/08/12 23:37<> &gt;ひげぽん <br> いまAtheOSを見てみたけどカーネルはCで書いてあるよ。 <br> 前に見たときの記憶だとeCosがC++だったような。。 <br>  <br> それよりもC++の出すアセンブラをよく見た方が <br> 良さそうだね。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/13 23:12<> <a href="../test/read.cgi/tech/1027080631/426" target="_blank">&gt;&gt;426</a> <br> &gt;前に見たときの記憶だとeCosがC++だったような <br> ありがとうございます。 <br> 時間のあるときにぜひ見てみます。 <br>  <br> &gt;それよりもC++の出すアセンブラをよく見た方が <br> &gt;良さそうだね。 <br> そうですね。 <br> 早く安定した、C++環境を構築することも大きな目標です。 <br> 今日は今帰ってきたのであまり進んでおりません。 <br>  <>
超先生@OS板  </b>◆OS/dd1Xc <b><>sage<>02/08/13 23:29<> gccが吐き出したバイナリをupしてもらえると、 <br> 何か手がかりがつかめるかも知れず。 <>
デフォルトの名無しさん<>sage<>02/08/13 23:51<> &gt;428 <br> そこまでしてあげますか。 <br> ご苦労様です。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/14 00:36<> <a href="../test/read.cgi/tech/1027080631/428" target="_blank">&gt;&gt;428</a> <br> 超先生@OS板さんいつもありがとうございます。 <br> 下記URLにエラーの再現するソースとバイナリを置かせていただきました。 <br> http://oshigepon.tripod.co.jp/ <br>  <br> エラー内容 <br> prefetch:&nbsp;running&nbsp;in&nbsp;bogus&nbsp;memory <br> write_virtual_checks():&nbsp;write&nbsp;beyond&nbsp;limit,&nbsp;r/w <br> &gt;&gt;PANIC&lt;&lt;&nbsp;iret:&nbsp;return&nbsp;CS&nbsp;selector&nbsp;null <br>  <br> 超先生@OS板さんのご好意によりアドバイスが頂けるかもしれないとの <br> ことですが、もしよろしければ今後のためにも <br> 調査のポイント、こんなことを勉強しておけ、こいつを読めなどありましたら <br> ぜひ教えてください。 <br> 本来この部分は自分でどうにかしないといけないことだと思います・・・ <br> 大変申し訳ありませんがもし何か、お気づきの点がありましたら <br> 教えてください。 <br>  <>
超先生@OS板  </b>◆OS/dd1Xc <b><>sage<>02/08/14 01:20<> ttp://www.skyfree.org/linux/references/ELF_Programmer.pdf <br> の 3.1 Global Constructors and destructors in C++ <br> が参考になるかも。 <br>  <br> コンストラクタのコードにバイナリ上での目印を埋め込んでもらえるかな。 <br> asm("hlt") を10個程度。 <>
超先生@OS板  </b>◆OS/dd1Xc <b><>sage<>02/08/14 02:03<> というか、crt0のソースコードを見るのが手っ取り早いと思うけど。 <>
デフォルトの名無しさん<>sage<>02/08/14 10:12<> <a href="../test/read.cgi/tech/1027080631/415" target="_blank">&gt;&gt;415</a> <br> OSなんでしょ。atexitなんか何もしなくていいんじゃないの？ <>
デフォルトの名無しさん<>sage<>02/08/14 10:18<> <a href="../test/read.cgi/tech/1027080631/433" target="_blank">&gt;&gt;433</a> <br> あんたはOSのシャットダウンフェーズには何もやらないで <br> 勝手に電源切っちゃうタイプですか？ <>
デフォルトの名無しさん<>sage<>02/08/14 10:45<> シャットダウン処理を静的変数のデストラクタで実装するの？ <br> それ本気で言ってる？ <>
デフォルトの名無しさん<>sage<>02/08/14 11:37<> なんでcrt0なんてものをくっつけるの？ <br> そんなもんリンクしたらだめじゃん <>
デフォルトの名無しさん<><>02/08/14 18:22<> age <br>  <>
デフォルトの名無しさん<>sage<>02/08/14 18:27<> で、マジな話日本人で趣味でOS作ってる奴いるの？ <br>  <br> いたとしたらうpして <>
デフォルトの名無しさん<>sage<>02/08/14 19:06<> OSっいうよりはここでやろうとしてるのはカーネルだよな。 <br> いや、分かっているのならいいんだけど。 <>
デフォルトの名無しさん<>sage<>02/08/14 20:24<> いきなりそんなしちめんどうそうなことせずこれくらいのやつでやったらどうなるよ？ <br>  <br> class base { <br> public: <br> virtual int func(void) = 0; <br> }; <br>  <br> class sub : virtual base { <br> public: <br> static sub& instance(void) <br> { <br> static sub inst; <br> return inst; <br> } <br>  <br> int func(void) <br> { <br> return 100; <br> } <br> }; <br>  <br> void cstart(void) <br> { <br> sub &a = sub::instance(); <br>  <br> // a.func() を表示 <br> } <br>  <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/14 21:13<> <a href="../test/read.cgi/tech/1027080631/431" target="_blank">&gt;&gt;431</a>, 432　超先生@OS板さんありがとうございます。 <br> &gt;ttp://www.skyfree.org/linux/references/ELF_Programmer.pdf <br> &gt;の 3.1 Global Constructors and destructors in C++ <br> &gt;が参考になるかも。 <br> ありがとうございます、参考にさせていただきます。 <br>  <br> &gt;というか、crt0のソースコードを見るのが手っ取り早いと思うけど <br> &gt;なんでcrt0なんてものをくっつけるの？ <br> &gt;そんなもんリンクしたらだめじゃん <br> crt0というものを知らなかったので調べてみたら <br> #一般の C プログラムをコンパイルすると, 全体の先頭に crt0.s  <br> #(をコンパイルして得られる crt0.o) というファイルが自動的に付加される. このファイルには, main 関数を呼び出す前に行なう処理が記述されている.  <br> とでていました。これって勝手にリンクされているのでしょうか。 <br>  <br>  <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/14 21:22<> <a href="../test/read.cgi/tech/1027080631/440" target="_blank">&gt;&gt;440</a>さんのアドバイスに従い <br> --&nbsp;Sub.cpp&nbsp;-- <br> #include&lt;Sub.h&gt; <br>  <br> int&nbsp;Sub::getNumber(void)&nbsp;{ <br> &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;777; <br> } <br>  <br> char*&nbsp;Sub::getName(void)&nbsp;{ <br>  <br> &nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;char*&nbsp;name&nbsp;=&nbsp;"BASE\n"; <br> &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;name; <br> } <br>  <br> --&nbsp;Sub.h&nbsp;-- <br> #include&lt;Base.h&gt; <br>  <br> class&nbsp;Sub&nbsp;:&nbsp;virtual&nbsp;Base&nbsp;{ <br> &nbsp;&nbsp;public: <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;Sub&&nbsp;instance()&nbsp;{ <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;Sub&nbsp;theInstance; <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;theInstance; <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;&nbsp;&nbsp;getNumber(); <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;char*&nbsp;getName(); <br> }; <br>  <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/14 21:22<>  <br> --&nbsp;Base.h&nbsp;-- <br> class&nbsp;Base&nbsp;{ <br> &nbsp;&nbsp;public: <br> &nbsp;&nbsp;&nbsp;&nbsp;virtual&nbsp;int&nbsp;&nbsp;&nbsp;getNumber(void)&nbsp;=&nbsp;0; <br> &nbsp;&nbsp;&nbsp;&nbsp;virtual&nbsp;char*&nbsp;getName(void)&nbsp;&nbsp;&nbsp;=&nbsp;0; <br> }; <br>  <br>  <br> --&nbsp;higeOperetor.cpp&nbsp;-- <br> char*&nbsp;getName()&nbsp;{ <br> &nbsp;&nbsp;&nbsp;&nbsp;Sub&&nbsp;sub&nbsp;=&nbsp;Sub::instance(); <br> &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sub.getName(); <br> } <br>  <br> --&nbsp;startKernel.cpp&nbsp;-- <br> Sub&&nbsp;sub&nbsp;=&nbsp;Sub::instance(); <br> _sysPrintInt(sub.getNumber());&nbsp;/*&nbsp;直接呼出しOK&nbsp;&nbsp;&nbsp;*/ <br> _sysPrint(sub.getName());&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;直接呼出しOK&nbsp;&nbsp;&nbsp;*/ <br> _sysPrint(getName());&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;間接呼び出しNG&nbsp;*/ <br>  <br> --&nbsp;エラー内容&nbsp;-- <br> prefetch:&nbsp;running&nbsp;in&nbsp;bogus&nbsp;memory <br> write_virtual_checks():&nbsp;write&nbsp;beyond&nbsp;limit,&nbsp;r/w <br> &gt;&gt;PANIC&lt;&lt;&nbsp;iret:&nbsp;return&nbsp;CS&nbsp;selector&nbsp;null <br>  <br>  <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/14 21:24<> 上記のインスタンス取得後 sub.getNumbet(); <br> のような呼び出しは大丈夫だが。 <br>  <br> 関数getName()を介してSub::getNameを呼び出すと <br> エラーになってしまいます。 <>
超先生@OS板  </b>◆OS/dd1Xc <b><>sage<>02/08/15 02:22<> Sub* sub = &Sub::instance(); <br> _sysPrintInt(sub); <br>  <br> だとどうなるのかな？ <>
名無しの組込みプログラマ<>sage<>02/08/15 12:56<> <a href="../test/read.cgi/tech/1027080631/441" target="_blank">&gt;&gt;441</a> <br> &gt; crt0というものを知らなかったので調べてみたら  <br> &gt; #一般の C プログラムをコンパイルすると, 全体の先頭に crt0.s   <br> &gt; #(をコンパイルして得られる crt0.o) というファイルが自動的に付加される. このファイルには, main 関数を呼び出す前に行なう処理が記述されている.   <br> &gt; とでていました。これって勝手にリンクされているのでしょうか。  <br>  <br> 「一般のCプログラムをコンパイルすると」じゃなくて、「一般の <br> Cプログラムをリンクすると」だね。 <br>  <br> 勝手にリンクされるかどうかはあなたがどーやってリンクして <br> るか次第。 <br> モノを見ずに憶測で言えば、リンクされてはいないと思う。 <br> 逆に言えば、crt0.o相当の処理を追加する必要があるって <br> こった。 <br> 超先生がソースを見ろって言ってるのもそういう意味だろ <br> ね。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/15 22:31<> <a href="../test/read.cgi/tech/1027080631/445" target="_blank">&gt;&gt;445</a> 超先生@OS板さん  <br>  &nbsp;&nbsp;&nbsp;&nbsp;Sub*&nbsp;sub&nbsp;=&nbsp;&Sub::instance();  <br>  &nbsp;&nbsp;&nbsp;&nbsp;_sysPrintInt((int)sub);  <br>  としてみたところ。  <br>  10288(0x2830)と表示されました。  <br>    <br>  <a href="../test/read.cgi/tech/1027080631/446" target="_blank">&gt;&gt;446</a>  <br>  &gt;「一般のCプログラムをコンパイルすると」じゃなくて、「一般の  <br>  &gt;Cプログラムをリンクすると」だね。  <br>  そうですね。  <br>    <br>  &gt;逆に言えば、crt0.o相当の処理を追加する必要があるって  <br>  &gt;こった。  <br>  &gt;超先生がソースを見ろって言ってるのもそういう意味だろ  <br>  &gt;ね。  <br>  crt0ってmainを呼び出す処理とかをしているように思われるのですが  <br>  フロッピーブートするOS(もどき)にも必要なのでしょうか。  <br>    <br>    <br>   <>
名無しの組込みプログラマ<>sage<>02/08/15 23:18<> <a href="../test/read.cgi/tech/1027080631/447" target="_blank">&gt;&gt;447</a> <br> &gt;  crt0ってmainを呼び出す処理とかをしているように思われるのですが   <br> &gt;  フロッピーブートするOS(もどき)にも必要なのでしょうか。   <br>  <br> 「とか」の部分が重要なことがあるよ、ということです。 <br> 必要かどうかは、自分で判断ね。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/15 23:26<> <a href="../test/read.cgi/tech/1027080631/448" target="_blank">&gt;&gt;448</a>  <br>  &gt;「とか」の部分が重要なことがあるよ、ということです。  <br>  &gt;必要かどうかは、自分で判断ね。  <br>  なるほど。  <br>  では、今回のエラーは、もしかしたらcrt0の部分でやるべき  <br>  作業をしていないことが原因かもしれないということですね。  <br>  勉強になります。ありがとうございます。  <br>   <>
デフォルトの名無しさん<>sage<>02/08/16 19:29<> 今動かない原因とは直接関係ないと思うけど、注意すべき点を幾つか。 <br>  <br> 静的に初期化出来ないデータ(プリミティブ型ではないもの)や <br> 指定する初期値が定数でない(関数の返り値など)に対して <br> 関数内staticなインスタンスを用いる場合、一般的なコンパイラの生成コードは、 <br> staticなフラグとインスタンス用の領域だけを用意して <br> 最初に到達した時に初期化するという形式になると思われます。 <br>  <br> 具体的には、 <br> Singleton& Singleton::instance() { <br> 　static Singleton instancedata; <br> 　return instancedata; <br> } <br> は、実際には下のようなコードが作られるということです。 <br> Singleton& Singleton::instance() { <br> 　static bool flag; // = false; <br> 　static char instancedata[sizeof(Singleton)]; <br> 　if (!flag) { <br> 　　flag = true; <br> 　　new (instancedata) Singleton(); <br> 　　add_destructor_list(data, Singleton::~Singleton); // 擬似コード <br> 　} <br> 　return *(Singleton *)&instancedata; <br> } <>
デフォルトの名無しさん<>sage<>02/08/16 19:30<> このコードの中には、注意すべき点が３つほどあります。 <br>  <br> まず、デストラクタを呼び出すために <br> thisとデストラクタ関数のアドレスをどこかに登録しています。 <br> C++は、他の多くの言語と違い統一基底クラスがないため <br> インスタンスのポインタだけではデストラクタを呼び出せません。 <br> ポインタと共に関数のアドレスも渡す必要があり、 <br> これをどこかで管理しておいてプログラムが終了する前に呼び出すことになります。 <br>  <br> 次に、初期にstaticなフラグを使っていることです。 <br> コンパイラの生成コードは、単独のコンテキストで実行される前提のため、 <br> コストの増えるロック等は一般にはしていません。 <br> このようなコードはマルチスレッド(あるいは非同期処理)において <br> 支障をきたす可能性があります。 <br> 割りこみハンドラや複数の(ユーザー)プロセスから呼ばれる可能性があるのなら <br> flagをtrueにする前に排他制御を行い、再度flagを確認してから処理をすべきです。 <br>  <br> 最後に、非初期化データ領域が0で埋まっていることを前提としている事です。 <br> flagやinstancedataに使う領域は、実行ファイルが無意味に大きくならないよう、 <br> data領域ではなくbss領域に置かれ、スタートアップで０クリアされることが <br> 期待されています。 <br> 別の言い方をすると、crt0をリンクしないのならば <br> 非初期化データが0であることに依存してはならないのに、 <br> コンパイラの生成するコードがそれに依存している(可能性が高い)ということです。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/17 09:37<> <a href="../test/read.cgi/tech/1027080631/450" target="_blank">&gt;&gt;450</a>,451さん <br> ありがとうございます。 <br>  <br> 大変勉強になります。 <br> もともとSingletonのコードを書くときに <br> flgを用いないようにしたのは、スレッドセーフにしようという意図だったのですが <br> 見事にコンパイラが危険なコードを吐いてくれてるんですね。 <br>  <br> &gt;別の言い方をすると、crt0をリンクしないのならば <br> &gt;非初期化データが0であることに依存してはならないのに、 <br> &gt;コンパイラの生成するコードがそれに依存している(可能性が高い)ということ <br> なるほど。 <br> でもだからといって、crt0を安易にそのままリンクするというのも <br> 問題がありそうですね。 <br>  <br> 今回の問題はいまだ解決せず、思うように進んでいないので <br> ちょっと逃避してクラス図を追加しました。 <br>  <>
デフォルトの名無しさん<>sage<>02/08/17 09:54<> ユーザーオブジェクト以外でObjectルートにする意味ってあるか？ <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/17 10:04<> <a href="../test/read.cgi/tech/1027080631/453" target="_blank">&gt;&gt;453</a> <br> 突っ込みありがとうございます。 <br> MemoryManagerに関して言えばObjectをルートにする必要は多分ないと思います。 <br> カーネル内のクラスでは、同一インターフェースを実装した <br> 複数種類のオブジェクトがいる予定なので <br> デバッグ時にObjectのメソッドを活用しようかと･･･ <>
デフォルトの名無しさん<>sage<>02/08/17 19:07<> うまくいかない部分はとりあえず保留にして、  <br>  他の部分の実装に入るのもありかと思うよ。 <>
デフォルトの名無しさん<>sage<>02/08/17 19:16<> ダメダメ、本当はオブジェクト形式やリロケーションなどの知識は <br> 制作に入る前に知っておかなければならないことだし、 <br> これは解決しておかないといつも詰まってばかりで進行が滞るんでない？ <>
デフォルトの名無しさん<>sage<>02/08/17 19:27<> ここのところあまり進んでなさそうだよね。 <br> モチベーションが下がると思ってさ。 <br> 今どの段階でつまってるんだっけ？ <>
デフォルトの名無しさん<>sage<>02/08/17 19:46<> ここを解決しないなら、ＣでやるかＣ＋＋の危険そうな機能は使わないことかな。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/442" target="_blank">&gt;&gt;442</a> <br> じゃ、下みたいに継承を削ったらどうなる？ <br> 仮想関数が原因かどうか分かるんでない？ <br>  <br> class Sub { <br>   public: <br>       static Sub& instance() { <br>           static Sub theInstance; <br>           return theInstance; <br>       } <br>       int   getNumber(); <br>       char* getName(); <br> }; <br>  <>
 <>sage<>02/08/17 19:50<> <a href="../test/read.cgi/tech/1027080631/443" target="_blank">&gt;&gt;443</a> <br> アセンブラのコードは見てみた？手元のgccだと、 <br> これどっちも同じコード吐くんだけど。 <br>  <br> &gt; _sysPrint(sub.getName());      /* 直接呼出しOK   */  <br> &gt; _sysPrint(getName());          /* 間接呼び出しNG */  <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/17 20:18<> <a href="../test/read.cgi/tech/1027080631/455" target="_blank">&gt;&gt;455</a> 456 <br> そうですね。保留にして先に進みたいのですが、 <br> メモリ管理が出来ないとnewすらできないので <br> 非常に困るのですよね。 <br>  <>
デフォルトの名無しさん<>sage<>02/08/17 20:21<> オブジェクト指向スレでC++でOS書けるとか息巻いてた <br> 先生方はどこへ行かれたのでしょうか？素朴な疑問です。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/17 20:36<> <a href="../test/read.cgi/tech/1027080631/458" target="_blank">&gt;&gt;458</a>さん <br> 継承を削ってみたところ、 <br> 別のエラーが出ました。エラー内容は <br>  <br> 00000775036e[CPU&nbsp;&nbsp;]&nbsp;prefetch:&nbsp;running&nbsp;in&nbsp;bogus&nbsp;memory <br> です。 <br>  <br> そのときのアセンブラコードは <br>  <br> [_sysPrintln(sub.getName());] <br> 00000104&nbsp;&nbsp;83EC0C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub&nbsp;esp,byte&nbsp;+0xc <br> 00000107&nbsp;&nbsp;FF75FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;dword&nbsp;[ebp-0x4] <br> 0000010A&nbsp;&nbsp;E8F1080000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;0xa00 <br> 0000010F&nbsp;&nbsp;83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;esp,byte&nbsp;+0x4 <br> 00000112&nbsp;&nbsp;50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;eax <br> 00000113&nbsp;&nbsp;E8EC000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;0x204 <br> 00000118&nbsp;&nbsp;83C410&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;esp,byte&nbsp;+0x10 <br>  <br> [_sysPrintln(getName());] <br> 00000120&nbsp;&nbsp;83EC0C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub&nbsp;esp,byte&nbsp;+0xc <br> 00000123&nbsp;&nbsp;83EC04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub&nbsp;esp,byte&nbsp;+0x4 <br> 00000126&nbsp;&nbsp;E84F070000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;0x87a <br> 0000012B&nbsp;&nbsp;83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;esp,byte&nbsp;+0x4 <br> 0000012E&nbsp;&nbsp;50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;eax <br> 0000012F&nbsp;&nbsp;E8D0000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;0x204 <br> 00000134&nbsp;&nbsp;83C410&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;esp,byte&nbsp;+0x10 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/17 20:37<>  <br> <a href="../test/read.cgi/tech/1027080631/459" target="_blank">&gt;&gt;459</a>さん <br> 継承をそのまま残した場合は <br>  <br> 00000782814e[CPU&nbsp;&nbsp;]&nbsp;load_seg_reg:&nbsp;GDT:&nbsp;ES:&nbsp;index(1fd8)&nbsp;&gt;&nbsp;limit(00001f) <br> 00000782849p[CPU&nbsp;&nbsp;]&nbsp;&gt;&gt;PANIC&lt;&lt;&nbsp;fetch_raw_descriptor:&nbsp;LDTR.valid=0 <br> というエラーで <br>  <br> [_sysPrintln(sub.getName());] <br> 0000011D&nbsp;&nbsp;83EC0C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub&nbsp;esp,byte&nbsp;+0xc <br> 00000120&nbsp;&nbsp;8B45FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;eax,[ebp-0x4] <br> 00000123&nbsp;&nbsp;8B00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;eax,[eax] <br> 00000125&nbsp;&nbsp;83E814&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub&nbsp;eax,byte&nbsp;+0x14 <br> 00000128&nbsp;&nbsp;8B00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;eax,[eax] <br> 0000012A&nbsp;&nbsp;0345FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;eax,[ebp-0x4] <br> 0000012D&nbsp;&nbsp;8B10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;edx,[eax] <br> 0000012F&nbsp;&nbsp;83C204&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;edx,byte&nbsp;+0x4 <br> 00000132&nbsp;&nbsp;8B45FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;eax,[ebp-0x4] <br> 00000135&nbsp;&nbsp;8B00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;eax,[eax] <br> 00000137&nbsp;&nbsp;83E814&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub&nbsp;eax,byte&nbsp;+0x14 <br> 0000013A&nbsp;&nbsp;8B00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;eax,[eax] <br> 0000013C&nbsp;&nbsp;0345FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;eax,[ebp-0x4] <br> 0000013F&nbsp;&nbsp;50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;eax <br> 00000140&nbsp;&nbsp;8B02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;eax,[edx] <br> 00000142&nbsp;&nbsp;FFD0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;eax <br> 00000144&nbsp;&nbsp;83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;esp,byte&nbsp;+0x4 <br> 00000147&nbsp;&nbsp;50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;eax <br> 00000148&nbsp;&nbsp;E8F7000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;0x244 <br> 0000014D&nbsp;&nbsp;83C410&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;esp,byte&nbsp;+0x10 <br>  <br> [_sysPrintln(getName());] <br> 00000155&nbsp;&nbsp;83EC0C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub&nbsp;esp,byte&nbsp;+0xc <br> 00000158&nbsp;&nbsp;83EC04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub&nbsp;esp,byte&nbsp;+0x4 <br> 0000015B&nbsp;&nbsp;E874070000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;0x8d4 <br> 00000160&nbsp;&nbsp;83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;esp,byte&nbsp;+0x4 <br> 00000163&nbsp;&nbsp;50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;eax <br> 00000164&nbsp;&nbsp;E8DB000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;0x244 <br> 00000169&nbsp;&nbsp;83C410&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;esp,byte&nbsp;+0x10 <>
デフォルトの名無しさん<>sage<>02/08/17 20:46<> class X86MemoryManager:virtual MemoryManager; <br> virtual継承やめたら？ <br> それから、vmmをprivate継承する必要はないでしょう。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/17 20:53<> <a href="../test/read.cgi/tech/1027080631/464" target="_blank">&gt;&gt;464</a>さん <br> &gt;class X86MemoryManager:virtual MemoryManager; <br> &gt;virtual継承やめたら？ <br> &gt;それから、vmmをprivate継承する必要はないでしょう <br> アドバイスありがとうございます。 <br> 今現在出ているエラーが継承に起因するものかきちんと切り分けること <br> ができたら、継承関係の整理もきちんとさせていただきます。 <>
超先生@OS板  </b>◆OS/dd1Xc <b><>sage<>02/08/17 21:25<> やはりmain関数前に実行すべき処理があるはず。(おそらくcrt0相当) <br>  <br> third.binの0x14e8が恐らくはスタートアップ時の関数テーブルだと思う。 <>
 <>sage<>02/08/17 21:34<> <a href="../test/read.cgi/tech/1027080631/463" target="_blank">&gt;&gt;463</a> <br> _sysPrintln(sub.getName()) の呼び出しも vtbl 経由に <br> なっているので、_sysPrintln(sub.getName()) が動いて <br> _sysPrintln(getName()) が動かないのは信じられないのだが。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/17 23:48<> <a href="../test/read.cgi/tech/1027080631/466" target="_blank">&gt;&gt;466</a> <br> 超先生@OS板さん いつもお世話になっております。 <br>  <br> &gt;やはりmain関数前に実行すべき処理があるはず。(おそらくcrt0相当) <br> &gt;third.binの0x14e8が恐らくはスタートアップ時の関数テーブルだと思う。 <br> なるほと。この間教えていただいた通りcrt0のソースをどこからか入手して <br> 見るしかないのでしょうか。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/467" target="_blank">&gt;&gt;467</a> <br> &gt;_sysPrintln(sub.getName()) の呼び出しも vtbl 経由に <br> &gt;なっているので、_sysPrintln(sub.getName()) が動いて <br> &gt;_sysPrintln(getName()) が動かないのは信じられないのだが。 <br> vtblとは、仮想関数テーブルのことですよね。 <br> でもgetName()だけだときちんと動くんですよね。 <br> なせだろう。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/18 00:23<> vtblの解説を見つけたので <br> ttp://www.semantics.org/gotchas/gotcha50.pdf <>
デフォルトの名無しさん<>sage<>02/08/18 01:46<> <a href="../test/read.cgi/tech/1027080631/458" target="_blank">&gt;&gt;458</a>も書いてるけど、怪しげなC++機能は捨てたほうがいい。 <br>  <br> たとえば、コンストラクタ／デストラクタが必要なクラスを静的持続時間を <br> 持つオブジェクトに使わなければ、_atexit()は必要なくなる(はず)。 <br>  <br> MemoryManagerをどうしてもsingletonにしたいなら、 <br>  <br> inline void *operator new(size_t size, void *ptr) { return ptr; } <br>  <br> MemoryManager *mm; <br>  <br> void start() <br> { <br> 　char x86mm[sizeof(X86MemoryManager)]; <br>   mm = new (x86mm) X86MemoryManager; <br> 　mm.~X86MemoryManager;(); <br> } <br>  <br> みたいにするとか。 <br>  <br> 純粋仮想関数呼び出しのハンドラは仕方ないね。 <br> 基本クラスのコンストラクタの実行時のvtblは基本クラスのものになるから、 <br> 純粋仮想関数を持つクラスでは必ず呼び出す可能性がありえる。 <br> Visual C++のコンパイラみたいに、__declspec(novtable)があるなら平気だけど。 <br>  <br> あと、仮想基本クラスは要らないと思うよ。多重継承が必要な場合は、Javaの <br> インタフェースみたいな使い方すればいいんだし。多分設計が間違ってる。 <br>  <br> このあたりはコンパイラにアセンブリ言語のソース吐かせれば調べられるよ。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/18 12:23<> <a href="../test/read.cgi/tech/1027080631/470" target="_blank">&gt;&gt;470</a> <br> &gt;たとえば、コンストラクタ／デストラクタが必要なクラスを静的持続時間を <br> &gt;持つオブジェクトに使わなければ、_atexit()は必要なくなる(はず)。 <br> なるほど、このような手もあるんですね。 <br>  <br> &gt;あと、仮想基本クラスは要らないと思うよ。多重継承が必要な場合は、Javaの <br> &gt;インタフェースみたいな使い方すればいいんだし。多分設計が間違ってる。 <br> &gt;このあたりはコンパイラにアセンブリ言語のソース吐かせれば調べられるよ <br> 元々私は、Java屋なのでX86MemoryManagerは、 <br> インターフェースMemoryManagerをimplmentsしているイメージで設計しました。 <br> つまり、 <br> メモリ管理のコードをjava風に書くのであれば <br>  <br> MemoryManger mm  = new X86MemoryManger(); <br> mm.allocateMemory(size); <br> mm.freeMemory(address); <br>  <br> となります。メモリマネージャを使う場合は、そのインスタンスを <br> X86MemoryManagerとしてではなく、MemoryManagerとして扱います。 <br> もし他のCPU向けに移植する場合は、 <br> MemoryManger mm  = new XXXXMemoryManger(); <br> と書き直して <br> XXXXMemoryMangerを新たに実装するようにすれば良いのかと。 <br>  <br> C++では、インターフェース継承を実現するには、 <br> 純粋仮想関数を基底クラスで宣言することにより実現し、そのクラスを <br> 継承することで実現するのではないのでしょうか。 <br> (Effective C++より) <br> あと、多重継承ですがObjectクラスを継承のことでしょうか。 <br> ttp://cvs.sourceforge.jp/cgi-bin/viewcvs.cgi/higepos/higepos/doc/MemoryManager.png?rev=1.3&content-type=text/vnd.viewcvs-markup <br> をごらんいただければお分かりいただけるかと。 <br>  <br> &gt;このあたりはコンパイラにアセンブリ言語のソース吐かせれば調べられるよ <br> このあたりの重要さは、昨日より痛感しております。 <br>  <>
デフォルトの名無しさん<>sage<>02/08/18 13:00<> &gt;あと、多重継承ですがObjectクラスを継承のことでしょうか。 <br>  <br> virtual継承してるから、多重継承（というか、菱形継承）を気にしてるんだろうけど、 <br> 少なくともこのケースでは菱形継承になるような設計は間違ってるって話だろ。 <>
デフォルトの名無しさん<>sage<>02/08/18 17:48<> 継承削って別のエラーってのもイケてないねェ。 <br> アセンブラコードを部分だけ載せるくらいなら、そのときのソース全部と <br> gcc の -S オプションしたのでＵＰした方が良いかも。 <br>  <>
デフォルトの名無しさん<>sage<>02/08/19 15:26<> &gt;MemoryManger mm = new X86MemoryManger(); <br> &gt;もし他のCPU向けに移植する場合は、 <br> &gt;MemoryManger mm = new XXXXMemoryManger(); <br> &gt;と書き直して <br>  <br> こんなの条件コンパイルでいいじゃん <br> これだからJava屋って.... <br>  <>
デフォルトの名無しさん<>sage<>02/08/19 21:42<> <a href="../test/read.cgi/tech/1027080631/474" target="_blank">&gt;&gt;474</a> <br> Javaだと条件コンパイルできないからAbstractFactoryとか使うだろ。 <br> アンタの回りのJava屋がヘボいだけ。 <br>  <br> MemoryManager mm  = MemoryManager.getInstance(); <br> mm.allocateMemory(size); <br> mm.freeMemory(address); <br>  <br> # 関係ないのでsage <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/20 23:38<> <a href="../test/read.cgi/tech/1027080631/475" target="_blank">&gt;&gt;475</a> <br> フォローありがとうございます。 <br>  <br> エラーに関していまだ解決できておりません。 <br> 逆アセンブラしたものを、↓に置かせていただきました。 <br> http://oshigepon.tripod.co.jp/ <br> 主要部分にはasm("nop");などを埋めました。 <br>  <br> ソースは <br> http://cvs.sourceforge.jp/cgi-bin/viewcvs.cgi/higepos/higepos/src/ <br> でご覧いただけます。 <br>  <br> もしお気づきの点がありましたら、アドバイス、ご指摘いただけると <br> ありがたいです。 <br> よろしくお願いいたします。 <br>  <>
デフォルトの名無しさん<>sage<>02/08/20 23:56<> ひげぽんさん、古いソース、消しちゃいました？ <br> できればフォルダ作って取っておいてもらえるとうれしいかも・・・ <>
デフォルトの名無しさん<>sage<>02/08/21 00:10<> ごめんなさい、ソース移動したんですね。ぼけてました。 <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/08/21 00:11<> <a href="../test/read.cgi/tech/1027080631/477" target="_blank">&gt;&gt;477</a> <br> &gt;ごめんなさい、ソース移動したんですね。ぼけてました。 <br> いえいえこちらこそ、不案内で申し訳ありません。 <br>  <>
デフォルトの名無しさん<>sage<>02/08/21 12:26<> <a href="../test/read.cgi/tech/1027080631/475" target="_blank">&gt;&gt;475</a> <br> ハードアーキテクチャの違いを吸収するため抽象クラスを <br> 使うってのが間違ってるんじゃないのと言いたいわけよ。 <br> 特にメモリアロケータのような低レベルクラスでね。 <br> それが原因(かどうかわからんけど)でドツボにはまってるわけだし。 <br> このケースでは条件コンパイルで十分でしょ。 <br>  <>
デフォルトの名無しさん<>sage<>02/08/21 13:29<> ちと遅れてきたので、また〜りと古い質問してもいいでしょうか？（不味かったら放置してください） <br> secondboot.asmの最後を <br> &gt;; jmp  0x200　　　　← jump をコメントアウト＆hangをコメントイン <br> &gt;hang: <br> &gt;　　jmp hang <br> とすると、「disk reading ... done」を表示して止まるのですが、 <br> 0を表示させようと思って、hang:の前に、 <br> &gt; mov  al, '0'　　　　; 0を表示してhang <br> &gt; mov ah, 0Eh <br> &gt; mov bx, 0h <br> &gt; int 10h <br> を入れると、リブートしてしまいます。 <br> プロテクトモードではもしかしてbiosを使った画面描写ってできないのでしょうか？ <br> それとも基本的な間違いを犯しているのでしょうか？ <br>  <br> あと、現在のファイル全てをmakeしてddでFloppyに書き込んでブートしても、 <br> やはりリブートしてしまいます。（タイミング的には↑と一緒のあたり） <br> いずれも実機（自作機）でやっているのですが、もしよろしければヒントをいただけないでしょうか？ <br> 環境は、ひげぽんさんと同じく nasmw,djgpp です。(Windows2000) <br> ＃必要があればバイナリを逆アセンブルして出してみます。。 <br>  <>
デフォルトの名無しさん<>sage<>02/08/21 14:14<> もうちょっと状況書きます。 <br> ↑の後者についてですが、とりあえずはハングアップさせようと思い、cpstart.cppの <br>  <br> startKernel(); <br>  <br> の直前に <br>  <br> while (true) {} <br>  <br> を挿入します。で、makeして出来たthird.listをみると、 <br>  <br> 00000000  55                push ebp <br> 00000001  89E5              mov ebp,esp <br> 00000003  83EC08            sub esp,byte +0x8 <br> 00000006  90                nop <br> 00000007  EBFE              jmp short 0x7　　←ここでループするはず？ <br>  <br> となっています。そして、first second third を cat したバイナリを <br> バイナリエディタでのぞいてみると、 <br>  <br> 00000400: 55 89 E5 83 EC 08 ・・・・ <br>  <br> となっていて、400番地から命令が正しく入っていると（自分には）思われるのですが、 <br> ddで書き込んでブートすると、リブートしてしまいます・・・ <br>  <br> おかしいと思った点は、 <br> jmp short 0x7 <br> のジャンプ先は 01207 であるべきのような気がします。 <br> もしかして、このせいでしょうか？ <br>  <br> 板汚し、すみません。以上です。 <>
超先生@OS板  </b>◆OS/dd1Xc <b><>sage<>02/08/21 17:13<> <a href="../test/read.cgi/tech/1027080631/481" target="_blank">&gt;&gt;481</a> <br> &gt; プロテクトモードではもしかしてbiosを使った画面描写ってできないのでしょうか？  <br> &gt; それとも基本的な間違いを犯しているのでしょうか？  <br>  <br> そのとおりです。 <br> 自力でVRAMへ書き込む必要があります。 <br>  <br> &gt;jmp short 0x7  <br> &gt;のジャンプ先は 01207 であるべきのような気がします。  <br>  <br> eb feは相対jmp -1という意味になので <br> 絶対的なアドレス(0x120n)は関係ないです。 <>
481<>sage<>02/08/21 17:28<> <a href="../test/read.cgi/tech/1027080631/483" target="_blank">&gt;&gt;483</a> <br> ありがとうございます。VRAMに直書でないといけないのですね。 <br>  <br> &gt;eb feは相対jmp -1という意味になので <br> そうでしたか。ということは、直前のnopあたりに戻ってループできそうですよね？ <br> でもなぜかリブートしてしまいます。 <br> ちょっと変ですね。secondbootから正しくジャンプしてきていないのかな？ <br> 少し考えてみます・・・。 <>
481<>sage<>02/08/21 17:32<> &gt;直前のnopあたりに戻って <br> すんません。jmp命令自身に戻るんですよね。（細かいことですが） <>
デフォルトの名無しさん<><>02/08/22 03:26<> 〈 ﾄｳﾋｮｳｼﾃｸﾀﾞｻｲ　　　〈 ｵﾈｶﾞｲｼﾏｽ…　　　〈 ｺﾉﾄｵﾘﾃﾞｽ！  <br> ￣∨￣￣￣￣￣　　　∨￣￣￣￣￣￣　　∨￣￣￣￣￣  <br> 　（´Д｀;）ヾ　　　　　　（;´Д｀）　　　　　　　　　　　　 ヾ  <br> 　　　∨）　　　　　　　　（　 人)　　　　　　　　　(´Д｀;)、  <br> 　　　（（　　　　　　　　　　〉 〉　　　　　　　　　　　ノノＺ乙  <br>  <br> http://www.gal-para.com/gal-channel/read.cgi?bbs=lounge&key=1028811476&ls=50  <br>  <>
デフォルトの名無しさん<>sage<>02/08/23 00:19<> <a href="../test/read.cgi/tech/1027080631/476" target="_blank">&gt;&gt;476</a>  <br>  ディスアセンブル結果を見たけど、::getName() からの sub.getInstance()  <br>  呼び出しのアドレスが間違っているように見えた。  <br>  sub::getInstance() は0a70h からなのに、::getName()からは0a50hをコール。  <br>  わけわからん。  <br>  １）開発ホスト用にコンパイル＆リンクしたら正常に実行できるの？  <br>  ２）-S とかつけてコンパイルしたアセンブリリストが見たいなあ。  <br>    <br>  昔、オレもＯＳを作ろうとしたことあったよ。  <br>  同人ソフトを作るのに、ＭＳＤＯＳを添付したくなかったから。  <br>  といっても、ＢＯＯＴ＋ファイルシステム＋極小ＤＰＭＩみたいなのだけど。  <br>  シェル無しのヘボＤＯＳだな。  <br>  ゲーム用のシングルタスクだから、メモリ管理もプロセス管理も無いヤツね。  <br>  仕事が忙しくなって中断したが楽しかったなあ（仕事が落ちついたら、ＨＤＤ  <br>  あたりまえの時代になっていて無用になった）。  <br>    <br>  ＣＰＵ、コンパイラ（アセンブラ含む）、リンカ（実行時含む）あたりの知識は  <br>  どんな分野のプログラムでも役に立つと思うから、なるべくアセンブリと額  <br>  つつき合わせてがんばれ！  <br>   <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/23 00:36<> <a href="../test/read.cgi/tech/1027080631/487" target="_blank">&gt;&gt;487</a>さん <br> こんばんわ。 <br> ありがとうございます。 <br> OS作りの先輩ですね。 <br>  <br> &gt;ディスアセンブル結果を見たけど、::getName() からの sub.getInstance() <br> &gt;呼び出しのアドレスが間違っているように見えた。 <br> &gt;sub::getInstance() は0a70h からなのに、::getName()からは0a50hをコール。 <br> &gt;わけわからん。 <br> コンパイル･リンクのどちらかでおかしくなっているのですが、 <br> いったいどういう理由なのかがつかめていません。 <br>  <br> &gt;１）開発ホスト用にコンパイル＆リンクしたら正常に実行できるの？ <br> &gt;２）-S とかつけてコンパイルしたアセンブリリストが見たいなあ。 <br>  <br> 週末にいろいろ実験してご報告させていただきます。 <br> アドバイスありがとうございます。 <br>  <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/23 20:51<> <a href="../test/read.cgi/tech/1027080631/487" target="_blank">&gt;&gt;487</a>さん <br> gcc -Sオプションで吐かれたアセンブラソースを以下のURLに置かせて <br> 頂きました。 <br> http://oshigepon.tripod.co.jp/ <br>  <br> 引き続き調査中です。 <br> もし何かお気づきの点がございましたらご指摘くださいm(__)m <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/25 15:50<> 仮想関数使用時に動きが怪しくなる問題が長い間解決できないので  <br>  とりあえず継承を一切やめて見たところ正常に動作しております。  <br>  （メモリをただ割り当てるだけバージョンのnew,malloc)  <br>    <br>  これから本格的にメモリ管理について実装する予定です。  <br>  メモリ割り当てのときにプロセスIDのようなものを引数で受け取ろうかどうしようか。  <br>  仮想メモリは、ファイルシステムができてからだろうか。  <br>  ファイルシステムと、プロセス管理も考えなくてはいけないことに気づいてきました。  <br>    <br>  以下ﾎﾞﾔｷ  <br>  簡易版vectorをtemplate機能を使って作ってみたら、  <br>  リンク時にエラーが出た･･･  <br>  C++の機能が全然使えてない････  <br>    <br>   <>
デフォルトの名無しさん<>sage<>02/08/25 17:57<> C++って、OSみたいな下位層のプログラムを書くには <br> 複雑すぎるんじゃないの？ <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/25 18:08<> <a href="../test/read.cgi/tech/1027080631/491" target="_blank">&gt;&gt;491</a> <br> そうかもしれませんね。 <br> C++でやるには、コンパイラ・リンカの知識が <br> Cで作る場合に比べてさらに必要ということではないでしょうか。 <br>  <br> 知識がないうちは（今の私)、害が出ない程度に <br> C++の機能を使うしかないのではと思っています。 <>
デフォルトの名無しさん<>sage<>02/08/25 20:19<> ﾑﾑ、面白いｽﾚだ。 <br>  <br> 漏れはCとｱｾﾝﾌﾞﾗは7年前くらいに学んだが最近はC++ <br> に移行しちまってほとんど忘れてるなぁ。Cは覚えてるが。 <br> C++は、確かに複雑だが、やれない事はないと思うよ。 <br> まぁ、漏れが慣れてしまってるからかもしれないが。 <br>  <br>  <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/25 20:23<> <a href="../test/read.cgi/tech/1027080631/493" target="_blank">&gt;&gt;493</a> <br> もしに何かご存知でしたらぜひご教授ください。 <br> 特にリンクcrt0関係やgccの吐くコード・リンクなどについて <br> 困っています。 <>
デフォルトの名無しさん<>sage<>02/08/25 20:34<> 少し上の方から読んでたから、話が見えないのでちょい始めから <br> 目を通して見るね。 <br>  <br> でも、Winｱﾌﾟﾘ屋の漏れの知識は役に立たないかも（ｗ <br>  <br>  <br>  <br>  <br>  <>
kso<>sage<>02/08/25 21:07<> 過去ログなにも見ないで適当なこと言うけど、結局Linuxの二番煎じ？ <>
デフォルトの名無しさん<>sage<>02/08/25 21:20<> <a href="../test/read.cgi/tech/1027080631/496" target="_blank">&gt;&gt;496</a> <br> 基礎の基礎を作ってるとこだよ。 <br> これからの仕様、設計によってどんなOSになるか決まる。 <>
デフォルトの名無しさん<><>02/08/26 19:58<> http://www.mega-tokyo.com/os/os-faq-cpp.html#start <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/27 01:52<> <a href="../test/read.cgi/tech/1027080631/498" target="_blank">&gt;&gt;498</a>さん  <br>  有用なリンクありがとうございます。  <br>  参考にさせていただきます。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/27 01:54<> g++ -nostdlib -nostdinc -fno-builtin -fno-exceptions <br> あたりを参考にさせていただきます。 <br> またbuiltin_のあたりも必須ですよね。 <br>  <>
kso<>sage<>02/08/27 02:05<> フリーか商用か、 <br> LinuxのようなＯＳか、WindowsのようなOSか <br> どっちを目指す？ <br>  <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/08/27 02:22<> <a href="../test/read.cgi/tech/1027080631/501" target="_blank">&gt;&gt;501</a>さん。 <br> フリーですね。 <br> 宝くじが当たったら、仕事やめて開発に専念します（笑） <br> 儲ける気はありませんが、自分の生活くらいは保障されるとうれしいかも <br>  <br> 獲らぬ狸の････でした。 <>
デフォルトの名無しさん<>sage<>02/08/27 08:39<> GUI部分に入ったら標準で2chﾌﾞﾗｳｻﾞをつけてくれい。 <>
デフォルトの名無しさん<>sage<>02/08/28 03:32<> gccとqtかgtk+を移植すればGeckoコンポ使ったブラウザが簡単に作れるカモ <>
デフォルトの名無しさん<>sage<>02/08/28 06:02<> ま, そういう話しは別スレで. <>
デフォルトの名無しさん<><>02/08/29 20:54<> ﾒﾝﾃ <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/30 22:51<> <a href="../test/read.cgi/tech/1027080631/498" target="_blank">&gt;&gt;498</a> <br> を参考にbuiltin_new,deleteも追加しました。 <br> http://ime.nu/www.mega-tokyo.com/os/os-faq-cpp.html#start <br>  <br> ところで <br>  __builtin_vec_new  <br> って引数･戻り値ってどこで調べれば分かるでしょうか。 <br> googleで調べたら、変なバイナリばかり引っかかってしまいます。 <>
487<><>02/08/31 06:05<> まじ、すっかり忘れてた。 <br> しかし、-S で出力したファイルの拡張子が .o ってのはあまりに以外であったが、 <br> Unix 方面では一般的なのか？ 必死に .s .src .asm を探し回ったよ。 <br>  <br> で、アセンブリリストを見てみたわけだが、特に問題はない。 <br> おそらく、オブジェクトファイルの段階では問題ないのだろう。 <br> すると、リンク時のアドレス解決時の問題ということになる。 <br> 俺に思いつく可能性は、 <br> １）リンカスクリプトのミス <br> ２）ld のバグ（ホントかよ！） <br> だが、考えにくい・・・。 <br> マップファイルが欲しい・・・。他にもズレてるシンポルがあるだろうから、 <br> そこから原因が推測できるかも知れんし・・・。 <br>  <br>  <br> ま、今日のところは何も分からないことが分かったというところか。 <br>  <br> ところで、intelのサイトの資料は読んでる？ <br> 日本語でもまあまあ色々あるし、英語ならそれなりに面白いのもある。 <br> 資料不足なら逝ってみるのもいいんじゃない？ <br>  <br> あと、ちょと前に出てた crt0 だけど、djgpp のソースから持ってきたんなら、 <br> どっかに crt0.s （アセンブリソース）があるから見てみたらいいんじゃない <br> かな。 <br> 俺が見たことあるのは、拍子抜けするくらい単純なヤツだけど。 <br> ま、ある意味、組み込み系の仕事だし、当然なんだけど。 <br>  <br> # あの Makefile は多少切ない・・・ <br>  <>
487<><>02/08/31 06:07<> 長くて申し訳ないが、本日の成果 <br>  <br> 000000E1  E88A090000        call 0xa70=__ZN3Sub8instanceEv; Sub::instance() <br> 000000E6  8945FC            mov [ebp-0x4],eax <br> 000000E9  83EC0C            sub esp,byte +0xc <br> 000000EC  8B45FC            mov eax,[ebp-0x4] <br> 000000EF  8B00              mov eax,[eax] <br> 000000F1  FF75FC            push dword [ebp-0x4] <br> 000000F4  8B00              mov eax,[eax] <br> 000000F6  FFD0              call eax; -&gt;getNumber() ? <br> 000000F8  83C404            add esp,byte +0x4 <br> 000000FB  50                push eax <br> 000000FC  E827010000        call 0x228=__Z14_sysPrintlnInti; _sysPrintlnInt() <br>  <br> call__ZN3Sub8instanceEv <br> movl%eax, -4(%ebp) <br> subl$12, %esp <br> movl-4(%ebp), %eax <br> movl(%eax), %eax <br> pushl-4(%ebp) <br> movl(%eax), %eax <br> call*%eax <br> addl$4, %esp <br> pushl%eax <br> call__Z14_sysPrintlnInti <br>  <br>  <br>     _sysPrintln(getName()); <br> 0000012F  83EC0C            sub esp,byte +0xc <br> 00000132  83EC04            sub esp,byte +0x4 <br> 00000135  E844070000        call 0x87e=__Z7getNamev; getName() <br>  <>
487<><>02/08/31 06:07<> __Z9getNumberv: <br> pushl%ebp <br> movl%esp, %ebp <br> subl$8, %esp <br> call__ZN3Sub8instanceEv <br>  <br> 0000085C  55                push ebp <br> 0000085D  89E5              mov ebp,esp <br> 0000085F  83EC08            sub esp,byte +0x8 <br> 00000862  E8E9010000        call 0xa50 <br>  <br>  <br> __Z7getNamev: <br> pushl%ebp <br> movl%esp, %ebp <br> subl$8, %esp <br> call__ZN3Sub8instanceEv <br>  <br> 0000087E  55                push ebp <br> 0000087F  89E5              mov ebp,esp <br> 00000881  83EC08            sub esp,byte +0x8 <br> 00000884  E8C7010000        call 0xa50=__ZN3Sub8instanceEv <br>  <br>  <br> __ZN3Sub8instanceEv: <br> pushl%ebp <br> movl%esp, %ebp <br> subl$8, %esp <br>  <br> __ZN3Sub8instanceEv: <br> 00000A70  55                push ebp <br> 00000A71  89E5              mov ebp,esp <br> 00000A73  83EC08            sub esp,byte +0x8 <br>  <>
487<><>02/08/31 06:11<> <a href="../test/read.cgi/tech/1027080631/507" target="_blank">&gt;&gt;507</a> <br> __builtin_vec_new prototype <br> でググったら普通にでてきたぞ。 <br> どんぐらい普遍的なのかは知らんけど。 <br>  <br> void* __builtin_new(size_t sz) <br> { <br>  return kmalloc(sz, GFP_KERNEL); <br> } <br>  <br> void* __builtin_vec_new(size_t sz) <br> { <br>  return __builtin_new (sz); <br> } <br>  <br> void __builtin_delete(void* ptr) <br> { <br> // if (ptr) //kfree checks against NULL pointer <br>   kfree(ptr); <br> } <br>  <br> void __builtin_vec_delete(void* ptr) <br> { <br>  __builtin_delete (ptr); <br> } <br>  <>
鬱<>sage<>02/08/31 10:00<> よーし、Higepon OSができたらパパなんか手伝っちゃうぞ〜。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/31 12:19<> <a href="../test/read.cgi/tech/1027080631/487" target="_blank">&gt;&gt;487</a>さん <br> ありがとうございます。 <br> &gt;まじ、すっかり忘れてた。 <br> &gt;しかし、-S で出力したファイルの拡張子が .o ってのはあまりに以外であったが、 <br> &gt;Unix 方面では一般的なのか？ 必死に .s .src .asm を探し回ったよ。 <br>  <br> いや私がサボったため起きた現象です。-o *.oにしてたの忘れてしました。 <br>  <br> &gt;１）リンカスクリプトのミス <br> &gt;２）ld のバグ（ホントかよ！） <br> &gt;だが、考えにくい・・・。 <br> なるほどオブジェクトファイルの時点では問題ないということですね。 <br>  <br> &gt;ところで、intelのサイトの資料は読んでる？ <br> &gt;日本語でもまあまあ色々あるし、英語ならそれなりに面白いのもある。 <br> &gt;資料不足なら逝ってみるのもいいんじゃない？ <br> そうですね。存在は知っているのですが、なかなか読まないですね。 <br> 読んでみようと思います。 <br>  <br> &gt;# あの Makefile は多少切ない・ <br> どの辺が切ないのでしょうか。確かに我流だし、汎用性0ですね。 <br> せめてunixのかたがたもすぐ使えるようにしたほうがいいのかも。 <br>  <br>  <br>  <br>  <br>  <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/31 12:29<> <a href="../test/read.cgi/tech/1027080631/511" target="_blank">&gt;&gt;511</a> <br> builtin_vec_newもサイズだけ受け取ればよいんですね。 <br> ありがとうございます。 <br> 配列用なので配列のサイズも必要なのかと思っていたのですが･･･ <br>  <br> <a href="../test/read.cgi/tech/1027080631/487" target="_blank">&gt;&gt;487</a>さん <br> これからも、アドバイスいただけたらうれしいです。 <br> OSを作ったことのある人の経験は大変貴重です。 <br>  <br>  <>
ひげぽん </b>◆zcp/NZpA <b><><>02/08/31 19:42<> 仕事もひと段落 <br> やる気復活してきました。 <br>  <br> Vectorがあるといろいろ便利なのだが・・・ <>
FreeDOS教徒<>osage<>02/09/01 21:24<> 最近やっと資料を読んでから作業したほうが効率的だと気付きました。 <br> 理解しきれてないと、どうしてもどこかで行き詰まるもんです。 <br>  <br> 地味な作業みたいですが、地道にがんばってください。応援してます。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/09/01 21:34<> <a href="../test/read.cgi/tech/1027080631/516" target="_blank">&gt;&gt;516</a>さん  <br>  そうですね。資料を読んで勉強して、それからですよね。  <br>  どうも行き当たりばったりで、行き詰ってたりします。 <>
ろうひ男爵<><>02/09/04 12:27<> ひげぽんさんがんばってますね〜。 <br> 自分もアセンブラでですが作っています〜。 <br> コンソールまで出来て、コマンド起動まで出来ました〜。 <br> 以前、DOSもどき+XMSの物は作ったことがあったので、 <br> ここまではすんなりいきました。 <br> 次はint21hのエミュレーションです〜。 <>
ただの通行人Ｇ<><>02/09/04 14:53<> <a href="../test/read.cgi/tech/1027080631/502" target="_blank">&gt;&gt;502</a>  <br>  &gt;宝くじが当たったら、仕事やめて開発に専念します（笑）  <br>  そんなに、Pentiumでオナニーしたいのか？  <br>  用途不明のＯＳ作りとは（笑） <>
デフォルトの名無しさん<><>02/09/04 16:26<> まあ386でオナったらLinuxができるんだから <br> IComp比の分いいものができる・・・かもな <>
デフォルトの名無しさん<>sage<>02/09/04 16:27<> みんなでワッショイ <br> それひけオーエス <>
ただの通行人Ｇ<><>02/09/04 18:42<> 確かに、386でオナったらLinuxができた。 <br> でもそれは１０年前の話、今それをやって何を作ろうとしているのか？ <br> そこが疑問なんですよ <>
デフォルトの名無しさん<>sage<>02/09/04 18:45<> <a href="../test/read.cgi/tech/1027080631/522" target="_blank">&gt;&gt;522</a> <br> 作ることが楽しいっていうのはないですか？ <br> just for fan。これは何年経っても変わらないと思われ。 <>
デフォルトの名無しさん<>sage<>02/09/04 18:47<> 実用性は後付けでいいじゃん. 自分の力でどこまでできるか, 何ができるか. <br> プログラマはクリエイティブな仕事. 何らかの形にしたいと思った中でOSっていう <br> 選択肢があるのも悪くない…と俺は思うぞ. <br>  <>
デフォルトの名無しさん<>sage<>02/09/04 18:53<> <a href="../test/read.cgi/tech/1027080631/522" target="_blank">&gt;&gt;522</a> <br> それは、 <br> 「いまさら富士山に登って何の意味があるの？」 <br> と聞いてるのと同じだと思うが。 <>
ただの通行人Ｇ<><>02/09/04 19:27<> 今、ＯＳを作る理由が作るのが楽しいから <br> これを否定するつもりはありません。 <br> 疑問に思うのは、2002年に開発を始めたＯＳの目指す姿が不明な点です。 <>
デフォルトの名無しさん<>sage<>02/09/04 19:56<> ただの荒らしだね、これじゃ。 <>
デフォルトの名無しさん<>sage<>02/09/04 20:00<> 今、富士山に登る理由が作るのが楽しいから <br> これを否定するつもりはありません。 <br> 疑問に思うのは、2002年に富士山に登り始めた登山者の目指す姿が不明な点です。 <>
デフォルトの名無しさん<>sage<>02/09/04 20:22<> <a href="../test/read.cgi/tech/1027080631/526" target="_blank">&gt;&gt;526</a> <br> おれも趣味でごにょごにょやってるわけだが、正直、どんなのを作ろう <br> かってのはわかんないけどな。OSの専門家じゃないし、理想の OSを作ろ <br> うという目標があるわけでもない。作っていくうちにいろいろわかって <br> くるとは思うけどね。で、作りたい OSがわかってくればそこでもう一度 <br> 作り直せばいいし。 <br>  <br> 今はどんなものが作りたいのか模索している段階だね。 <br> プログラムで言えば、とりあえずHello, World作って、いろんなアルゴリ <br> ズムとか勉強してる段階。 <br>  <br> ひげぽんの考えは知らないけど。 <>
ただの通行人Ｇ<><>02/09/04 20:22<> 疑問に対する答えはなしか、その程度だな。 <>
デフォルトの名無しさん<>sage<>02/09/04 20:25<> 批判しかできない通りすがりははやく消えてほしいなぁ。 <br>  <br> 〜〜〜〜〜〜〜〜〜〜〜〜◯〜〜〜〜〜〜〜〜〜〜〜〜〜〜〜〜〜  <br> 　　　　　　　　　　　　　　　　　Ο  <br> 　　　　　　　　　　　　　　　　　ｏ  <br> 　　　　　　　　　　　　　 ___＿＿＿＿＿＿＿___  <br> 　　　　　　　　　　 　 ／　　∧＿∧ 　　　　　　 )  <br> 　　　　　　　 　 　 ／　(￣（´Д｀ ; ）￣０　　 ／  <br> 　　　　　　　　　/~￣￣￣⌒⌒⌒⌒￣￣￣)  <br> 　 　 　 　 　 ／　※※※※※※※※　　／  <br> 　 　 　 　 ／　※※※※※※※※　　／  <br> 　　　　 ／　※※※※※※※※　　 /  <br> 　　　　(＿＿＿＿＿＿＿＿＿_＿_ノ  <>
デフォルトの名無しさん<>sage<>02/09/04 20:26<> そこまで話が言ってないのをログから読めないとは <br> 読解力に致命的な問題があるのでは？ <>
デフォルトの名無しさん<>sage<>02/09/04 21:42<> だから荒らしは無視しなよ。 <br> こんな奴に使って欲しいなんて思って作ってる人はいないんだから。 <>
ろうひ男爵<><>02/09/05 01:28<> 自分は、第一弾として、DOS-EXTENDER程度のOSを作ろうと思ってますよ。 <br> 目的としては学習用です。 <br> 第二弾、第三弾を作るときには目的は変わるかもしれませんが。 <>
デフォルトの名無しさん<>sage<>02/09/05 01:51<> <a href="../test/read.cgi/tech/1027080631/534" target="_blank">&gt;&gt;534</a> <br> 釣り師か? <br> DOSEXTENDERはOSじゃないぞ. <>
ろうひ男爵<><>02/09/05 02:26<> <a href="../test/read.cgi/tech/1027080631/535" target="_blank">&gt;&gt;535</a> <br> ちとことばか足りなかったのですが、 <br> INT21の拡張って意味です。 <br> ところで、使用側から見ると、 <br> win3.1と同じでextenderもosと見なして良いのでは? <>
ろうひ男爵<><>02/09/05 02:33<> また言葉が足りなかったので、つっこまれる前に。 <br> int21hの拡張とは、32bit化への拡張です。 <br> run386のファンクション程度を実装できたらと思っています。 <br> 機能的に、dos+extenderの機能を実装した簡易OSを作ろうと思っています。 <br> dpmi機能よりは使用側がシームレスに使えると思っています。 <br>  <br> 次には、オリジナルの言語を作ろうと思っています。 <br> c言語のプリプロセッサ機能＋アセンブラのマクロ機能、 <br> ここまでがプリプロセッサで実装しました。 <br> その後、BASIC+PASCALの構造化言語を作っていますが、 <br> プリプロセッサの実装までで力尽きました。 <br> BASICインタープリターなら作ったことがあるので簡単ですが、 <br> 386コードへの変換が難しそう。 <br>  <>
ろうひ男爵<><>02/09/05 02:35<> 長々とスレ違いごみんね。 <br>  <br> ところで、ひげぽんさんはDISKアクセスにはBIOSのリアルモードへ戻しますか? <br> あと、それとも関係しますが第一弾からマルチタスクにしますか? <>
ただの通行人Ｇ<><>02/09/05 07:14<> 528,531,532 <br> 答えられないなら黙ってろ <>
デフォルトの名無しさん<><>02/09/05 07:49<> 荒れてるね、(￣ー￣)ﾆﾔﾘｯ <br> 当然と言えば当然だけどね。 <br>  <br> ひげぽんも前半ははじめての４８６レベルの話が多かったし、 <br> 今も資料をあさればイイ話が多いからね。 <br> そんなレベルなのに色々大きいこと言ってるからただの通行人Ｇに <br> かみつかれたんじゃない？ <br>  <br> オレは理由は必要ないんじゃないって思ってるけど、 <br> ひげぽんの甘え具合見てるとただの通行人Ｇの何のためにやってるのって気持ちも分かるよ。 <br>  <br> でも、こには超先生や487やろうひ男爵みたいに優しい奴らが多いから、 <br> ただの通行人Ｇは口を出さずに無視してれば良いんじゃない？ <br>  <br> ひげぽんは今までみたいにマターリやって、 <br> 作れても失敗してもイイから作るってなかなか出来ないけど、 <br> ここの雰囲気は凄くイイから、 <br> 見ててムカつくのも分かるけど黙って無視してれば＞Ｇ <>
540<><>02/09/05 07:56<> <a href="../test/read.cgi/tech/1027080631/522" target="_blank">&gt;&gt;522</a> <br> 勝手にやってればって無視してあげてよ。 <br> でも、オナニーって言い方は言い得て妙だけど、 <br> いちいち理由をつけてソフトを作ってる奴ってそんなにいないと思うよ。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/535" target="_blank">&gt;&gt;535</a> <br> いんや、Extenderはosの一部かもしくは微妙な部分だろ？ <br> そんなのにいちいち反応するおまえが釣り師。 <br> 言葉尻に反応するのやめれ。 <>
デフォルトの名無しさん<>sage<>02/09/06 01:29<> 単純でもいいからOSを作る事が目的なんじゃないの？ <br>  <br> 富士山に登るのも、まずは登り始めなければ始まらないし。 <br> 登り始めた登山者は最終的に富士山に登るのが目的。 <br>  <br> ひげぽんが最終的にどんなOSのイメージを持っているかは <br> 本人に聞かないと分からないが。。 <br>  <br> まぁ、面白いｽﾚだからﾏﾀｰﾘしましょう。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/09/06 01:52<> お休みをとって、旅行に行っていました。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/518" target="_blank">&gt;&gt;518</a> ろうひ男爵さん <br> &gt;自分もアセンブラでですが作っています〜。 <br> &gt;コンソールまで出来て、コマンド起動まで出来ました〜。 <br> すごいですね。 <br> 自分の勉強・力不足を感じます。 <br>  <br>  <br> &gt;ところで、ひげぽんさんはDISKアクセスにはBIOSのリアルモードへ戻しますか? <br> えーと私がソースをある程度読んだあるOSはリアルモードへ移行していました。 <br> 一応それを参考にしようかと思っています。 <br>  <br> &gt;あと、それとも関係しますが第一弾からマルチタスクにしますか? <br> まだ未定です。 <br> もし自分の技術的に可能であればぜひマルチタスクにしたいです。 <br> シングルタスクから入ったほうがメモリ管理等がシンプルそうなので <br> その辺の兼ね合いで考えようかと思っています。 <br>  <>
ひげぽん </b>◆zcp/NZpA <b><><>02/09/06 01:53<> <a href="../test/read.cgi/tech/1027080631/522" target="_blank">&gt;&gt;522</a> ただの通行人Ｇ <br> &gt;そんなに、Pentiumでオナニーしたいのか？ <br> &gt;用途不明のＯＳ作りとは（笑） <br> &gt;今、ＯＳを作る理由が作るのが楽しいから <br> &gt;これを否定するつもりはありません。 <br> &gt;疑問に思うのは、2002年に開発を始めたＯＳの目指す姿が不明な点です。 <br> &gt;疑問に対する答えはなしか、その程度だな。 <br> まずはお返事が遅れてしまって申し訳ありません。 <br> OSを作ってみたい、作る過程が楽しそうだというのが <br> プロトタイプOSの開発開始の動機のひとつです。 <br> そのため、明確なビジョン・進もうとしている方向は <br> 私自身の中でもあいまいです。 <br> そろそろそういったことを意識しなくてはいけないのかもしれませんね。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/529" target="_blank">&gt;&gt;529</a>さん <br> &gt;OSの専門家じゃないし、理想の OSを作ろ <br> &gt;うという目標があるわけでもない。作っていくうちにいろいろわかって <br> &gt;くるとは思うけどね。で、作りたい OSがわかってくればそこでもう一度 <br> &gt;作り直せばいいし。 <br> 私もそんな感じです。すでに作り直したい・こうすればよかったという箇所があります。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/540" target="_blank">&gt;&gt;540</a> <br> &gt;今も資料をあさればイイ話が多いからね。 <br> &gt;そんなレベルなのに色々大きいこと言ってるからただの通行人Ｇに <br> &gt;かみつかれたんじゃない？ <br> 大きい事言ってますよね。 <br> 以後なるべく気をつけます。 <br>  <br> 今まで通りマターリとやらせていただきます。 <br> よろしくおねがいします。 <>
デフォルトの名無しさん<>sage<>02/09/06 02:09<> &gt;大きい事言ってますよね。 <br> これも含めてひげぽんなので、今までのままでｲｲ!!と思うよ。 <br>  <>
デフォルトの名無しさん<>sage<>02/09/06 04:09<> いいと思うよ。何でも最初は叩かれ煽られる。 <br> 案外、先でひげぽんのOSが世の中に広まるかもしれない。 <br>  <>
ただの通行人Ｇ<><>02/09/06 07:31<> <a href="../test/read.cgi/tech/1027080631/540" target="_blank">&gt;&gt;540</a> <br> これからは黙っていることにするよ。 <br> ろうひ男爵のDOS-EXTENDER程度のOSは、わかりやすい言い方だと思う。 <br> これぐらいの答えを期待していただけだし。 <br>  <>
あぼーん<>あぼーん<>あぼーん<>あぼーん<>あぼーん
ひげぽん </b>◆zcp/NZpA <b><><>02/09/08 15:17<> メモリ管理をゆっくりと実装中です。  <br>  簡易的なものですが、なかなか難しいですね。 <>
LightCone<>sage<>02/09/08 17:10<> <a href="../test/read.cgi/tech/1027080631/549" target="_blank">&gt;&gt;549</a>  <br>  　アプリプログラムの経験があっても、メモリ管理は普段やらないこと  <br>  ですからね。  <br>    <br>  　物理メモリの利用マップを管理するだけでも、なかなか難しいはず  <br>  です。最初、管理用のワークエリアを取る場所さえも自分で探す  <br>  必要がありますし。  <br>    <br>  　物理メモリマップの壁をクリアしても、論理的なメモリ管理用の  <br>  管理領域自体を動的に伸張していくことも以外に難しいと  <br>  思います。  <br>    <br>  　ページ単位でメモリを用意するためには、メモリブロックのヘッダ  <br>  を、メモリブロックの先頭にくっつける方法は取れないので、  <br>  別領域にまとめておかないといけなかったり。  <br>    <br>    <br>    <br>  　ページテーブルへアクセスするために、自己参照的なページ  <br>  エントリを作っておかないといけなかったり、システム共通領域  <br>  に対するエントリは、全てのタスクのページテーブルに書き換えを  <br>  反映させないといけなかったり。  <br>    <br>    <br>  　頑張ってください。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/09/08 17:47<> <a href="../test/read.cgi/tech/1027080631/550" target="_blank">&gt;&gt;550</a> LightConeさん  <br> どうもお久しぶりです。  <br>  <br> &gt;アプリプログラムの経験があっても、メモリ管理は普段やらないことですからね。  <br> そうですね。メモリ管理の勉強をしていて連想したのは、  <br> HDDの断片化(デフラグしますよね) やデータベースのブロックでした。  <br>  <br> &gt;物理メモリの利用マップを管理するだけでも、なかなか難しいはず  <br> &gt;です。最初、管理用のワークエリアを取る場所さえも自分で探す必要がありますし。  <br> 最初、この部分で混乱しました。  <br> 空き領域をあらわすようなクラスを最初考えていたのですが、  <br> そのクラスはどうやって自分自身のメモリを確保するんだろう?  <br> newしたら無限ループに入るって事に途中で気づきました（笑）  <br> 実装前に気づいてよかったです。  <br> 結局、今回はあまり欲張りすぎず連結リストを用いた  <br> メモリ管理をすることにしました。  <br>  <br> 上記実装が落ち着いてきて、他の部分も成熟してきたら  <br> ページング等にも挑戦しようと思っています。  <br>  <br> &gt;ページテーブルへアクセスするために、自己参照的なページ  <br> &gt;エントリを作っておかないといけなかったり、システム共通領域  <br> &gt;に対するエントリは、全てのタスクのページテーブルに書き換えを  <br> &gt;反映させないといけなかったり。  <br> &gt;頑張ってください  <br> ありがとうございます。  <br>  <br> メモリ管理を実装中に、debugのために printfがほしくなったので  <br> 簡易版printfを実装中です。  <br> ちょっと横道にそれてきました。  <>
デフォルトの名無しさん<>sage<>02/09/08 17:57<> <a href="../test/read.cgi/tech/1027080631/551" target="_blank">&gt;&gt;551</a> <br> printf…でなくてassertとかではダメかい？ <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/09/08 18:01<> <a href="../test/read.cgi/tech/1027080631/552" target="_blank">&gt;&gt;552</a> <br> assertって自分で実装する必要ないのでしょうか。 <>
552<>sage<>02/09/08 18:07<> いや、printf実装するよりも簡単に使えるassertの方を先に実装したら？と思ったんだ。 <br> でもデータのdumpとるのならprintfの方がいいかもね。 <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/09/08 18:12<> <a href="../test/read.cgi/tech/1027080631/552" target="_blank">&gt;&gt;552</a>さん <br> 簡易版printfができたら、assertは簡単に実装できると思うので <br> ご意見採用させていただきます。 <br>  <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/09/08 19:09<> 簡易版printfがやっと出来ました。 <br> %s,%dしか使えませんが、かなり便利です。 <br> もっと最初から作っておけばよかった・・・ <>
デフォルトの名無しさん<>sage<>02/09/08 20:25<> OSを一から作ろうとする情熱がすごいと思う。 <br> 俺はそこまでできない。 <br>  <>
デフォルトの名無しさん<><>02/09/08 22:39<> このスレとは <br>  <br> ひげぽんに取って：たんにＯＳを作るうえでの技術相談所 <br>  <br> 厨房に取って：ひげぽんが何か大きなプロジェクトを立てようとしている <br> 俺のが偉いんだ阻止するぞ阻止するぞ阻止するぞ阻止するぞ <>
</b> ◆k/Ubp.Kg <b><>sage<>02/09/08 22:44<> <a href="../test/read.cgi/tech/1027080631/558" target="_blank">&gt;&gt;558</a> <br> ﾜﾗﾀ。本当にそういう奴(厨房)いるからねぇ。 <br>  <br> 俺にとっては何やろうね。実はひそかにpart1から読んでたりするんだけど(藁。 <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/09/08 22:52<> <a href="../test/read.cgi/tech/1027080631/558" target="_blank">&gt;&gt;558</a> <br> モチベーション維持にも活用させていただいております。 <br> OSを作っている他の方々との交流もできたらよいなあ。 <>
</b> ◆k/Ubp.Kg <b><>sage<>02/09/08 22:53<> っていうか、このスレの常連さんでOffとかやったら楽しいのではないだろうか、と言ってみるテスト。 <>
デフォルトの名無しさん<>sage<>02/09/08 23:18<> <a href="../test/read.cgi/tech/1027080631/556" target="_blank">&gt;&gt;556</a> <br> 細かいことだけど、_sys_printf("xxx%"); とかやられると、ちょっとうれしく <br> ないことが起こる。また、現状の版では "%" を出力したい時は <br> _sys_printf("%s", "%"); とやるしかないので... <br>  <br> 　for (int i = 0; format[i] != '\0'; i++) { <br> 　　if (format[i] == '%') { <br> 　　　i++; <br> 　　　switch (format[i]) { <br> 　　　case 's': <br> 　　　　_sysPrint((char *)*list); <br> 　　　　((char**)list) += 1; <br> 　　　　break; <br> 　　　case 'd': <br> 　　　　_sysPrintInt((int)*list); <br> 　　　　((int*)list) += 1; <br> 　　　　break; <br> &gt; 　　case '%': <br> &gt; 　　　_sysPutCharacter('%'); <br> &gt; 　　　break; <br> &gt; 　　case '\0': <br> &gt; 　　　i--; <br> &gt; 　　　break; <br> 　　} <br> 　} else { <br> 　　_sysPutCharcter(format[i]); <br> 　} <br> } <br>  <br> とかすれば、どうでしょうか ? <>
ひげぽん </b>◆zcp/NZpA <b><><>02/09/08 23:52<> <a href="../test/read.cgi/tech/1027080631/561" target="_blank">&gt;&gt;561</a>さん <br> どうなんでしょうか？ <br> コテハンの人以外にどのくらいの人数の方がいるんでしょう。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/562" target="_blank">&gt;&gt;562</a>さん <br> 採用させていただきます。ありがとうございます。 <br> ついでにtypoを直しました。charcterって・・・(鬱) <br> ソースを見てくれている人がいるんですね。 <br> ちょっとびっくりしました。 <br>  <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/09/09 00:22<> 起動画面にちょっとお遊びを入れてみました。 <br> ただいま逃避中。 <>
age<><>02/09/09 21:36<> age <>
デフォルトの名無しさん<>sage<>02/09/10 14:51<> みんなフロッピーブートセクタに書き込むには何を使ってるんでしょう。 <br> win2000系では何があるんでしょうか。 <br> rawriteではエラー、dksimgも何故かダメ。 <br> 質問だけでスンマソン。 <>
デフォルトの名無しさん<>sage<>02/09/10 16:36<> 俺はWriteFileする自作の奴 <br>  <>
ろうひ男爵<><>02/09/10 21:54<> <a href="../test/read.cgi/tech/1027080631/566" target="_blank">&gt;&gt;566</a> <br> 自分はwin98seなのでint13hです。 <br> 以下の感じ。 <br>  <br> ; ipl の書き込み <br> movax,0301h; ah=03h,al=書き込みsec数 <br> movcx,0001h; ch=シリンダ番号,cl=セクタ番号 <br> xordx,dx; dh=ヘッド番号,dl=ドライブ番号 <br> movbx,seg ipl_top; es:bx=書き込み先頭アドレス <br> moves,bx <br> movbx,offset ipl_top <br> int13h <br>  <>
556<>sage<>02/09/11 01:57<> <a href="../test/read.cgi/tech/1027080631/568" target="_blank">&gt;&gt;568</a> <br> 目からうろこが・・。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/567" target="_blank">&gt;&gt;567</a>,568 <br> ありがとうございます！ <>
ろうひ男爵<><>02/09/11 02:55<> <a href="../test/read.cgi/tech/1027080631/569" target="_blank">&gt;&gt;569</a> <br> たいしたものではないんですが、 <br> アセンブラでよければIPLのプログラムをupしませうか? <br> tasmとtlinkでコンパイル出来る奴で、多分masmでもokだとおいます。 <>
デフォルトの名無しさん<>sage<>02/09/11 03:13<> IPLのプログラムじゃなくて、ディスクライターがほしいんじゃないのか <>
ろうひ男爵<><>02/09/11 03:18<> <a href="../test/read.cgi/tech/1027080631/571" target="_blank">&gt;&gt;571</a> <br> あ、ごめん。 <br> 自分は一本のプログラムに、IPL自体とIPLの書き込みルーチンをまとめてるので、 <br> そういう意味でサンプルになるかなって思って書きました。 <>
デフォルトの名無しさん<><>02/09/11 08:17<> <a href="../test/read.cgi/tech/1027080631/572" target="_blank">&gt;&gt;572</a> <br> 上げてほしいっす <>
ろうひ男爵<><>02/09/12 11:47<> http://ime.nu/www.42ch.net/UploaderSmall/source/1031798613.lzh  <br> iplプログラムです。 <br> ご自分のお作りになった、2nd ipl 以降を読み込むための物です。 <br>  <br> &gt;ipl1.exe 1000 1000:0000 2 1 <br> で、iplにプログラムを書き込みます。 <br> この例の場合、iplはブートアップの後、セクタ2から1セクタ分seg1000へ読み込みます。 <br> そして、seg1000:offset0000へジャンプします。 <br>  <br> dosフォーマット済みのブランクfdをドライブに入れて、 <br> window95/98/meなどのコマンドプロンプトで <br> &gt;ipl1.exe 1000 1000:0000 2 1[ret] <br> と入力して下さい。 <br> その後、マシンをリブートしてfdから起動させて下さい。 <br> 起動したら、メッセージが表示されます。 <br>  <br> サンプルとして、2nd ipl のサンプルの ipl2.exe をつけますので、 <br> 先ほどのfdをドライブに入れれて、 <br> window95/98/meなどのコマンドプロンプトで <br> &gt;ipl2.exe[ret] <br> と実行して下さい。 <br> なお、dosフォーマットのdiskはipl2.exeを実行したとたんデーターが壊れます。 <br> その後、マシンをリブートしてfdから起動させて下さい。 <br> 起動したら、メッセージが表示されますが、 <br> 今度は"2ndIPL BOOT OK"というメッセージも表示されます <br>  <br>  <>
ろうひ男爵<><>02/09/12 13:32<> <a href="../test/read.cgi/tech/1027080631/574" target="_blank">&gt;&gt;574</a> <br> と思ったら、削除されてました。トホホ <br> どっかにプログラムをupするイイ所ってないっすか? <>
デフォルトの名無しさん<>sage<>02/09/12 13:37<> ddでいいじゃん。あ、Windowsか。。。 <br> Windowsはそういうのに不向きだと思うけどなあ。 <>
デフォルトの名無しさん<>sage<>02/09/12 13:58<> 最近のWindowsにはdebugコマンド標準で付いてくるんだけどなぁ。。。 <br>  <>
デフォルトの名無しさん<>sage<>02/09/12 14:27<> <a href="../test/read.cgi/tech/1027080631/575" target="_blank">&gt;&gt;575</a>  <br>  http://www36.tok2.com/home/tok/cgi-bin/upboard/upboard.cgi <>
ろうひ男爵<><>02/09/12 14:57<> ういっす、再度upします。 <br> http://www36.tok2.com/home/tok/cgi-bin/upboard/updir/ipl.lzh <br> iplプログラムです。 <>
デフォルトの名無しさん<>sage<>02/09/12 15:05<> win2000ならMINIX用のfdvol.exe 使え。 <br> http://www.cs.vu.nl/pub/minix/dosutil/fdvol.exe <br> fdvol 1440 A: boot1st.bin <br> みたいに。 <>
デフォルトの名無しさん<>sage<>02/09/12 16:37<> と、C++の継承がどうの辺りからぶりに来てみたけど。 <br> 停滞中？ <br>  <>
ひげぽん </b>◆zcp/NZpA <b><><>02/09/12 22:23<> <a href="../test/read.cgi/tech/1027080631/581" target="_blank">&gt;&gt;581</a>  <br>  継承問題は棚上げにして  <br>  メモリ管理クラスの実装に入りました。  <br>  現在デバッグ中なのでここにあまり書き込む情報(質問???)がありません。  <br>    <br>  フロッピィへの書き込みは、サブマシンのlinuxのddを使ってます。  <br>  もっとも最近はbochsでしかテストしてませんです。  <br>  <a href="../test/read.cgi/tech/1027080631/580" target="_blank">&gt;&gt;580</a>みたいなのもあるんですね。  <br>   <>
ろうひ男爵<><>02/09/12 22:59<> &gt;&gt;ひげぽんさん <br> メモリ管理ですが、連結リストってことは <br> DOSみたいなメモリブロック構造ってことですよね。 <br> メモリーブロックの前に、管理ヘッダーを置くって形ですね。 <br> 出来上がったら、結構前進しますね。がんばって下さいね。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/09/12 23:08<> <a href="../test/read.cgi/tech/1027080631/583" target="_blank">&gt;&gt;583</a> ろうひ男爵さん  <br>  &gt;メモリ管理ですが、連結リストってことは  <br>  &gt;DOSみたいなメモリブロック構造ってことですよね。  <br>  &gt;メモリーブロックの前に、管理ヘッダーを置くって形ですね。  <br>  DOSのメモリブロックはちょっと知らないのですが、  <br>  そんな感じです。  <br>    <br>  &gt;出来上がったら、結構前進しますね。がんばって下さいね。  <br>  ありがとうございます。  <br>  余裕があったら他のメモリ管理の方法も試したいなとは  <br>  思っているのですが、当分は無理でしょうね。。。  <br>   <>
デフォルトの名無しさん<>sage<>02/09/12 23:42<> ひげぽん仕事は大丈夫？ <>
デフォルトの名無しさん<>sage<>02/09/12 23:48<> 連結リストってカーネル内の管理方法だろ？ <br> ページング使うんだから、タスクからはリニアに見えるんじゃないの？ <br> もしかして、マジでMCBと同じにするつもり？ <>
ひげぽん </b>◆zcp/NZpA <b><><>02/09/12 23:57<> <a href="../test/read.cgi/tech/1027080631/585" target="_blank">&gt;&gt;585</a>さん <br> &gt;ひげぽん仕事は大丈夫？ <br> ちょっと忙しいですが、忙しいほうが <br> なぜか家に帰ってから30分でも集中してhigeposに時間をまわして <br> 結果的には、開発状況は自分的には、アクティブです。 <br>  <br> &gt;連結リストってカーネル内の管理方法だろ？ <br> そのとおりです。 <br>  <br> &gt;ページング使うんだから、タスクからはリニアに見えるんじゃないの？ <br> &gt;もしかして、マジでMCBと同じにするつもり？ <br> いえいえ全然そんな意図はありません。 <br> MCBというものも知りませんでしたし(それはそれで問題ですが) <br> 例のMINIX本と、他のOSのソースを見て <br> とりあえず連結リストによるメモリ管理の実装を試みている状況です。 <br>  <br> &gt;&gt;Memory Control Block（MCB）　メモリー制御ブロック <br> &gt;&gt;DOS が管理するメモリーブロックの先頭に置かれた管理情報領域。 <br>  <>
デフォルトの名無しさん<>sage<>02/09/13 00:17<> <a href="../test/read.cgi/tech/1027080631/587" target="_blank">&gt;&gt;587</a> <br> そうだよな、583を見ておいおいって思ったので。 <>
デフォルトの名無しさん<>sage<>02/09/13 22:43<> &gt;582 <br> そか。じゃしばらくしたらまた来てみよう。 <br>  <>
デフォルトの名無しさん<>sage<>02/09/14 12:35<> しかしこのスレッド、ム板でよかったよね。  <br>  ＯＳ板はＫとＬの対決で荒れてる荒れてる。  <br>   <>
896<><>02/09/14 18:44<> 　 <>
デフォルトの名無しさん<><>02/09/18 00:57<> ゲーム製作に特化したOSを造ろうというスレはここですか？ <>
デフォルトの名無しさん<>sage<>02/09/18 02:54<> 作れば？ <>
ひげぽん </b>◆zcp/NZpA <b><><>02/09/18 23:12<> カーネル内メモリ管理が大体まとまってきました。  <br>    <br>  メモリ開放時の隣り合う空き領域の連結処理が実装できていませんが  <br>  一応順調に進んでおります。  <br>  最近仕事がまた忙しいのでちょっと進みが遅いですが、  <br>  何とかやっております。 <>
デフォルトの名無しさん<><>02/09/20 11:53<> がんば！ <>
ひげぽん ◇zcp/NZpA<><>02/09/20 13:08<> FreeのPC UNIXからソースコード盗んでるだけですけどね。 <>
デフォルトの名無しさん<>sage<>02/09/20 20:10<> 隣り合う領域の連結ってファーストフィット？ <br> もしそうならＫ＆Ｒ読んできた方が・・とか。 <br>  <>
デフォルトの名無しさん<>sage<>02/09/20 20:41<> ＞隣り合う領域の連結ってファーストフィット？ <br> それは割り当てアルゴリズムだね。 <br> 隣り合う領域の連結はベストフィットでも同じ筈。 <br> K&Rのはシンプルでいいですね。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/09/21 01:08<> 偽者が･･･  <br>    <br>  <a href="../test/read.cgi/tech/1027080631/597" target="_blank">&gt;&gt;597</a>,598  <br>  &gt;隣り合う領域の連結ってファーストフィット？  <br>  &gt;もしそうならＫ＆Ｒ読んできた方が・・とか。  <br>  ええ。ファーストフィットです。  <br>  いちばんシンプルですし。タネンバウムの本で知りました。  <br>  連結処理、今週末に出来れば良いなあって感じです。  <br>    <br>    <br>   <>
ろうひ男爵<><>02/09/21 11:28<> <a href="../test/read.cgi/tech/1027080631/599" target="_blank">&gt;&gt;599</a> <br> 進んでるみたいですね〜。 <br> 自分の方は、本当にMCBライクな物を使っています。 <br> ところで、バイナリのサイズはどれくらいですか? <br> 自分はまだFDDが満タンになるにはほど遠いのですが、 <br> バイナリの圧縮をlzssでやりました。 <br> ファイルシステムをどうしようかと悩み中です。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/09/21 11:45<> <a href="../test/read.cgi/tech/1027080631/600" target="_blank">&gt;&gt;600</a> <br> &gt;ところで、バイナリのサイズはどれくらいですか? <br> 8KBくらいですね。 <br> フロッピーを満タンにするには、あと何ヶ月かかるか・・・ <br>  <br> &gt;バイナリの圧縮をlzssでやりました。 <br> 初めて聞く、キーワードですあとで調べて見ます。 <br>  <br> &gt;ファイルシステムをどうしようかと悩み中です。 <br> やはり、FAT12でしょうか。 <br>  <>
デフォルトの名無しさん<><>02/09/22 18:51<> <a href="../test/read.cgi/tech/1027080631/601" target="_blank">&gt;&gt;601</a> <br> 何言ってんの、ファイルシステムはhgpfsに決まってるでしょうが。 <br> ジャーナリングしてね（はーと） <>
名無しさん<>sage<>02/09/22 22:04<> ひげっぷage <br> ひげっぷひげっぷ <>
名無しさん<><>02/09/22 22:04<> ひげっぷ <>
ひげぽん </b>◆zcp/NZpA <b><>sage<>02/09/22 23:28<> 調べました <br> ■lzss <br> 　http://www.ingnet.or.jp/~kojif/mu/comp/lz77.htm <br> ■hgpfs <br> 見つからないと思ってたら、 <br>  <br> <a href="../test/read.cgi/tech/1027080631/603" target="_blank">&gt;&gt;603</a> <br> <a href="../test/read.cgi/tech/1027080631/604" target="_blank">&gt;&gt;604</a> <br> やっと意味が分かった（笑） <br>  <>
デフォルトの名無しさん<>sage<>02/09/22 23:32<> <a href="../test/read.cgi/tech/1027080631/605" target="_blank">&gt;&gt;605</a> <br> &gt;  ■hgpfs <br>  <br> 　HiGh Performance File System. FD 上では FAT12 互換らしい...。 <>
デフォルトの名無しさん<>sage<>02/09/22 23:57<> ちょっと苦しいな <>
デフォルトの名無しさん<>age<>02/09/23 08:36<> hgepfsとVFSどちらが先かそれが問題だ。 <br> ジャーナリングもLFSみたいな使い方ならFDに使ってもおもしろそうだ。 <>
デフォルトの名無しさん<>sage<>02/09/23 08:37<> でも今のhigeposだと1セクタ目潰してるからDPB書けないっしょ <br> FATは不可能 <>
デフォルトの名無しさん<>sage<>02/09/23 09:31<> <a href="../test/read.cgi/tech/1027080631/609" target="_blank">&gt;&gt;609</a> <br> &gt;  でも今のhigeposだと1セクタ目潰してるからDPB書けないっしょ <br> &gt;  FATは不可能 <br>  <br> 別に、JMP 命令入れてその後に DPB 書くだけだろ。そんなに難しいことじゃないと思うけど。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/09/23 18:57<> やっとカーネル内部メモリ管理(暫定版・ベータ)の実装が落ち着きました。  <br>  今のところ大体、意図どおりに動いている模様です。  <br>    <br>  次は、ファイルシステムでしょうか。  <br>  ちょっと勉強せねばと思っております。  <br>    <br>  ■ジャーナリング  <br>  http://www-6.ibm.com/jp/developerworks/linux/010928/j_l-fs.html  <br>    <br>  ところで、どなたかhigeposをmakeして試してみた事ある人って  <br>  いるんでしょうか。  <br>  さすがにまだいないですよね。 <>
デフォルトの名無しさん<><>02/09/23 22:50<> Bochsに流せるディスクイメージがあれば <br> 試すよ <>
ひげぽん </b>◆zcp/NZpA <b><><>02/09/24 00:00<> &gt;Bochsに流せるディスクイメージがあれば <br> &gt;試すよ <br> ありがとうございます。 <br> 何が起きても責任はもてませんが、もし良かったら試してみてください。 <br>  <br> http://higepos.sourceforge.jp/higeboot.bin <>
612<>sage<>02/09/24 00:03<> <a href="../test/read.cgi/tech/1027080631/613" target="_blank">&gt;&gt;613</a> <br> 動いた。key stroke..って出て、終わり。 <br> よくできてるよー。すげえよ。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/09/24 00:14<> <a href="../test/read.cgi/tech/1027080631/612" target="_blank">&gt;&gt;612</a>さん <br> ありがとうございます。 <br> はやいですねぇ。 <br> 現在は、全くインタラクティブではないので <br> 張り合いがないかもしれません。 <br> キーが押されても、key strokeってでるだけだし･･･ <br>  <br> ちなみに、[U16-65536]とかはメモリーの情報です。 <br> SIZE=16　ADDRESS=65536　Uは使用中。 Fはフリー <br>  <br> タネンバウム本でファイルシステム勉強中です。 <br>  <>
デフォルトの名無しさん<>sage<>02/09/25 23:45<> key strokeって出ますなぁ。。。 <>
デフォルトの名無しさん<>sage<>02/09/26 01:39<> 漏れも入れてみた。すげー、ただkey storokeって出るだけなんだけど、なんか感動したよ。 <>
617<>sage<>02/09/26 01:40<> おっとtypo。 <br> s/storoke/stroke/でよろ。 <br>  <br> higeposって、どういうOSにするつもり…とか構想はあるのかな？ <>
デフォルトの名無しさん<>sage<>02/09/26 07:29<> <a href="../test/read.cgi/tech/1027080631/618" target="_blank">&gt;&gt;618</a> <br> 過去ログ全部読んできてください。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/09/27 20:11<> 少なくとも3人の方に試していただけたようでありがとうございます。  <br>  最近平日はなかなか更新できませんが、何とか続けていこうと  <br>  思っています。  <br>  メモリ管理はリストでやったので  <br>  ファイルシステムはビットマップでやろうかな･･･  <br>   <>
ひげぽん </b>◆zcp/NZpA <b><><>02/09/29 17:26<> 今日はタネンバウム本でファイルシステムの部分を勉強してました。  <br>  FDのREAD,WRITE部分を先に実現しないとどうにもならないので  <br>  資料を探している途中です。  <br>    <br>  カーネル内メモリ管理→ファイルシステムの順にこなして行こうと思うのですが、  <br>  その前にやっておいたほうが良いことってありますでしょうか。  <br>  →経験者の方  <br>    <br>  PJメンバー募集です。  <br>  OS作りに興味がある方で、開発に協力しくれる方を募集します。  <br>  ひげぽん宛にご連絡ください。  <br>  ttp://sourceforge.jp/developer/sendmessage.php?touser=2006 <>
デフォルトの名無しさん<><>02/09/29 23:53<> <a href="../test/read.cgi/tech/1027080631/621" target="_blank">&gt;&gt;621</a> <br> FDに関してはCQの『パソコンのレガシィI/O活用大全』(↓)を <br> http://www.amazon.co.jp/exec/obidos/ASIN/4789834336/ <br> を参考にしますた(他にいい資料があるかもしれないけど、とりあえず)。 <>
デフォルトの名無しさん<>sage<>02/09/29 23:59<> すげぇ・・。まじでOS作ってたのか・・。 <>
ひげぽん </b>◆zcp/NZpA <b><><>02/09/30 00:00<> <a href="../test/read.cgi/tech/1027080631/622" target="_blank">&gt;&gt;622</a> <br> ありがとうございます。 <br> 参考にさせていただきます、今度アキバに行ったときでも <br> 探してみます。 <>
デフォルトの名無しさん<>sage<>02/09/30 00:04<> <a href="../test/read.cgi/tech/1027080631/621" target="_blank">&gt;&gt;621</a> <br> 技術無いんですけど、興味あるんでいいですか？ <>
ひげぽん </b>◆zcp/NZpA <b><><>02/09/30 00:15<> <a href="../test/read.cgi/tech/1027080631/625" target="_blank">&gt;&gt;625</a> <br> 全然大丈夫です。 <br> やる気があれば何とかなります(おそらく) <br> 上記のURLからお願いします。 <br>  <>
625<>sage<>02/09/30 23:36<> <a href="../test/read.cgi/tech/1027080631/626" target="_blank">&gt;&gt;626</a> <br> すみません。 <br> 大型プロジェクトに組み込まれてしまい、参加できそうもなくなってしまいますた。。 <br> このスレ見ながらﾊｧﾊｧすることにします。 <>
デフォルトの名無しさん<>sage<>02/10/01 14:28<> 協力したいけど、レベル足りない…時間もない… <>
ひげぽん </b>◆zcp/NZpA <b><><>02/10/02 00:42<> おかげさまで、数名の方から協力したいとの連絡をいただきました。  <br>  ありがとうございます。  <br>  引き続け募集中ですので、よろしくお願いいたします。  <br>    <br>  <a href="../test/read.cgi/tech/1027080631/627" target="_blank">&gt;&gt;627</a>  <br>  いえいえ、もし機会がありましたらまたお願いします。  <br>  <a href="../test/read.cgi/tech/1027080631/628" target="_blank">&gt;&gt;628</a>  <br>  やる気があれば大丈夫かと思いますが  <br>  気が変わったら是非よろしくお願いいたします。  <br>    <br>  最近仕事が忙しくて、本当に週末しかあまり更新できていませんが  <br>  モチベーションは維持できているのでとりあえずは大丈夫です。  <br>    <br>  Meadowのsetup.exeを試しに使ってみたところ  <br>  今の開発環境(Meadow1.14)がおかしくなってしまったので  <br>  現在復旧作業中です。emacs-lispもそのうち勉強しよう･･･ <>
と<><>02/10/02 03:24<> Bochsの各デバイス用のソースに、  <br>  例えばFDDならFDコントローラのデータシート等へのリンクが書かれていました  <br>  日本語のはなかったけど・・・。  <br>  参考になるかと・・  <br>   <>
と<><>02/10/02 03:27<> 例えば ./iodev/floppy.c に <br> http://mudlist.eorbit.net/~adam/pickey/ports.html <br> こんなリンクが、　英語が読めればかなり参考になりそう <>
と<>sage<>02/10/02 03:42<> よくみたらFD以外のソースにはリンクついてなかった <>
デフォルトの名無しさん<><>02/10/02 08:26<> ROMしかできませんが  <br>    <br>  皆さん頑張ってください。  <br>    <br>  MSに一泡ふかせてやってくらさい。おながいします。  <br>   <>
デフォルトの名無しさん<><>02/10/02 16:30<> Inside AS/400という本を読み始めました。  <br>  なかなか秀悦です。  <br>  OS製作を目指す方は、ぜひ一読をお勧めします。  <br>  とはいえ、私はIB*社員でも何でもありません。  <br>  AS/400の実物は触ったこともありません。  <br>  それどころか、I*Mとはライバル社の・・・・・・ <>
デフォルトの名無しさん<>sage<>02/10/04 00:01<> <a href="../test/read.cgi/tech/1027080631/634" target="_blank">&gt;&gt;634</a> <br> ICMか。なつかしいな。（違う <>
デフォルトの名無しさん<>sage<>02/10/04 21:01<> 最近、AS/400アレルギーが… <>
ひげぽん<><>02/10/04 21:06<> レスが遅くて申し訳ありません。  <br>  <a href="../test/read.cgi/tech/1027080631/630" target="_blank">&gt;&gt;630</a>,631  <br>  ありがとうございます、参考にさせていただきます。  <br>    <br>  <a href="../test/read.cgi/tech/1027080631/633" target="_blank">&gt;&gt;633</a>  <br>  ありがとうございます。  <br>  M$か・・・  <br>   <>
デフォルトの名無しさん<><>02/10/05 01:48<> age <>
ひげぽん@Meadow<>age<>02/10/05 18:54<> 開発環境が復活しました。 <br>  <br> 画面スクロールの部分が未実装だったので <br> 実装中です。 <br> 考えだすと欲が出ますね。 <br> 上下にスクロールさせたいとか・・・ <br>  <br> ところでLinuxでmakeに成功した方 <br> いらっしゃいませんか。 <br>  <br>  <>
デフォルトの名無しさん<>sage<>02/10/05 20:33<> Makefile覗いてみて、.exeが指定されていたので試したこと無いです。 <br>  <>
ひげぽん<><>02/10/05 21:25<> &gt;Makefile覗いてみて、.exeが指定されていたので試したこと無いです。  <br>  そうですよね。  <br>  失礼しました。  <br>   <>
ひげぽん<><>02/10/06 15:59<> 画面スクロール機能を実装しました。  <br>  理想は高かったのですが、結局簡易版となりました。  <br>    <br>  画面の一番下で改行するとスクロールします。 <>
デフォルトの名無しさん<>sage<>02/10/06 16:38<> <a href="../test/read.cgi/tech/1027080631/642" target="_blank">&gt;&gt;642</a> <br> &gt; 画面スクロール機能を実装しました。 <br>  <br> スクロール時に、最下行はクリアしなくていいの ? <>
640<>sage<>02/10/06 18:03<> Makefile.linuxを作ってくれたので試してみましたが、エラーと警告が出まくっ <br> ています。$ gcc --version 2.96 ですが、エラーは `operator new' takes <br> type `size_t' as first parameter が原因みたいです。 <br> include/higeOperator.hとhigeOperator.cppです。私はC++分からないので、 <br> このエラーに関してはコメント不能です。前もって $ mkdir ../bin ../list  <br> が必要でした。# 改行数制限のため、エラーメッセージは割愛です。 <br>  <>
Makeflle.linux 作者<>sage<>02/10/06 19:11<> <a href="../test/read.cgi/tech/1027080631/644" target="_blank">&gt;&gt;644</a> <br> すみません、その辺りの変更を今CVSにコミットしました。 <br> bin と listディレクトリについてはどうしようか考え中です。 <br> ＃Makefileの中で mkdirする? <br>  <br> が、現在 Linux上で makeしたバイナリはブートできない状態ですので <br> もうしばらくお待ちください(リンカの問題？)。 <br>  <br> もちろん、こうしたらいいよというような意見は歓迎です。 <>
ひげぽん<><>02/10/06 19:12<> <a href="../test/read.cgi/tech/1027080631/643" target="_blank">&gt;&gt;643</a> <br> 最下行クリアは必要です。 <br> クリアしていないのになぜかうまくいっていて気づいていませんでした。 <br> あまり考えもせずに実装して、反省中です。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/644" target="_blank">&gt;&gt;644</a> <br> おっと、もう試していただけたんですね。 <br> こういう報告は大変助かります。 <br>  <br> &gt;ています。$ gcc --version 2.96 ですが、エラーは `operator new' takes <br> &gt;type `size_t' as first parameter が原因みたいです。 <br> 私の環境はWindows　djgpp gcc.exe (GCC) 3.1です。 <br>  <br> higepos PJにもlinux環境の人がいるのですが、 <br> そこでもこの現象が起こっています。 <br>  <br> 前提として <br> (1)operator newの引数は size_tでなければならない。 <br> (2)higeposではとりあえずunsigned longにしておいた。 <br> 　　(size_tは処理系で定義するため？？) <br> (3)linux gccはどうやら　size_t = unsinged intとして <br>  　上記のエラーを出してくるらしい。 <br>  <br> すいません、現在調査中ですのでしばらくお待ちください。 <br>  <br>  <br>  <br>  <br>  <>
640<>sage<>02/10/06 19:28<> <a href="../test/read.cgi/tech/1027080631/646" target="_blank">&gt;&gt;646</a> <br> &gt; すいません、現在調査中ですのでしばらくお待ちください。 <br> このエラーは海外のMLで検索で引っかかりました。フォローアップが無いもの <br> がほとんどですが、GCCのバグとして処理されているものもあります。パッチ <br> はいくつかありますが、i386系のアーキテクチャのものは発見できてません。 <br> GCC 3.2 の環境でも作って、試してみないと駄目かな？ <br>  <>
ひげぽん<><>02/10/06 19:41<> <a href="../test/read.cgi/tech/1027080631/640" target="_blank">&gt;&gt;640</a>さん <br> すいません調べていただいてありがとうございます。 <br>  <br> #ifdef等でこのエラーを回避することは出来ると思うのですが <br> その前に何が正しいのかを調べないといけないですね。 <br>  <br> operator new の引数は size_t? unsigned int? unsigned long? <br>  <>
ひげぽん<><>02/10/06 20:25<> gcc3.0からどこぞの団体が決めたC++の仕様にさらに準拠するようになった <br> との記述を見つけたのですが、関係あるのでしょうか。 <br>  <br> C++の仕様を探してたら、17$と書いてあったんだけど <br> C++の仕様書を本で買ったら17$という意味なのかな？ <>
645<>sage<>02/10/06 21:20<> size_t の問題は <br> typedef __SIZE_TYPE__ size_t; <br> と型定義することで解決しました。 <br>  <br> ということで、現在 DJGPPとLinux(gcc2.96)で buildできる状態です。 <br> ＃Linux版は bootせずですが。。 <>
ひげぽん<><>02/10/06 21:30<> 見当違いな調査をしていたひげぽんです。 <br> ひとまず解決してホッとしていますが、Linux版で <br> ブートしないのはいずれきちんと調査しないとまずいですね。 <br>  <br>  <>
デフォルトの名無しさん<>sage<>02/10/06 22:32<> //g++-2.95の場合  <br>  g++-2.95 -I include -nostdlib -fno-exceptions -fno-rtti -ffreestanding -fno-builtin -Wall -c -DBUILD_ON_LINUX io.cpp -o ../bin/io.o  <br>  io.cpp: In function `void outportb(unsigned int, unsigned char)':  <br>  io.cpp:61: parse error before `::'  <br>    <br>  //g++-2.0の場合  <br>  ld: warning: cannot find entry symbol _start; defaulting to 00001200  <br>  ../bin/higepos_kernel.o: In function `startKernel()':  <br>  ../bin/higepos_kernel.o(.text+0xb6): undefined reference to `operator new(unsigned)'  <br>  ../bin/higepos_kernel.o(.text+0xd4): undefined reference to `operator new(unsigned)'  <br>  ../bin/higepos_kernel.o(.text+0xf6): undefined reference to `operator new(unsigned)'  <br>  ../bin/higepos_kernel.o(.text+0x133): undefined reference to `operator delete(void*)'  <br>  ../bin/higepos_kernel.o(.text+0x17e): undefined reference to `operator new(unsigned)'  <br>  ../bin/higeOperator.o: In function `X86MemoryManager::instance()':  <br>  ../bin/higeOperator.o(.gnu.linkonce.t._ZN16X86MemoryManager8instanceEv+0x2b): undefined reference to `__dso_handle'  <br>  ../bin/higeOperator.o(.gnu.linkonce.t._ZN16X86MemoryManager8instanceEv+0x37): undefined reference to `__cxa_atexit'  <br>   <>
デフォルトの名無しさん<>sage<>02/10/06 22:34<> ミスた。  <br>  g++-2.0じゃなくてg++-3.0ね。 <>
Linuxたんとー<>sage<>02/10/07 00:34<> <a href="../test/read.cgi/tech/1027080631/652" target="_blank">&gt;&gt;652</a> <br> 情報ありがとうございます。 <br> gcc2.95 に関しては該当行を <br> asm volatile ("outb %%al,%%dx": :"d" (port), "a" (value)); <br> にする(「::」の間にスペースを入れる)ことでコンパイルできますか？ <br> (コンパイルファームの gcc 2.95.4で試したところ、上記でOKでした) <br>  <br> gcc-3.0 は今、手元にコンパイラが無いため確認できません。。 <>
ひげぽん<>sage<>02/10/07 00:57<> <a href="../test/read.cgi/tech/1027080631/652" target="_blank">&gt;&gt;652</a>さん  <br>  早速の情報ありがとうございます。  <br>    <br>  g++ 2.95のほうはなんとなく解決しそうですが  <br>  g++ 3.0のほうは、完全にリンカエラーですね。  <br>    <br>  &gt;../bin/higeOperator.o(.gnu.linkonce.t._ZN16X86MemoryManager8instanceEv+0x2b): undefined reference to `__dso_handle'  <br>  &gt;../bin/higeOperator.o(.gnu.linkonce.t._ZN16X86MemoryManager8instanceEv+0x37): undefined reference to `__cxa_atexit'  <br>  この辺は_pure_virtualの仲間かな。  <br>    <br>  要調査ですね。 <>
デフォルトの名無しさん<>sage<>02/10/07 17:37<> <a href="../test/read.cgi/tech/1027080631/649" target="_blank">&gt;&gt;649</a> <br> それANSIのHPで買えるPDF版じゃないかな <>
652<>sage<>02/10/07 21:36<> <a href="../test/read.cgi/tech/1027080631/654" target="_blank">&gt;&gt;654</a> <br> g++2.95は解決。 <br>  <br> 3.x系は色々探ってるわかんねぇ。 <br> 力なれなくてスマソ。 <>
654<>sage<>02/10/07 23:11<> <a href="../test/read.cgi/tech/1027080631/657" target="_blank">&gt;&gt;657</a> さん <br> 確認ありがとうございます。 <br>  <br> ＞ 力なれなくてスマソ。 <br> とんでもないです。ありがとうございます。 <br> 3.x系に関しては、gcc-3.0を見付けたのでこれからこちらでも調べてみます。 <>
ひげぽん<><>02/10/08 17:39<> 風邪で寝込んでいたため返事が遅くなり申し訳ありません。  <br>  <a href="../test/read.cgi/tech/1027080631/656" target="_blank">&gt;&gt;656</a>さん  <br>  &gt;それANSIのHPで買えるPDF版じゃないかな  <br>  そういうことですね。  <br>  ありがとうございます。  <br>    <br>  <a href="../test/read.cgi/tech/1027080631/652" target="_blank">&gt;&gt;652</a>さん  <br>  いろいろとありがとうございました。  <br>   <>
デフォルトの名無しさん<><>02/10/09 21:00<> ためしにmakeしてみたらエラーが出ました。 <br> :が一個多いということでしょうか？ <br>  <br> io.cpp: In function `void outportb(unsigned int, unsigned char)': <br> io.cpp:61: parse error before `::' <>
デフォルトの名無しさん<><>02/10/09 21:34<> ）660　 <br> じゃなっくて，間にスペースを入れないと駄目なみたい。 <>
デフォルトの名無しさん<><>02/10/09 22:38<> ｃｙｇｗｉｎにてmakeしたのですがmake出来ませんでした。 <br> エラーはこんなのが出ました。 <br>  <br> ld: PE operations on non PE file. <>
640<>sage<>02/10/10 21:07<> ld --version GNU ld version 2.13 <br> g++ --version g++ (GCC) 3.2 <br> nasm -r NASM version 0.98 <br> な環境作成してみました。結果は、 <br> ld: warning: cannot find entry symbol _start; defaulting to 00001200 <br> ../bin/higepos_kernel.o: In function `startKernel()': <br> ../bin/higepos_kernel.o(.text+0xb6): undefined reference to `operator new(unsigned)' 以下略 <br> でした。何もできませんが、頑張ってください。 <br>  <>
ひげぽん<><>02/10/10 23:08<> <a href="../test/read.cgi/tech/1027080631/662" target="_blank">&gt;&gt;662</a>,640さん <br> 情報ありがとうございます。 <br>  <br> こういう情報は、大変貴重でありがたいです。 <br> これからもよろしくお願いいたしますm(__)m <>
デフォルトの名無しさん<><>02/10/10 23:09<> いくらOS作ろうがドライバが無いから動かないよ。 <>
デフォルトの名無しさん<>sage<>02/10/10 23:17<> <a href="../test/read.cgi/tech/1027080631/665" target="_blank">&gt;&gt;665</a> <br> おこちゃまは何を動かしたいのかな〜 <>
640<>sage<>02/10/10 23:49<> $ file higepos_kernel.o  <br> higepos_kernel.o: ELF 32-bit LSB relocatable, Intel 80386,（略） <br> なんだけどOSってELF32をそのままリンクして作るものなのでしょうか？ <br> もしかしてクロスコンパイル環境が必要ですか？ 無知ですまんです。 <br> $ readelf -a higepos_kernel.o <br> の結果から、 <br> R_386_PC32        00000000   _Znwj <br> R_386_PC32        00000000   _ZdlPv <br> がundefined referenceみたいですが結局分からんです。意味無しm(__)m <>
デフォルトの名無しさん<><>02/10/13 21:40<> cygwinで構築できないか色々やっていますが，ｄｊｇｐｐとは環境がまるっきり違いますね。 <br> いま，ｇｃｃをクロスコンパイルできるように構築中。 <br> ターゲットのしていは　--target=i686-pc-msdosdjgpp <>
640<>sage<>02/10/13 22:50<> <a href="../test/read.cgi/tech/1027080631/668" target="_blank">&gt;&gt;668</a> <br> &gt; --target=i686-pc-msdosdjgpp <br> 情報Tnx。Linux上でbinutils-2.13とgcc-2.95.2でクロス環境構築中です。 <br> うまくいけば報告します。 <>
デフォルトの名無しさん<>sage<>02/10/14 16:12<> Linux上で、ld: supported targets: coff-go32 coff-go32-exe a.out-i386  <br> はできたけど、gcc-2.95.3はうまく構築できなかった。gcc-3.2は無事クロス <br> 環境だけど、 <br> ../bin/higepos_kernel.o(.text+0x278):higepos_kernel.cpp: undefined reference to `__Znwm' <br> こんな感じ。higepos_kernel.oは、 <br> $ file ../bin/higepos_kernel.o  <br> ../bin/higepos_kernel.o: 80386 COFF executable not stripped - version 30821 <br> だから、一応クロス環境にはなっているみたい。 <br> gcc-2.95.3の環境作りに励みます。 <br> <a href="../test/read.cgi/tech/1027080631/668" target="_blank">&gt;&gt;668</a>さんはどんな状況でしょうか？ <>
デフォルトの名無しさん<>sage<>02/10/14 16:50<> gcc-2.95.3環境できました。 <br> 結果、 <br> ../bin/KeyBoardManager.o(.text+0x11):KeyBoardManager.cpp: undefined reference to `__$_15KeyBoardManager' <br> になりました。最新のCVS版です。 <br> io.cpp:   asm volatile ("outb %%al,%%dx": :"d" (port), "a" (value)); <br> は修正済みです。 <>
ひげぽん<><>02/10/14 17:04<> <a href="../test/read.cgi/tech/1027080631/671" target="_blank">&gt;&gt;671</a>さん  <br>  &gt;../bin/KeyBoardManager.o(.text+0x11):KeyBoardManager.cpp: undefined reference to `__$_15KeyBoardManager'  <br>  最新版CVS updateしました。  <br>  KeyBoardManager周りを微妙に変えてみたので  <br>  試していただけないでしょうか。  <br>   <>
デフォルトの名無しさん<>sage<>02/10/14 18:19<> <a href="../test/read.cgi/tech/1027080631/672" target="_blank">&gt;&gt;672</a> <br> &gt; 最新版CVS updateしました。 <br> コンパイルは無事通りました。これから起動テストに入ります。bochsがうま <br> く動かないので、再起動テストになるので、しばらくお待ちください。 <br>  <>
673<>sage<>02/10/14 18:56<> 起動できませんでした。しかし、sourcefogeから落したhigeboot.binでも起動 <br> しなかったので、私のマシンの問題のようです。(Intel入ってないです) ディ <br> スカッションフォーラム: Open Discussionにthird.binをおいておきました。 <br>  <br>  <>
ひげぽん<><>02/10/14 19:03<> <a href="../test/read.cgi/tech/1027080631/673" target="_blank">&gt;&gt;673</a>さん <br> 確認ありがとうございます。 <br> 現在、bochsでは起動できるが、 <br> ネイティブブートが出来ないという問題があがっています。 <br>  <br> 現在現象の原因究明中ですので、解決後に <br> もし良かったらご確認いただけたらとおもいます。 <br>  <br> ありがとうございました。 <>
デフォルトの名無しさん<><>02/10/14 23:31<> &gt;670 <br> 構築できていません。(&gt;_&lt;) <br> だけどｃｙｇｗｉｎでもCOFFだし本当にクロス環境はいらないかも・・・ <br> 問題はリンカスクリプトあたりかも知れない。 <br>  <>
デフォルトの名無しさん<><>02/10/15 00:39<> &gt;&gt;c++はいろいろあって面倒だから <br> &gt; <br> &gt;たとえば、上に上げた例外や、他言語（アセンブラが主かな）とのシンボル名の整合 <br> &gt;あとは、cだとランタイムを使わなければ良いだけでも、 <br> &gt;c++ではnew演算子とか言語自体の機能なんで、 <br> &gt;デフォルトでいらないコードがリンクされたり、それの準備のための初期化ルーチンが用意される。 <br>  <br> C++もライブラリなんか必要無いんだけどな… <br> gcc使ったこと無いのかな… <>
673<>sage<>02/10/15 18:41<> <a href="../test/read.cgi/tech/1027080631/676" target="_blank">&gt;&gt;676</a> <br> &gt; 問題はリンカスクリプトあたりかも知れない。 <br> リンカスクリプトはdjgpp.djlを拾ってきてクロス環境のlibに配置しました。 <br> また、stub.h stubify.cからstubifyを作成し、クロス環境のbinに配置しまし <br> た。Linuxとは違うかもしれませんが参考まで。 <br>  <>
デフォルトの名無しさん<>sage<>02/10/15 19:52<> Windows98にBochsをインストールしてLinuxで作成したhigeboot.binが <br> 無事に起動することを確認しました。最初からWinで試せばよかった(^^; <br> binutils-2.13とgcc-2.95.3を--target=i686-pc-msdosdjgpp <br> でconfigureしたクロス開発環境です。 <>
デフォルトの名無しさん<>sage<>02/10/15 20:17<> disk reading....　と永遠に出続けるが、いったいどうしたものか．．． <>
デフォルトの名無しさん<><>02/10/15 20:27<> &gt;678 <br> higeposを構築するのに，ｇｃｃの構築はいらなくてｌｄだけでいいんじゃないだろうか。 <br> と言うつもりでした。（ｃｙｇｗｉｎでは） <br>  <br> でもこの情報は役に立つと思います。 <br> ありがとう <>
デフォルトの名無しさん<>sage<>02/10/15 20:36<> <a href="../test/read.cgi/tech/1027080631/681" target="_blank">&gt;&gt;681</a> <br> 確かにGNU BFDを利用すれば、LinuxでもELFからCOFFへの変換はldがやってく <br> れそうですね。--enable-targets=allでbinutilsを構築するだけで良かったの <br> かな？ <>
682<>sage<>02/10/15 20:42<> 嘘ついてました。LFLAGS = -Ttext 0x200 --oformat binaryなので、Linuxで <br> は、前もってobjcopyとかで変換しておかなければ駄目かもしれませんね。 <>
デフォルトの名無しさん<>sage<>02/10/16 18:12<> http://www.osdev.org/ <br> http://my.execpc.com/~geezer/osd/ <br> http://nondot.org/sabre/os/articles <br> http://www.mega-tokyo.com/os/os-faq.html <br> http://www.acm.uiuc.edu/sigops/roll_your_own/ <br>  <br> written in C++ <br> http://www.cs.washington.edu/homes/tom/nachos/ <br>  <br> まぁ知ってるだろう一応。 <>
ひげぽん<><>02/10/16 20:20<> 複数人の方々にmake、boot確認をしていただいているようで <br> ありがとうございます。 <br> 皆様より寄せられた情報を元にMakeFile等改善していけたらと <br> 思います。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/684" target="_blank">&gt;&gt;684</a>さん <br> ありがとうございます。 <br> http://ime.nu/www.osdev.org/ <br> のMessage Boardはなかなか有用な情報が多いですね。 <br>  <br>  <>
デフォルトの名無しさん<><>02/10/17 18:49<> firstboot.asmとsecondboot.asmの最後にそれぞれ <br> times 510-($-$$) <br> times 512-($-$$) <br> となってるけど <br> 逆にしたほうがいいんじゃないかな？ <>
ひげぽん<><>02/10/18 21:16<> higeposPJの私以外の優秀なメンバーの調査･修正により <br> higeposがネイティブートできるようになりました。 <br>  <br> higepos最新版をmake後、dd or rawriteでフロッピーに <br> 書き込むと、私の環境ではネイティブブートできました。 <br>  <>
デフォルトの名無しさん<><>02/10/18 21:18<> cygwinで構築することができました！！！ <br> ld でbinaryの指定が出来ないので色々やってましたが <br> 結局，stripかobjcopyでbinaryに変換するのがベストでしょう。 <br> 指定の仕方は　-O binary　になります。 <br>  <>
デフォルトの名無しさん<>sage<>02/10/18 22:28<> 結局ネイティブブートできなかった理由はなんだった？ <>
ひげぽん<>sage<>02/10/18 22:31<> <a href="../test/read.cgi/tech/1027080631/686" target="_blank">&gt;&gt;686</a> <br> &gt;firstboot.asmとsecondboot.asmの最後にそれぞれ <br> &gt;times 510-($-$$) <br> &gt;times 512-($-$$) <br> &gt;となってるけど <br> &gt;逆にしたほうがいいんじゃないかな？ <br> なぜでしょうか。 <br> firstbootは510byte目までは0埋めで2byteのマジックナンバー <br> をつけるのではなかったでしたっけ？(記憶があいまいです。) <>
ひげぽん<>sage<>02/10/18 22:36<> <a href="../test/read.cgi/tech/1027080631/689" target="_blank">&gt;&gt;689</a> <br> 変更点は以下の通りです。 <br> secondboot.asm <br>  <br> &gt;set_cs_desc1: <br> &gt;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;ax, 0x10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; ds & es <br> &gt;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;ds, ax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; selector is <br> &gt;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;es, ax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; 0x10 <br> &gt;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;ax, 0x18&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; ss selector <br> &gt;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;ss, ax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; is 0x18 <br> &gt;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;esp, 1024*1024*8&nbsp; ; sp is 8MB (was&nbsp;mov&nbsp;sp, 0x1000) <br> &gt;&nbsp;&nbsp;&nbsp;&nbsp;jmp&nbsp;0x200 <br>  <br>  <>
デフォルトの名無しさん<><>02/10/18 22:39<> &gt;690 <br> 単にずれてると思ったのだけです(^^;) <br>  <>
FreeDOS教徒<>osage<>02/10/18 22:56<> <a href="../test/read.cgi/tech/1027080631/684" target="_blank">&gt;&gt;684</a> <br> osdev以外全部知らなかったョ‥‥ <br>  <br> <a href="../test/read.cgi/tech/1027080631/686" target="_blank">&gt;&gt;686</a> <br> ホワ！何を云っているですか？ <br> それやったらfirstbootすら動かないのですよ？ <>
デフォルトの名無しさん<>sage<>02/10/19 00:04<> Linux 2.4.4, gcc-2.95.3, binutils-2.13のクロス環境で作成した <br> higeboot.binをddで書き込んだフロッピーで起動することを確認しました。お <br> めでとうございます。さらなる発展を期待しています。頑張ってください。 <br>  <>
デフォルトの名無しさん<><>02/10/19 00:55<> bochsだと3thException吐いて止まるな。 <br>  <br> higepos_kernel.cpp50行目の_sys_Unlock()つまりasm("sti")で止まっている。 <br> コメントアウトしたらちゃんと動いたから。 <br> しかし指摘されてないってことは俺の環境だけなのかな。 <br>  <br> linux <br> gcc2.95.4 <br> binutils-2.13 <br> bochs1.4.1 <>
デフォルトの名無しさん<><>02/10/19 09:10<> VMWareで動かせるんだったら漏れも参加しようかなあ。 <>
ひげぽん<>sage<>02/10/19 13:23<> <a href="../test/read.cgi/tech/1027080631/694" target="_blank">&gt;&gt;694</a> <br> &gt;さらなる発展を期待しています。頑張ってください <br> 動作確認情報ありがとうございます。 <br> これからもよろしくお願いいたします。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/695" target="_blank">&gt;&gt;695</a> <br> &gt;bochsだと3thException吐いて止まるな。 <br> 私の環境ではでないですね。 <br> うーん。なぜだろう。 <br>  <>
695<><>02/10/19 15:48<> make時こんなメッセージが出てる。 <br> sourceforgeに落ちてるbinary(higeboot.bin)ならいけたのでやっぱmake時の問題かねぇ。 <br>  <br> ld: warning: cannot find entry symbol _start; defaulting to 00001200 <>
ひげぽん<>sage<>02/10/19 17:03<> <a href="../test/read.cgi/tech/1027080631/698" target="_blank">&gt;&gt;698</a> <br> &gt;ld: warning: cannot find entry symbol _start; defaulting to 00001200 <br> これは私のところでも出ていますね。 <br> 今現在のCVS最新でもなりますか？ <br>  <>
ひげぽん<><>02/10/19 17:10<> 募集です。 <br> higepos PJのプロジェクトホームページを作っていただける人。 <br> 皆様にhigeposの動作確認等をしていただいた情報を <br> そこで公開しようと思っています。 <br>  <br> ひげぽんは、はげしくデザインセンスがないので <br> カッコイイのを作ってくださる方お願いいたしますm(__)m <br>  <br> http://sourceforge.jpでアカウントを取得後 <br> http://sourceforge.jp/users/higepon/より <br> ひげぽんまでご連絡ください。 <br>  <>
デフォルトの名無しさん<>sage<>02/10/19 18:02<> <a href="../test/read.cgi/tech/1027080631/695" target="_blank">&gt;&gt;695</a> <br> クロスコンパイル環境がうまくできていない可能性はないですか？GCCがELF  <br> フォーマットを吐く時は同じエラーでしたが、COFFを吐くようにすると起動で <br> きます。 <br> # bochs-1.4.1 on Linux では"Key hit!"がまだみれていない。(泣 <br>  <>
701<>sage<>02/10/19 19:33<> bochs-1.4.1 on Linux では"key stroke"が見れました。bochsコンパイル時の <br> 問題でした。higeposは無罪です。 <br>  <>
695<><>02/10/19 22:12<> こちらに非があったようで。すいません。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/701" target="_blank">&gt;&gt;701</a> <br> 具体的にはCOFF形式で吐かせるためにはgccの./configureの時点でサポートして、 <br> -gcoffオプションをつけてコンパイルってことで良いですか？ <br> 調べてみるとそんな感じだったのですが。。。 <br>  <br> gccもbochsもdebで適当にぶちこんだ物なので。。。 <>
デフォルトの名無しさん<>sage<>02/10/19 22:19<> ｼﾞｻｸｼﾞｴﾝご苦労さん <>
ひげぽん<><>02/10/20 14:08<> <a href="../test/read.cgi/tech/1027080631/688" target="_blank">&gt;&gt;688</a>さん <br> &gt;cygwinで構築することができました！！！ <br> &gt;ld でbinaryの指定が出来ないので色々やってましたが <br> &gt;結局，stripかobjcopyでbinaryに変換するのがベストでしょう。 <br>  <br> もし良かったらcygwinでのmake方法を詳しく教えていただけないでしょうか。 <br> cygwinでmake出来るのであれば、あえてdjgppを使う理由はあまりないので･･･ <br>  <>
デフォルトの名無しさん<>sage<>02/10/20 16:48<> <a href="../test/read.cgi/tech/1027080631/703" target="_blank">&gt;&gt;703</a> <br> <a href="../test/read.cgi/tech/1027080631/679" target="_blank">&gt;&gt;679</a> <br>  <br>  <>
デフォルトの名無しさん<><>02/10/20 17:04<> &gt;705 <br> リンカのオプションの--oformat binaryを消して， <br> リンク後にstripなどで-O binaryのオプションで変換します。 <br> 特に環境を替える必要はないはずですが，色々やった後なのでそのあたりは自信がありません。 <>
ひげぽん<><>02/10/20 17:30<> 【お知らせ】 <br> sourceforge.jpの&nbsp;cvs&nbsp;のディレクトリ構成に変更がありました。 <br>  <br> &nbsp;CVSROOT/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CVSROOT/&nbsp;&nbsp; <br> &nbsp;higepos/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;higepos/&nbsp;&nbsp; <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;higepos_v1.1/&nbsp;&nbsp; <br>  <br> higepos/旧開発ディレクトリ <br> higepos_v1.1/新開発ディレクトリ <br>  <br> MakeFile、ファイル名等に変更がありますが <br> 中身は同一です。 <br>  <br> 今日以降は新開発ディレクトリで、開発が進みますのでご注意下さい。 <>
ひげぽん<><>02/10/20 17:33<> MakeFile.cygwinを追加しました。 <br> bochs,ネイティブブートが確認できましたのでcvs addしました。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/707" target="_blank">&gt;&gt;707</a>さん <br> ありがとうございました。 <>
695<>sage<>02/10/20 18:29<> <a href="../test/read.cgi/tech/1027080631/706" target="_blank">&gt;&gt;706</a> <br> 情報thanks. <br> やっと回避できたよ。。。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/708" target="_blank">&gt;&gt;708</a> <br> LinuxのMakefileの記述にミス発見(tarball) <br> 20行目のXが小文字になってる。 <br>  <br> しかし1.1だと普通にMakeしても大丈夫なんだよなぁ。 <>
ひげぽん<><>02/10/20 18:44<> <a href="../test/read.cgi/tech/1027080631/695" target="_blank">&gt;&gt;695</a> <br> &gt;LinuxのMakefileの記述にミス発見(tarball) <br> &gt;20行目のXが小文字になってる。 <br> 修正しました。ご指摘ありがとうございます。 <br> 以前からあった記述ミスのようです。 <br>  <br> しかしMakeFileが3つもあるとメンテが面倒ですね。 <br> うまくまとめられないだろうか。 <>
デフォルトの名無しさん<>sage<>02/10/20 20:24<> <a href="../test/read.cgi/tech/1027080631/710" target="_blank">&gt;&gt;710</a> <br> &gt; しかし1.1だと普通にMakeしても大丈夫なんだよなぁ。 <br> クロス環境なんていらなくなりましたね。なんでだろう？ <br> # 開発者の方で把握していたら教えてください。 <>
712<>sage<>02/10/20 20:58<> <a href="../test/read.cgi/tech/1027080631/712" target="_blank">&gt;&gt;712</a> <br> &gt; クロス環境なんていらなくなりましたね。なんでだろう？ <br> すみません。bochsrcファイルが以前のhigeboot.binを指定していただけでし <br> た。新たにhigepos_v1.1/bin/higeboot.binを指定し直したところ、3rd <br> exception with no resolutionで停止しました。 <br> クロス環境で作成するとだと無事に起動しました。 <br> # リターン入力でのハートがラブリー &hearts; <br>  <br>  <>
デフォルトの名無しさん<><>02/10/20 21:08<> &gt;711 <br> LunxとCygwinでは同じｍａｋｅファイルでｏｋなはずです。 <br> ｄｊｇｐｐ方ではツールの入ったフォルダにパスを通すとかして環境をｍａｋｅファイルに合わせればいいです。 <>
ひげぽん<><>02/10/20 22:50<> <a href="../test/read.cgi/tech/1027080631/712" target="_blank">&gt;&gt;712</a> <br> &gt;クロス環境で作成するとだと無事に起動しました。 <br> 確認ありがとうございます。 <br>  <br> &gt;# リターン入力でのハートがラブリー &#9829; <br> デバッグ中なので対応する文字コードが存在しないキーは <br> 変な文字が表示されます。あまり気にしないでください・・・ <br>  <br> <a href="../test/read.cgi/tech/1027080631/714" target="_blank">&gt;&gt;714</a> <br> &gt;LunxとCygwinでは同じｍａｋｅファイルでｏｋなはずです。 <br> そうですよね。MakeFile.cygwinがLinuxでも普通に使えることが <br> 確認できたら統一したいです。 <br>  <br> djgppとの統合は うーん といった感じです。 <br> これからはcygwinに移行する気がします･･･ <br>  <br>  <>
LightCone </b>◆sSJBc30S5w <b><><>02/10/21 09:52<> <a href="../test/read.cgi/tech/1027080631/715" target="_blank">&gt;&gt;715</a> <br> 　ソース見てみましたが、アセンブラ部は僅かでほとんどC++で書いていらっ <br> しゃる点には驚きました。今後が楽しみです。 <br>  <br> 　ところで、割り込みディスクリプタテーブルについてですが、本来は、 <br> ハードウェア割り込みのベース番号を再プログラムする必要があります。 <br> そうしないと、一般保護例外(13)などと、ハードウェア割り込みの区別が <br> 付きません。 <br>  <br> 　しかし、gccでも簡単に32BIT-OSが作れるようになっているのですね。 <br> ４、５年前は、ジャジャ馬のようでしたが（個人的には）。 <>
LightCone </b>◆sSJBc30S5w <b><><>02/10/21 10:07<> 　ちなみに、NWSOSでは、初期化がかなり複雑で好ましくないのですが、 <br> higeposはシンプルで良いですね。 <br>  <br> 　NWSOSの場合、16BIT BIOS を走行させるための16BITエミュレータ <br> を持っていることや、メモリ空間確保のため、カーネルを高位アドレスへ <br> 転送しているからも有るでしょうけど。 <br>  <br> 　最初に物理メモリの空きマップを調べてから、仮想アドレス空間へ <br> マップし、カーネルを転送しています。 <br>  <br> 　GDTの位置（テーブルの位置）も上位へ転送するので、再構築 <br> したりしてます。こんな複雑なことをする必要は無いんじゃないか <br> と思ったりするのですが。 <br>  <br> 　話が厄介なのは、「ページテーブル管理ルーチン」が、カーネル <br> 転送前と、転送後の両方で必要になることなんです。 <br>  <br> 　ページング ON の状態でカーネルを転送するために、転送前の <br> アドレスにも管理ルーチンが存在している必要がありますが、 <br> 一方で、転送後にも当然必要です。しかし、転送後は、転送前の <br> メモリはゴミと化すので、どうしても二つ必要な気がします。 <br> 同じソースを流用できるかもしれませんが。 <>
LightCone </b>◆sSJBc30S5w <b><><>02/10/21 10:24<> 　16BIT エミュレータを持つと複雑になるんですよね。 <br>  <br> 　割り込んだ時に、最低でも一回はシステムが用意したハンドラに <br> 入ってから、必要に応じて、16BITハンドラと、32BITハンドラを <br> 呼び出す、という仕組みになりますから。 <br> 　16BITモードから、32BITモードへ「戻る」のもIA32では難しかった <br> ですね。 <br>  <br> 　higeposでは、DISK周囲はどうされますか？　個別にドライバを <br> 用意しますか？　画面モードの切り替えにも、BIOS呼び出しが必要 <br> になると思いますが。 <br> 　ちなみに、VESA の プロテクトモードインターフェースはNWSOSでは <br> 使わず、16BITモードインターフェースをエミュレーション実行 <br> しています。 <>
デフォルトの名無しさん<>sage<>02/10/21 11:55<> LIghtConeたんが生きてた…ﾎｩ… <br>  <br>  <>
デフォルトの名無しさん<>sage<>02/10/21 19:19<> <a href="../test/read.cgi/tech/1027080631/715" target="_blank">&gt;&gt;715</a> <br> &gt; そうですよね。MakeFile.cygwinがLinuxでも普通に使えることが <br> &gt; 確認できたら統一したいです。 <br> CC, LD, STRIP, NASM, NDISASMとかの変数を別途用意した定義ファイルに書く <br> ようにすると大丈夫ではないでしょうか？djgpp, cygwin, Linuxではすべて <br> GNU makeだと思うので、includeが利用できると思います。クロスコンパイル <br> では、CC = prefix/bin/i686-pc-msdosdjgpp-g++,  <br> LD = prefix/i686-pc-msdosdjgpp/bin/ld のようにする必要があるので、 <br> 修正は必須になります。 <br>  <>
ひげぽん<><>02/10/21 21:23<> LightConeさん <br>  <br> &gt;ソース見てみましたが、アセンブラ部は僅かでほとんどC++で書いていらっ <br> &gt;しゃる点には驚きました。今後が楽しみです。 <br>  <br> ありがとうございます。 <br> ご期待に沿えるかどうかは分かりませんが、気長にやっていくつもりです。 <br>  <br> &gt;　ところで、割り込みディスクリプタテーブルについてですが、本来は、 <br> &gt;ハードウェア割り込みのベース番号を再プログラムする必要があります。 <br> &gt;そうしないと、一般保護例外(13)などと、ハードウェア割り込みの区別が <br> &gt;付きません。 <br>  <br> はい、上記はhigepos&nbsp;PJメンバーの指摘により認識しています。 <br> 現在の課題のひとつです。 <br>  <br> &gt;　しかし、gccでも簡単に32BIT-OSが作れるようになっているのですね。 <br> &gt;４、５年前は、ジャジャ馬のようでしたが（個人的には）。 <br>  <br> そうですね。 <br> 確かに現在では、海外のOS&nbsp;Devサイトでかなりの情報が <br> 取得出来るのが大きいですね。 <br> また、2chのような情報交換の場があるのもありがたい話です。 <br>  <br> &gt;ちなみに、NWSOSでは、初期化がかなり複雑で好ましくないのですが、 <br> &gt;higeposはシンプルで良いですね。 <br>  <br> シンプルというよりは、むしろ必要な初期化が足りていないと <br> いうのが現状です。 <>
ひげぽん<><>02/10/21 21:23<> &gt;　NWSOSの場合、16BIT&nbsp;BIOS&nbsp;を走行させるための16BITエミュレータ <br> &gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;・ <br> &gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;・ <br> &gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;・ <br> &gt;16BITモードから、32BITモードへ「戻る」のもIA32では難しかった <br> &gt;ですね。 <br>  <br> 現在の私の力量ではとても手を付けられそうなところですね。 <br> さすがですね。 <br> 私も精進せねば・・・ <br>  <br> &gt;　higeposでは、DISK周囲はどうされますか？　個別にドライバを <br> &gt;用意しますか？　画面モードの切り替えにも、BIOS呼び出しが必要 <br> &gt;になると思いますが。 <br>  <br> higeposは、現時点ではFDD動くことを目標としているので <br> FDDドライバを用意する予定です。 <br>  <br> いろいろとアドバイスありがとうございます。 <>
ひげぽん<><>02/10/21 21:28<> <a href="../test/read.cgi/tech/1027080631/720" target="_blank">&gt;&gt;720</a> <br> &gt;CC, LD, STRIP, NASM, NDISASMとかの変数を別途用意した定義ファイルに書く <br> &gt;ようにすると大丈夫ではないでしょうか？ <br> はい、現在DJGPPの私の環境ではBATファイルを用意して対応しています。 <br>  <br>  <br> &gt;djgpp, cygwin, Linuxではすべて <br> &gt;GNU makeだと思うので、includeが利用できると思います。クロスコンパイル <br> &gt;では、CC = prefix/bin/i686-pc-msdosdjgpp-g++, <br> &gt;LD = prefix/i686-pc-msdosdjgpp/bin/ld のようにする必要があるので、 <br> &gt;修正は必須になります。 <br>  <br> なるほど貴重なご意見ありがとうございます。 <br> higeposの一課題として取り組んでいきます。 <>
LightCone </b>◆sSJBc30S5w <b><><>02/10/21 22:02<> <a href="../test/read.cgi/tech/1027080631/721" target="_blank">&gt;&gt;721</a> <br> &gt;&gt;ちなみに、NWSOSでは、初期化がかなり複雑で好ましくないのですが、 <br> &gt;&gt;higeposはシンプルで良いですね。 <br> &gt;シンプルというよりは、むしろ必要な初期化が足りていないと <br> &gt;いうのが現状です。 <br>  <br> シンプルなことは素晴らしいことです。 <br> アセンブラ部とC言語部を「リンク」せずに、単にcatするアイデアなど <br> は面白いと思いました。リンクしたほうが恐らく複雑になるので、 <br> 少なくとも現状の規模では、catの方がいいと思います。 <br>  <br> また、OSを作り始めるときに、アセンブラでなく、ほぼいきなり <br> C/C++からやってしまうのは凄いことなんじゃないかと思いました。 <br> C/C++だとセグメント配置などが厄介なはずなので。 <br> ld がOSを作りやすいように出来ているのかもしれませんが。 <br>  <br>  <br>  <br> タスクを制御しだすと、スタックを細かく扱う必要がありますが、 <br> そこもC++でどこまで出来るか興味があります。 <br>  <br>  <br> 話は変わりますが、個人的に一番労力を割いたのは、IA32の複雑な <br> アーキテクチャの理解だったかもしれません。 <br> 初期化やモード遷移には物凄く悩まされました。 <br> どのゲートを使うべきか等も、しばらく検討していたように <br> 思います。 <br>  <br> そうこうしているうちに、4GB では足りなくなって、物理メモリと、 <br> 仮想メモリが、順に拡張されましたね。SSE/SSE2まで理解し様と <br> するとほどんどパニック状態になりそうです。SSE/SSE2命令を <br> 使えるようにするためにはOS側のサポートも欠かせないのですが。 <>
LightCone </b>◆sSJBc30S5w <b><><>02/10/21 22:23<> <a href="../test/read.cgi/tech/1027080631/722" target="_blank">&gt;&gt;722</a> <br> 　多分、今後の higepos に必要なのは、ページング関係と割り込み <br> 関係だと思います。 <br>  <br> 　各種例外ハンドラを整備するのはOSとしては必須ですので避け <br> られませんが、例外が起きた時の処理は以外に面倒でした。IA32 <br> の膨大な資料とにらめっこしながらコーディングしていたのですが、 <br> 当時詳しいドキュメントが無くて、実験しながら正しい理解を得ていか <br> ざるを得ませんでした。今でもこの辺はやってみながら薦めていかないと <br> 正しく理解するのが難しいのではないでしょうか。 <br>  <br> 　ページング関係は早い段階で実装してしまう必要が有ると思います。 <br> 後になってページングをサポートし様としても修正が大規模になり、 <br> デバッグが大変になるかもしれませんので。 <br>  <br>  <br> 　最近まで、実験機と開発機が共通でしたが、 <br> OS開発ではまると、ブートさせても「停止」すらしてくれないん <br> ですよね。止まってくれただけで一安心みたいな境地でした。 <br> なんらのメッセージすら見えずに一瞬にして再リセットなんて事の <br> 方が普通だった時期もありましたね。こんなことを話しても、飲み屋 <br> の愚痴みたいで何の参考にもならないと思いますが、すみません。 <>
ひげぽん<><>02/10/21 23:11<> LightConeさん <br>  <br> &gt;また、OSを作り始めるときに、アセンブラでなく、ほぼいきなり <br> &gt;C/C++からやってしまうのは凄いことなんじゃないかと思いました。 <br>  <br> ここは、私の技術的背景もあると思います。 <br> 端的に言うならばアセンブラ初心者であったので <br> なるべくアセンブラ部分を少なくしようという意図が <br> 働いたのだと思います。(C++も初心者ですが･･･) <br>  <br> &gt;タスクを制御しだすと、スタックを細かく扱う必要がありますが、 <br> &gt;そこもC++でどこまで出来るか興味があります。 <br>  <br> なるほど。 <br> 私がhigeposをC++で書こうといろいろと調べてたり、 <br> 2chの方にアドバイスを頂いたときに感じたのですが。 <br>  <>
ひげぽん<><>02/10/21 23:12<>  <br> 実際にソースを公開している <br> いわゆる売り物ではないOSで <br> C++で実装している物があまり見つからないのです。 <br>  <br> これはC++でやってやろうという人が少ないのか <br> それともC++で通すと、いずれ壁にぶつかるのか･･･ <br> いずれ答えは出ると思いますが。 <br>  <br> ただhigeposはC++を使っているものの <br> 私が当初想定したより、かなりの制限を受けています。 <br>  <br> ・例外処理が使えない <br> ・継承が使えない <br> ・テンプレートが使えない <br>  <br> 上記はおそらく、私の技術レベルが低いために <br> OSを作る際に、該当機能を使う環境が整えられない <br> のが原因なので、いずれは解決したいです。 <br>  <>
ひげぽん<><>02/10/21 23:12<>  <br> &gt;　多分、今後の higepos に必要なのは、ページング関係と割り込み <br> &gt;関係だと思います <br>  <br> 現在のhigeposは、いろいろと手を入れるべきところがあります。 <br> プライオリティづけが必要であると感じています。 <br> 特にページングは、LightConeさんのおっしゃるとおり <br> 早いところ手を付けたいところですね。 <br>  <br> &gt;こんなことを話しても、飲み屋 <br> &gt;の愚痴みたいで何の参考にもならないと思いますが、すみません。 <br>  <br> いえいえ大変参考になります。 <br> OSを作っているかたで、しかも大先輩の <br> お話を聞ける機会はなかなかないので・・・ <br>  <br> 少しでもNWSOSに追いつけるようにがんばります。 <>
デフォルトの名無しさん<><>02/10/22 01:30<> Objective-Cに移行しる <>
デフォルトの名無しさん<>sage<>02/10/22 01:44<> Mac の　System 1はPascalだ <br> がんがれ。情報無しでsage <>
LightCone </b>◆sSJBc30S5w <b><><>02/10/22 01:52<> <a href="../test/read.cgi/tech/1027080631/727" target="_blank">&gt;&gt;727</a> <br> &gt;ただhigeposはC++を使っているものの  <br> &gt;私が当初想定したより、かなりの制限を受けています。  <br> &gt;・例外処理が使えない  <br> &gt;・継承が使えない  <br> &gt;・テンプレートが使えない  <br>  <br> テンプレートはマクロなので使えない方がむしろ不思議ですね。 <br> 継承も多分少し工夫すると使えるようになると思います（思うだけ <br> ですが）。 <br> 例外処理だけは、容易には使えないかもしれません。 <br> 一年位前まで、C++の例外処理は単に言語レベルで解決されていて、 <br> OSに依存せずに処理されているのかと思っていたのですが、 <br> コンパイラによっては、OSの機構にモロに依存しているようなのです。 <br> 極端な話、ページ例外や、一般保護例外といった CPU 例外と、 <br> throw,catch などの機構を統合して処理できるOSもあるみたいです <br> （実はWindowsがそうらしい）。 <br>  <br> 　Windowsの catch機構は、throw したものだけでなく、他人が作 <br> ったライブラリのバグなども拾うことが出来るようになっているよう <br> です。これは非常に興味深い機構で異常に強力なのですが、当然 <br> OS側からの前面的なサポートが必要なので、新しいOSを作る際には <br> 基本的に使えません。ただし、純粋に言語レベルでソフト的に処理 <br> する方法もあると思います。「スタックの逆戻し」とか中々、乙な <br> 仕組みをやってるみたいですが。 <>
LightCone </b>◆sSJBc30S5w <b><><>02/10/22 02:06<> <a href="../test/read.cgi/tech/1027080631/731" target="_blank">&gt;&gt;731</a> <br> いずれにせよ、例外処理はかなりスタックを複雑に走査する必要がある <br> ので、作りたてのOSの、しかも、カーネルを記述する際に使用するとな <br> ると、難しい問題を招き入れてしまうことになりそうです。 <br>  <br> カーネルのスタックの容量を自動伸張したりするのは、技術的に <br> 高度で、新規のOSでは避けて通るに越したことは無いと思います。 <br> 例外処理を使うとスタック消費量も予想しづらくなりそうなので、 <br> 個人的には避けたほうがいいように思います。ただでさえ、 <br> カーネル内の「スタック」の利用は伸張になる必要があります <br> から。 <br> 実は、NWSOSでは、カーネルも、ユーザープログラムも、 <br> タスク毎に独立したスタック（つまり、タスク数＊２本の <br> スタック）を持っています。このようにすると、カーネル <br> が使うスタックが不足することは考えなくて済むかも <br> しれません。ただ、それでも、ファイル名格納用のメモリは、 <br> スタックに取らずに SysMalloc() というメモリ確保関数 <br> から取得した領域を使うようにしています。スタックでも <br> 問題ないかもしれませんが、、、。 <br> 同一タスクに、複数のスレッドを起動する場合は、 <br> カーネルスタックはやはりスレッドの数だけ用意するべき <br> なのかもしれませんね。何が良いかは良く分かりませんが。、 <>
LightCone </b>◆sSJBc30S5w <b><><>02/10/22 02:23<> <a href="../test/read.cgi/tech/1027080631/728" target="_blank">&gt;&gt;728</a> <br> 優先順位付けは、腕の見せ所でも有るかもしれませんね。 <br> 何が必要で、何がそれほどでもないか。または、何を先にやれば、 <br> うまくいくか、を決めていくのは、一番大事なところかもしれませ <br> んし、、、。OS作りでは、細かいロジックも重要みたいですが。 <br> 僅かでも間違いがあるとどこかで露呈しますし、いくら大局的に <br> 立派な思想に基づいていても、細かいロジックが「解け」なければ <br> 「もの」として出来てきませんからね。OSを作っていると、 <br> つくづく、そういうところで自分の愚かさ加減がいやになりますが。 <br>  <br> 話は変わりますが、マルチタスクOSを作っていると、よく <br> ロック、アンロックを使う必要がありますよね。ご存知かもしれま <br> せんが、 <br> 　「デッドロックを起こさない絶対的な基準」 <br> を知っていると得ですね。 <br> これを知っていると楽ですね。 <br> 「入れ子のロックの順序を統一せよ」 <br> ってだけなんですが、、、。 <>
LightCone </b>◆sSJBc30S5w <b><><>02/10/22 08:43<> <a href="../test/read.cgi/tech/1027080631/727" target="_blank">&gt;&gt;727</a> <br> 何度も連続投稿してすみませんが、 <br> &gt;これはC++でやってやろうという人が少ないのか <br> &gt;それともC++で通すと、いずれ壁にぶつかるのか･･･ <br> &gt;いずれ答えは出ると思いますが。 <br>  <br> 特に壁は無いとは思いますが、低レベル言語の方が楽な場合も多いから <br> じゃ無いでしょうか。 <br> 保守性や拡張性や可読性は、高級言語のほうが遥かにいいのですが、 <br> フラグ操作や、スタック操作、iret命令、例外ハンドラ書き、などは、 <br> 一部にはどうしてもアセンブラの助けが必要になるのですが、 <br> そういう部分で高級言語と連携させようとすると通常一手間増えてしま <br> います。 <br>  <br> ただし、C++の本領発揮できる部分も沢山有ると思います。 <br> リストを多用しやすいことや、自動的なコンストラクタ、デストラクタ <br> 挿入によるでミスの無い記述ができること、などは非常に有利では <br> ないでしょうか。 <br>  <br> ただし、大まかに言って、カーネルは必要最低限のものの集合体で、 <br> いわば、互いに素というか、各部分の共通部分がすくないため、 <br> 似たもの同士を結びつける時に威力を発揮する「継承機能」は余り使う場面 <br> が無いかもしれませんね。 <br>  <br>  <>
LightCone </b>◆sSJBc30S5w <b><><>02/10/22 08:43<> [#734の続き] <br>  <br> 単純に考えても、ファイルシステムの各APIは、そんなに共通の性質が <br> 有るとは思えません。オープンとクローズは関連の仕方が、恐らく継承で <br> 解決できるものではありませんよね。ReadとWriteは似ているので、「継承」 <br> が使える余地は有ると思いますが。 <br> ディレクトリ作成とファイル作成は内部処理は似た部分が多いので、 <br> 「継承」で簡単化できる可能性もあることはありますが、別の方法で <br> 共通部分を上手く処理する方法もあると思いますので、C++が有利 <br> になるかどうかは個人的には良く分かりません。 <br>  <br>  <br> 例外処理なども、各ハンドラに似た部分も多そうなので、C++が有利そう <br> ではあります。しかし、もしかすると、 <br> 「どんな、割り込みハンドラを登録しても、矛盾無く調停される」 <br> ということが出来る方が、オブジェクト指向で矛盾を減らすことよりも、 <br> 安定性や汎用性が高くなるため、理想的では有ると思います。 <br>  <>
デフォルトの名無しさん<><>02/10/22 10:24<> 所詮習作なので、作ってて気に入らなくなったらまたゼロから作るぐらいの <br> つもりで、ひげぽんの独断で方針決めて、がんがん作っちまえばよいと思われ。 <br>  <br> んで、ひととおり動いたら、また新しく目標立ててプロジェクトおこせばいい。 <br>  <br> 最終的にはQNXを凌ぐオープンなOSを個人的には希望（笑 <>
ひげぽん<><>02/10/22 20:42<> LightConeさん <br>  <br> &gt;テンプレートはマクロなので使えない方がむしろ不思議ですね。 <br> &gt;継承も多分少し工夫すると使えるようになると思います（思うだけ <br> &gt;ですが）。 <br>  <br> LightConeさんのご意見を受けて、テンプレートを試したところ <br> うまくいきそうです。どうやら私知識不足でリンクエラーになっていたみたいです。 <br> これから簡易版Vectorでも実装してみます。 <br>  <br> &gt;優先順位付けは、腕の見せ所でも有るかもしれませんね。 <br> &gt;何が必要で、何がそれほどでもないか。または、何を先にやれば、 <br> &gt;うまくいくか、を決めていくのは、一番大事なところかもしれませ <br> &gt;んし、、、。 <br>  <br> 全くその通りですね。しかもご指摘の通りOSを作成する場合には <br> 細かいところにも気を配らないといけませんね。 <br>  <>
ひげぽん<><>02/10/22 20:42<>  <br> &gt;いわば、互いに素というか、各部分の共通部分がすくないため、 <br> &gt;似たもの同士を結びつける時に威力を発揮する「継承機能」は余り使う場面 <br> &gt;が無いかもしれませんね。 <br>  <br> そうですね。私が想定しているのは <br> 完全にインターフェースとしての継承機能を用いることです。 <br>  <br> 例が悪いかもしれませんが、 <br>  <br> 外部記憶装置のドライバーの機能は外から見た場合 <br> 大雑把に言って <br> init：初期化 <br> read：読み込み <br> write：書き込み <br> close：終了処理 <br> となると思います。 <br>  <>
ひげぽん<><>02/10/22 20:42<>  <br> ですので上記のようなインターフェースを持つ基底クラスとして <br> 抽象クラスBaseDiskDirverを作成します。 <br>  <br> 具体的なハードウェアのドライバー担当者は <br> こいつを継承した具象クラスを実装する形になります。 <br>  <br> OS側では <br>  <br> BaseDiskDrier* p = new FloppyDiskDriver1(); <br> や <br> BaseDiskDrier* p = new FloppyDiskDriver2(); <br> や <br> BaseDiskDrier* p = new HardDiskDriver(); <br>  <br> としてドライバーインスタンスを生成しますが <br> どのドライバーを用いているかを気にするのは <br> インスタンスの生成のところだけで <br>  <br> それ以降は、pが一体どのドライバーオブジェクトなのか <br> を気にせずに処理が出来るようになります。 <br>  <br> p-&gt;write(・・・・); <br>  <br> ドライバーの例はあまり適切ではありませんで <br> 分かりづらいかとは思いますが <br> このような使い方が出来たらと思っています。 <>
ひげぽん<><>02/10/22 20:45<> <a href="../test/read.cgi/tech/1027080631/736" target="_blank">&gt;&gt;736</a> <br> &gt;所詮習作なので、作ってて気に入らなくなったらまたゼロから作るぐらいの  <br> &gt;つもりで、ひげぽんの独断で方針決めて、がんがん作っちまえばよいと思われ。  <br> &gt;んで、ひととおり動いたら、また新しく目標立ててプロジェクトおこせばいい。  <br>  <br> ありがとうございます。 <br> 「動けばいいや」精神が弊害になってきているので <br> そこだけ注意して、これからもやっていきます。 <br>  <br>  <>
デフォルトの名無しさん<>sage<>02/10/22 22:11<> <a href="../test/read.cgi/tech/1027080631/738" target="_blank">&gt;&gt;738</a> <br> &gt;  例が悪いかもしれませんが、 <br>  <br> 全然適切。 <br>  <br> 現在のモダンな OS では、基本的にひげぽんさんが考えているようになっている。 <br> 例えば FreeBSD 2.x では... <br>  <br> struct cdevsw { <br> 　d_open_t *d_open; <br> 　d_close_t *d_close; <br> 　d_read_t *d_read; <br> 　d_write_t *d_write; <br> 　d_ioctl_t *d_ioctl; <br> 　... <br> }; <br>  <br> と言うような、デバイス処理ルーチンの関数テーブルがあって、OS はデバイスから読みたい時は、device-&gt;d_read(...); と間接コールをする。 <br> これらのテーブルは、デバイスの初期化ルーチンが呼ばれる時にセットされる。 <br>  <br> 要するに、C++ の仮想関数と同じことを手でやってると言うこと。 <br> だから、ここら辺を C++ で書くと結構きれいにかけるかもしれないと思っているので、ひげぽんさん頑張ってください。 <>
デフォルトの名無しさん<><>02/10/22 22:25<> まあ、最初なのでioctl()まかせになりまくっても突き進む。 <>
LightCone </b>◆sSJBc30S5w <b><><>02/10/22 23:22<> <a href="../test/read.cgi/tech/1027080631/738" target="_blank">&gt;&gt;738</a>,739,741 <br>  <br> 基本的には、面白そうなのですが、一つ注意することがあると思います。 <br>  <br>  <br> それは、カーネル自体を C++ で書いていたとしても、 <br> ユーザーレベルに公開するインターフェースとは別の話ではあることです。 <br>  <br> 例の様にドライバの機能を仮想関数で呼び出せるようにするには、 <br> 「ドライバの公開仕様」として、「仮想関数テーブル」を出す必要がある <br> ことになると思います。 <br>  <br> しかし、通常仮想関数テーブルは、コンパイラ依存になりますが、 <br> 正式なドライバの仕様は、もっと固定的で無ければならないわけで、 <br> 単純なコンパイラの吐くコードで直接カーネルから、ドライバの <br> 仮想関数を呼び出せるわけではないと思うのですが、どうですか。 <br>  <br>  <>
LightCone </b>◆sSJBc30S5w <b><><>02/10/22 23:23<> [#743の続き] <br>  <br> それと、ドライバであってもある程度の保護下で動かすのが普通ですので、 <br> ドライバを呼び出す際には「特権レベルの遷移」が必要です。 <br> 仮想関数呼び出しは、当然ならが、単純な near call が生成される <br> だけですので、そのままでは使えないと思います。 <br>  <br> 具体的には、スーパーバイザレベルに近いものへのコールは、 <br> コールゲートやトラップゲートなどを利用できるのですが、逆向きレベル <br> への遷移は、IA32 では iret 命令を使う方法しかないため、ドライバを <br> 非特権レベルで走行させるためには、通常のコンパイラで自動生成される <br> コードは使えないと思います。その辺はどうしても、インラインアセンブ <br> ラか、純粋なアセンブラで書く必要があると思います。 <br>  <br> 仮にドライバをカーネルと同一の保護レベルで動かすことにするとしても、 <br> メモリ空間などで、「断絶」がある可能性が高く、少なくとも、gcc など <br> が吐くコードを魔法の様に、ドライバとカーネルの垣根を越えて利用する <br> ことは出来ないと思います。 <br>  <br> ただし、カーネルを、C++ で記述するのは面白い試みだとは思いますので、 <br> どうなっていくか楽しみです。 <>
ひげぽん<><>02/10/22 23:31<> <a href="../test/read.cgi/tech/1027080631/741" target="_blank">&gt;&gt;741</a>さん <br> FreeBSD 2.x ではそのような仕組みが使われているのですね。 <br> 私のやりたい事に近いと感じました。 <br> 勉強になりましたありがとうございます。 <br>  <br> LightConeさん <br>  <br> 懸念事項までご指摘･アドバイスいただきありがとうございます。 <br> 確かに、ドライバーの場合、いろいろ問題がありそうですね。 <br> ドライバー作成者にどのような環境を用意するかというのも <br> 大きな問題だということが分かりました。 <br> ありがとうございます。 <br>  <br>  <br>  <>
LightCone </b>◆sSJBc30S5w <b><><>02/10/22 23:35<> <a href="../test/read.cgi/tech/1027080631/741" target="_blank">&gt;&gt;741</a> さん、こんばんは。 <br>  <br> そうでしょうね。Linux などでもそんな感じだったと思いますし、 <br> MS-DOS や CP/M でも似たようなものでしたし。 <br>  <br> ドライバに限らず、システム側からユーザーが作ったソフトウェアを <br> 呼び出すときには、似たり寄ったりになるのがある意味当然なのですね。 <br>  <br> N 個の公開関数があるときに、N 個の関数アドレスを出すか、 <br> 「関数アドレス取得関数のアドレス」を一つだけ出して、その <br> 関数で N 個の関数のアドレスを間接的に貰う方法等があると思います。 <br>  <br> 後者では、 <br> void (*EnumFuncAddr(int k))();  <br> みたいな関数を公開するわけですね。一つで N 個分を網羅できる <br> わけです。 <br>  <br>  <br> ioctl などは、一つの関数で、可変種類で、可変長パラメータ <br> の関数を公開しているようなものだと考えられると思いますが、 <br> これも、後者に近い方法ですね。 <br>  <br>  <br> いくらでも仕様のバリエーションあっても、根本的な部分 <br> では、何も変わらないわけですね。 <>
デフォルトの名無しさん<>sage<>02/10/23 00:05<> <a href="../test/read.cgi/tech/1027080631/743-744" target="_blank">&gt;&gt;743-744</a> <br> &gt;  それは、カーネル自体を C++ で書いていたとしても、 <br> &gt;  ユーザーレベルに公開するインターフェースとは別の話ではあることです。 <br>  <br> ユーザーと言うのがちょっと不明確。 <br> ドライバを書く人のことを言っているのか ? <br>  <br> &gt;  例の様にドライバの機能を仮想関数で呼び出せるようにするには、 <br> &gt;  「ドライバの公開仕様」として、「仮想関数テーブル」を出す必要がある <br> &gt;  ことになると思います。 <br> &gt;  しかし、通常仮想関数テーブルは、コンパイラ依存になりますが、 <br> &gt;  正式なドライバの仕様は、もっと固定的で無ければならないわけで、 <br> &gt;  単純なコンパイラの吐くコードで直接カーネルから、ドライバの <br> &gt;  仮想関数を呼び出せるわけではないと思うのですが、どうですか。 <br>  <br> ここは考え方次第。ドライバを書く人は、必ずこのコンパイラを使えというのもありだと思う。 <br> もちろん、各種の処理系でドライバを書きたいとなると、インターフェースは関数テーブル等のように処理系にできるだけよらないものにする必要はある。 <br> その場合でも、ドライバ用のライブラリを作ってドライバ自体は C++ で書けるようにするのがいいと思う。 <br>  <br> &gt; それと、ドライバであってもある程度の保護下で動かすのが普通ですので、  <br>  <br> の場合も基本的に同じ。これをやりたいなら、そこはインラインアセンブラ等で作成する必要はある。 <>
デフォルトの名無しさん<>sage<>02/10/23 00:06<> ドライバ <br> http://homepage2.nifty.com/rohizuka/ka/pa_003_a.htm <>
LightCone </b>◆sSJBc30S5w <b><><>02/10/23 00:34<> <a href="../test/read.cgi/tech/1027080631/747" target="_blank">&gt;&gt;747</a> <br> &gt;ユーザーと言うのがちょっと不明確。 <br> &gt;ドライバを書く人のことを言っているのか ? <br>  <br> そうです。 <br>  <br> 保護なし、同一セグメント、であるなら、可能でしょうね。 <>
LightCone </b>◆sSJBc30S5w <b><>sage<>02/10/23 00:36<> <a href="../test/read.cgi/tech/1027080631/748" target="_blank">&gt;&gt;748</a> <br> グロ画像（というか幽霊？） <>
デフォルトの名無しさん<>sage<>02/10/24 02:37<> lightﾀﾝ、こんばんは。 <br> lightﾀﾝ、ちゃんと足は生えてますか？ <>
デフォルトの名無しさん<>sage<>02/10/24 07:16<> <a href="../test/read.cgi/tech/1027080631/750" target="_blank">&gt;&gt;750</a> <br> グロではないかな。気持ち悪い人形。 <br> NWSOSの方、頑張ってくれい。 <>
デフォルトの名無しさん<>sage<>02/10/24 15:15<> nwsosもひげぽんも頑張れ。いつかゲイツを倒すのだ。 <>
ひげぽん<>sage<>02/10/25 00:18<> <a href="../test/read.cgi/tech/1027080631/753" target="_blank">&gt;&gt;753</a>さん <br> ありがとうございます。がんばります。 <br> Templateが使えるようになったので簡易版Vectorを追加しました。 <br> これでいろいろと楽になるかも･･･ <br>  <br> 今までで追加して便利だったのは簡易版printfの_sys_printfかな。 <br> debug時にすごい重宝します。 <br> でも16進表示機能が未実装なのが不満。 <br> やろうと思えばできるんだろうけど、 <br> どうしてもほかの事を優先してしまいますね。 <br> うーん。 <>
デフォルトの名無しさん<><>02/10/25 00:21<> gcc3.xで構築できないという件ですが。 <br> コンパイラに渡すオプションの-DBUILD_ON_LINUXを外せば構築できました。 <br> 動作することも確認しました。 <>
デフォルトの名無しさん<><>02/10/25 08:49<> <a href="../test/read.cgi/tech/1027080631/754" target="_blank">&gt;&gt;754</a> <br> いそがばまわれ。 <>
ひげぽん<><>02/10/25 21:09<> <a href="../test/read.cgi/tech/1027080631/756" target="_blank">&gt;&gt;756</a> <br> そのとおりですね。数年計画で進行中です。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/700" target="_blank">&gt;&gt;700</a>で <br> 募集していた。プロジェクトホームページを作ってくれる人が <br> 見つかりました。 <br> うれしい限りです。 <>
デフォルトの名無しさん<>age<>02/10/26 02:34<> disk reading.... と永遠に出続けるが、いったいどうしたものか... <>
デフォルトの名無しさん<>sage<>02/10/26 04:43<> HPの前に、そろそろ名前考えた方がよさげ。 <br>  <br> #いくらｶｺ(･∀･)ｲｲ!!HPでも、名前で(´･ω･`)ｼｮﾎﾞｰﾝ <>
デフォルトの名無しさん<>sage<>02/10/26 08:05<> OSの名前は「ひげぽん」でいいんでないの？ <br>  <>
ひげぽん<><>02/10/26 11:20<> <a href="../test/read.cgi/tech/1027080631/759" target="_blank">&gt;&gt;759</a> <br> &gt;HPの前に、そろそろ名前考えた方がよさげ。 <br> 前スレを読んでいただくと分かりますが <br> higepos(仮称)です。 <br>  <br> 確かに、そろそろ本気でいい名前を付けないといけませんね。 <br> ということで、 <br>  <br> higepos(仮称)の正式名称は何が良いかご意見をお聞かせください。 <br>  <br> ちなみに過去に挙がっていた名前は、 <br>  <br> ・GATES FREE <br> ・2chOS <br> ・2chdows <br> ・超ひげぽん　 <br>  <br> ｶｺ(･∀･)ｲｲ!!のをお願いします <>
名無しさん<>sage<>02/10/26 14:39<> ゲイツクライシス <>
ひげぽん<>sage<>02/10/26 16:22<> <a href="../test/read.cgi/tech/1027080631/754" target="_blank">&gt;&gt;754</a> <br> &gt;今までで追加して便利だったのは簡易版printfの_sys_printfかな。 <br> &gt;debug時にすごい重宝します。 <br> &gt;でも16進表示機能が未実装なのが不満。 <br> 実装しました。 <br> 便利っす。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/762" target="_blank">&gt;&gt;762</a> <br> なんか強そうな名前・・・ <br>  <>
 <>sage<>02/10/26 20:44<> ゲイツバスター <>
ひげぽん<><>02/10/26 23:41<> <a href="../test/read.cgi/tech/1027080631/764" target="_blank">&gt;&gt;764</a> <br> やっぱり強そう。 <br> 2chos(ニコス)なーんて案もあります。 <br>  <br> 今日はキーボードドライバーを書いてました。 <br> なかなか難しいですね。 <>
デフォルトの名無しさん<><>02/10/27 00:02<> OS mou 3 <br> お相撲さん <>
デフォルトの名無しさん<>sage<>02/10/27 00:14<> CHAOS is Higepon's Another Operating System <>
デフォルトの名無しさん<>sage<>02/10/27 00:21<> explosion <>
ひげぽん<><>02/10/27 00:22<> <a href="../test/read.cgi/tech/1027080631/766" target="_blank">&gt;&gt;766</a> <br> しゃれ系も良いですが、英語圏の人は面白さが分からないかも。 <br> 2004年バージョンは、OS mou 3 2004 <br> ここまで来ると暗号です。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/767" target="_blank">&gt;&gt;767</a> <br> Gnuっぽいですね。かっちょいい。 <br> でもなんだか、OSが安定していないイメージを受けますね。 <br>  <>
ひげぽん<>sage<>02/10/27 00:36<> ・GATES FREE <br> ・2chOS <br> ・2chdows <br> ・超ひげぽん <br> ・ゲイツクライシス <br> ・ゲイツバスター <br> ・2chos <br> ・OS mou 3 <br> ・CHAOS <br> ・explosion <br>  <br> 皆さんの一押しはどれでしょう。 <br> 2chに関連する名前たちは捨てがたいですね。 <>
デフォルトの名無しさん<>sage<>02/10/27 00:43<> cha-OS だなぁ <br> yaccみたい <>
デフォルトの名無しさん<>sage<>02/10/27 00:45<> ﾋｹﾞﾎﾟｿはどういうOSめざしてるんですか？ <br> それによって以下略 <br> 過去ログ読むの面倒以下略 <>
超先生@OS板  </b>◆mz/OS/KoRM <b><>sage<>02/10/27 00:58<> OS/RealReality ・・・どうすれバインダ。 <>
ひげぽん<>sage<>02/10/27 01:02<> <a href="../test/read.cgi/tech/1027080631/772" target="_blank">&gt;&gt;772</a> <br> ・多くの人に使ってもらえるOS <br> ・フリーのOS <br> ・日本発信のOS <br> ・いい意味で過去の遺産を引き継がないOS <br> ・使いやすくて、センスのあるインターフェースを持つOS <br> ・内部の実装が出来るだけシンプルなOS <br> ・もちろんマルチタスク <br>  <br> うわー、現段階ではほとんどさっぱり実現できていない。 <br> 大きな事ばかり言っていますが、あまり突っ込まないでください・・・ <br>  <>
ひげぽん<>sage<>02/10/27 01:04<> <a href="../test/read.cgi/tech/1027080631/773" target="_blank">&gt;&gt;773</a> ：超先生@OS板さん <br>  <br> お久しぶりです。 <br> いつぞやアドバイスいただきありがとうございました。 <br>  <br> &gt;&gt;OS/RealReality ・・・どうすれバインダ。 <br> 解説をお願いいたします <br>  <>
デフォルトの名無しさん<>sage<>02/10/27 01:23<> ・GikOS <br> ギコ猫のAAをフラッシュに使用。 <br>  <br> 　　　　　　∧ ∧　 ／￣￣￣￣￣￣￣￣￣￣￣￣￣ <br> 〜′￣￣( ﾟДﾟ)＜　逝ってよし！ <br> 　UU￣￣　U U　　＼＿＿＿＿＿＿＿＿＿＿＿＿＿ <br>  <br>  <br> ・AssOS <br> アッソーのAAをフラッシュに使用。 <br> | 　　。 <br> |⌒ヾ <br> |冫、） <br> |` ／ ジー <br> | / <br> |/ <br> | <br>  <br>  <br> ・はシラネーヨ <br>  <br> 　　 ∧ ∧　　　 ┌───────── <br> 　　( ´ー｀)　　 ＜　はシラネーヨ <br> 　 　＼　&lt; 　 　　└───/|──── <br> 　　　　＼.＼＿＿＿＿__／/ <br> 　　　　　 ＼　　　　　　　／ <br> 　　　　　　　∪∪￣∪∪ <br>  <>
デフォルトの名無しさん<>sage<>02/10/27 01:30<> ・Zonux <br> 　　　 ／￣￣￣￣＼ <br> 　　／　　　　 ●　　●､　　　　　　＿＿＿＿＿ <br> 　　|Y　　Y　　　　　　　 ＼ 　　／ <br> 　　| |　　 | 　　　　　　 ▼ |　＜　ぞぬっす <br> 　　| ＼／　　　　　　＿人.|　　＼＿＿＿＿＿ <br> 　　|　　　　　　 ＿＿＿ノ <br> 　　＼　　　 .／ <br> 　　　｜ ｜　| <br> 　　　（_＿）＿） <br>  <br> ・DomOSumimasen <br> 　＿＿＿＿＿＿＿＿ <br> 〈　ﾄﾞｳﾓｽﾐﾏｾﾝ <br> 　∨￣￣￣￣￣￣￣ <br> 　（´Д｀;）ヾ <br> 　　　∨） <br> 　　　（（ <br>  <br> ・UmaibOS <br> うまい棒っす <>
デフォルトの名無しさん<>sage<>02/10/27 01:32<> 最初のアプリはやっぱ2chブラウザっすね。 <>
デフォルトの名無しさん<>sage<>02/10/27 01:39<> コードが出てこないとすぐ<a href="../test/read.cgi/tech/1027080631/778" target="_blank">&gt;&gt;778</a>みたいなのが出てくるんだよな <>
デフォルトの名無しさん<>sage<>02/10/27 02:11<> <a href="../test/read.cgi/tech/1027080631/770" target="_blank">&gt;&gt;770</a> <br> その中でというのならCHAOS。 <>
デフォルトの名無しさん<>sage<>02/10/27 02:30<> 漏れもCHAOSかな。 <br> CHAOSで真っ先に浮かんだイメージは『無限の可能性を秘めてる』だった。漏れはね。 <>
デフォルトの名無しさん<>sage<>02/10/27 03:22<> Zonux <br>  <br> ｲｲ━━━━━(ﾟ∀ﾟ)━━━━━!!!! <>
デフォルトの名無しさん<>sage<>02/10/27 03:52<> 「Swodniw」 ってのはどう？ <br>  <>
FreeDOS教徒<>osage<>02/10/27 10:48<> <a href="../test/read.cgi/tech/1027080631/758" target="_blank">&gt;&gt;758</a> <br> たぶん一度に読むセクタ数が問題かと‥‥ <br>  <br> &gt;&gt;ひげぽ <br> ChaOSはすでにLEGO MINDSTORMS用OSとして存在してます。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/783" target="_blank">&gt;&gt;783</a> <br> なんて読むんですか？ <>
デフォルトの名無しさん<>sage<>02/10/27 10:53<> ひげだけに「Whiskers」。 <>
ひげぽん<><>02/10/27 11:56<> ・GATES FREE <br> ・2chOS <br> ・2chdows <br> ・超ひげぽん <br> ・ゲイツクライシス <br> ・ゲイツバスター <br> ・2chos <br> ・OS mou 3 <br> ・CHAOS         --すでに使われている名前なので却下 <br> ・explosion <br> ・GikOS <br> ・AssOS <br> ・はシラネーヨ <br> ・Zonux <br> ・DomOSumimasen <br> ・Swodniw <br> ・Whiskers <br>  <br> 今のところ上記のものが候補に上がっています。 <br> ただ、日本語表記のもは難しいかも。 <br> ひげぽん的には、2chos,2chOS,GikOS,Zonux,Whiskersかな。 <br>  <>
デフォルトの名無しさん<>sage<>02/10/27 12:03<> Zonuxに一票！ <>
戸塚ヨット<><>02/10/27 12:36<> つーかassOSって・・・。assかよ <br> GikoOSに一票 <>
デフォルトの名無しさん<><>02/10/27 13:51<> higeposがいいと思うなあ <>
デフォルトの名無しさん<>sage<>02/10/27 15:08<> <a href="../test/read.cgi/tech/1027080631/789" target="_blank">&gt;&gt;789</a> <br> 俺も〜〜〜。 <>
デフォルトの名無しさん<>sage<>02/10/27 16:39<> 知らない間にELF32用でも起動するようになっていた。もうクロスは不要ですな。 <>
デフォルトの名無しさん<>sage<>02/10/27 18:26<> <a href="../test/read.cgi/tech/1027080631/788" target="_blank">&gt;&gt;788</a> <br> 糞OS <br>  <br> ｲｲ━━━━━(ﾟ∀ﾟ)━━━━━!!!! <br>  <>
デフォルトの名無しさん<>sage<>02/10/27 18:53<> おまいら・・・名前を決めるより先にまだやるべきことｲﾊﾟｰｲあるだろ(w <br> せめてkernelに相当する部分だけでも完成してから議論しる。 <br> まだメモリ管理がやっとこできたかどうかで笑わせんな。(w <br>  <>
デフォルトの名無しさん<>sage<>02/10/27 19:46<> <a href="../test/read.cgi/tech/1027080631/793" target="_blank">&gt;&gt;793</a> <br> ﾔﾚﾔﾚ <>
FreeDOS教徒<>osage<>02/10/27 21:32<> Gikos <br> なんとなく複数形。もちろん起動画面は大量のギコで(w <>
ひげぽん<>sage<>02/10/27 21:54<> GikoのAAで純粋に、半角英数記号Onlyでかっこいいやつあるのかな？ <br>  <br> Gikoに限定しないけど、起動画面に表示するなら <br> 使える文字がかなり限られる。 <>
デフォルトの名無しさん<>sage<>02/10/27 22:13<> <a href="../test/read.cgi/tech/1027080631/796" target="_blank">&gt;&gt;796</a> <br> 最初から２バイト文字前提で作っちゃダメなんか？ <br>  <>
ひげぽん<>sage<>02/10/27 22:19<> <a href="../test/read.cgi/tech/1027080631/797" target="_blank">&gt;&gt;797</a> <br> 現在のhigeposでは表示出来ぬのです。 <br> 申し訳ありませんが、できれば2byte文字は避けていただきたい。 <>
デフォルトの名無しさん<>sage<>02/10/27 23:11<> ネイティブでUnicodeサポートだ。ｶﾞﾝｶﾞﾚ! <>
デフォルトの名無しさん<>sage<>02/10/27 23:25<> &gt;&gt;「Swodniw」 ってのはどう？ <br> なるほど、逆読みか。 <br>  <>
デフォルトの名無しさん<>sage<>02/10/27 23:37<> <a href="../test/read.cgi/tech/1027080631/799" target="_blank">&gt;&gt;799</a>の機能を実装して、nortにしてくだちい。 <>
デフォルトの名無しさん<>sage<>02/10/28 03:51<> Unicodeはアプリケーションレイヤの話しじゃないの？ <>
デフォルトの名無しさん<>sage<>02/10/28 03:54<> <a href="../test/read.cgi/tech/1027080631/802" target="_blank">&gt;&gt;802</a> <br> それをKernelレベルでやれと言っておる <>
デフォルトの名無しさん<>sage<>02/10/28 04:08<> コードを扱うのはロケールを管理するドライバかナニカに任せて <br> OSはなんもしない方がいいと思うけどね。 <br>  <>
デフォルトの名無しさん<>sage<>02/10/28 04:34<> 起動時にBMPを表示させる。と言ってみるテスト <>
デフォルトの名無しさん<>sage<>02/10/28 11:46<> ここはシンプルに"Higex" <br>  <br> Higex(･∀･)ｲｲ!! <>
デフォルトの名無しさん<>age<>02/10/28 12:39<> 何に盛り上がってんのかと思えば名前か。 <br> SPATRA〜スパトラ <>
ひげぽん<><>02/10/28 20:50<> <a href="../test/read.cgi/tech/1027080631/709" target="_blank">&gt;&gt;709</a>,802,803,804,805 <br> higeposにおいて、国際化をどう扱うかは一切決めていません。 <br> まだまだ先にやらなければいけないことが山ほどあるので・・・ <br> という事で現時点では半角英数字記号しか出力できません。 <br>  <br> 国際化の資料といえばInterface12月号は、なかなか勉強になりました。 <br>  <br> OSの名前ですが <br> ・ひげは出来るだけ卒業　ex)higepos,higex <br> ・商標問題がありそうなのは避ける　ex)Giko,モナー <br> という方針でいくと何が残るんだろう･･･ <br>  <br>  <>
ひげぽん<><>02/10/28 21:35<> http://higepos.sourceforge.jp/に <br> 現在の最新のhigeboot.binをuploadしました。 <br> 自環境でmake出来ない場合にお使いいただけたらと思います。 <>
デフォルトの名無しさん<><>02/10/28 21:46<> マイクロカーネルの方向っすか？ <>
ひげぽん<>sage<>02/10/28 21:51<> <a href="../test/read.cgi/tech/1027080631/810" target="_blank">&gt;&gt;810</a> <br> 一応予定ではですが･･･ <>
デフォルトの名無しさん<><>02/10/28 21:56<> 一つ言ってｲｲ？ <br> 今作っているの？ <>
ひげぽん<>sage<>02/10/28 22:01<> <a href="../test/read.cgi/tech/1027080631/812" target="_blank">&gt;&gt;812</a> <br> OSを現在作っているのかというご質問であれば <br> はい、作っています。 <br>  <>
</b> ◆kXn47FN4zU <b><>age<>02/10/28 22:34<> レスがほしい807です。 <br> Spicy <br> P? <br> A? <br> Try <br> Revolution <br> A? <br> これだけしか思いつかないでつ、カフっ。 <>
デフォルトの名無しさん<><>02/10/28 22:42<> <a href="../test/read.cgi/tech/1027080631/809" target="_blank">&gt;&gt;809</a> <br> ひげぼんさん <br> これは、どうやってインストールすればいいのかな？ <>
ひげぽん<>sage<>02/10/28 22:42<> <a href="../test/read.cgi/tech/1027080631/807" target="_blank">&gt;&gt;807</a>,814 <br> 申し訳ありません。 <br> &gt;SPATRA〜スパトラ <br> Spicy <br> Portable <br> A? <br> Try <br> Revolution <br> Architecture <br> 思いつきません。 <>
ひげぽん<>sage<>02/10/28 22:47<> <a href="../test/read.cgi/tech/1027080631/815" target="_blank">&gt;&gt;815</a> <br> x86エミュレータbochsを使う場合、 <br> higeboot.binをフロッピーイメージに指定すればよいです。 <br> vmwareでもほぼ同様です。 <br>  <br> フロッピーにインストールしたい場合 <br> unix系 <br> 　ddコマンドでhigeboot.binを書き込む。 <br> Windows <br> 　rawrite.exeというアプリケーションでhigeboot.binをかきこむ。 <br> 書き込んだら、フロッピーを起動させたいマシンに挿入して <br> リブートでいけるはずです。 <br> ただし何が起きても一切責任はもてませんのでご了承ください。 <br>  <>
</b> ◆kXn47FN4zU <b><>age<>02/10/28 22:57<> レスを強要するような庫とを書いてすみませんでした。 <br> Portable思いつかなかったです。安易にいくとこんな感じに <br> Spicy <br> Portable <br> And <br> Try <br> Revolution <br> Architecture <>
ひげぽん<>sage<>02/10/28 23:09<> <a href="../test/read.cgi/tech/1027080631/818" target="_blank">&gt;&gt;818</a> <br> いえいえ、基本的にレスを返そうと思っているのですが <br> 見落としていました。 <br> SPATRAは、chaos系ですね。 <>
名無しさん<>sage<>02/10/29 07:07<> Zonuxに一票。 <>
デフォルトの名無しさん<>sage<>02/10/29 07:08<> adidos <>
</b> ◆kXn47FN4zU <b><>sage<>02/10/29 07:42<> <a href="../test/read.cgi/tech/1027080631/819" target="_blank">&gt;&gt;819</a> <br> いえ、スパトラは語感のみです。 <br> アルファベットは1byte指定に合わせて適当に振りました。 <br> 意味の方は、レス欲しさに付けたおまけです。フルネームは <br> SPATRA Operating System <>
デフォルトの名無しさん<><>02/10/29 08:19<> Microkernel <br> Operating system <br> Named <br> After <br> eXcitement <br>  <br> 祭りにちなんで名づけられたマイクロカーネルOS <br> MONAX <>
LightCone </b>◆sSJBc30S5w <b><>sage<>02/10/29 08:28<> ひげぽんさん、こんにちは。 <br>  <br> #809 のイメージから、 <br> Win2000 の、cygwin で、dd if=higeboot.bin of=/dev/fd0 <br>  <br> としてブートディスクを作ってみたところ、起動画面にはなりますが、 <br> disk reading ... が表示されつづけたままになりました。 <br> 起動を試した機種は、ノート型の、FUJITSU FMV-5233 NA/X (BIBLO) です。 <>
LightCone </b>◆sSJBc30S5w <b><>sage<>02/10/29 08:36<>  <br> http://cvs.sourceforge.jp/cgi-bin/viewcvs.cgi/higepos/higepos_v1.1/src/firstboot.asm?rev=1.2&content-type=text/vnd.viewcvs-markup <br>  <br> このソースを見て気付くのは、ss=cs に設定しているのに、 <br> sp の初期化がされていないことです。 <br>  <br> mov ax,cs <br> mov ss,ax            ;自動的に直後の命令実行中はcli <br> mov sp,7c00h <br>  <br> としてみてください。 <>
LightCone </b>◆sSJBc30S5w <b><>sage<>02/10/29 09:20<> 'disk reading ...' を繰り返す理由が恐らく判明しました。 <br>  <br> #825 のソースで、mov ah,02h, int 13h で、cf=1 のときそのまま <br> 繰り返していることに原因がありそうです。 <br>  <br> PC/AT の BIOS では、int 13h で失敗した時は、必ず <br> mov ah,00h, int 13h を実行して、disk reset しなければ <br> なりません。そうしないと何度でも失敗します。 <br>  <br> 私も PC-98x1 から移行したとき、ここではまりました。 <br> これで、この現象はfixされると思います。 <>
デフォルトの名無しさん<>sage<>02/10/29 09:43<> higepos は doxygen 準拠のソースっぽいですが、 <br> どこかに doxygen の吐き出したドキュメントがあったりするのでしょうか？ <>
デフォルトの名無しさん<><>02/10/30 00:34<> とりあえずマイルストーン決めて、目標バージョン番号とコードネーム決めよう <>
デフォルトの名無しさん<>sage<>02/10/30 16:28<> （´-`）.｡oO（<a href="../test/read.cgi/tech/1027080631/828" target="_blank">&gt;&gt;828</a>みたいな奴どうにかしてほしいな) <>
デフォルトの名無しさん<><>02/10/30 18:28<> ひげぽす <>
デフォルトの名無しさん<><>02/10/30 19:25<> オミクロン萌え。 <>
デフォルトの名無しさん<><>02/10/30 20:38<> ひげぽすやってみたくてBOCHSをDLしたまでいいけど <br> 詳しい起動法がわからない・・・ <br>  <br> bochs.exe -&gt; メインメニューで1を選択 -&gt; higeboot.binで開く <br> じゃ違うのか？ <>
デフォルトの名無しさん<>sage<>02/10/30 22:43<> <a href="../test/read.cgi/tech/1027080631/832" target="_blank">&gt;&gt;832</a> <br> &gt; じゃ違うのか？ <br> OSが分からんけど違う。higepos.binがあるディレクトリにbochsrc.txtを作成 <br> した方が楽だと思う。bochsrc-sample.txtみたいなファイルがどこかにあれば <br> それを修正するのが吉。 <>
ひげぽん<><>02/10/30 23:26<> レスが遅くなりすいません。 <br> 平日はなかなか忙しい･･･ <br>  <br> <a href="../test/read.cgi/tech/1027080631/823" target="_blank">&gt;&gt;823</a> <br> MONAXいいかも。Monax・・・ <br> ところでLinux,Monax みたいに最後にxつくと <br> unixクローンて誤解されるのかな？ <br>  <br> &gt;&gt;LightConeさん <br> 返事が遅くなりまして申し訳ありません。 <br> バイナリを試していただいたようで <br> ありがとうございます。しかもBugおよび <br> 修正箇所まで指摘していただいてありがとうございます。 <br> 週末にでも確認･修正して、反映させていただきます。 <br>  <>
ひげぽん<><>02/10/30 23:33<> <a href="../test/read.cgi/tech/1027080631/827" target="_blank">&gt;&gt;827</a> <br> &gt;higepos は doxygen 準拠のソースっぽいですが、  <br> &gt;どこかに doxygen の吐き出したドキュメントがあったりするのでしょうか？  <br> 今はどこにおいていません。 <br> もし、higeposをMake出来る環境があり、doxygenがインストールされていれば <br> Make時に生成されます。 <br> ご希望であればどこかに置きますよ。 <br>  <br> &gt;とりあえずマイルストーン決めて、目標バージョン番号とコードネーム決めよう  <br> 今のところOS名が決まればいいかなと考えています。 <br> マイルストーンを決めても気分次第でふらふらしそうですし（笑） <br>  <>
ひげぽん<><>02/10/30 23:37<> <a href="../test/read.cgi/tech/1027080631/832" target="_blank">&gt;&gt;832</a>さんのbochsの使用方法について <br> <a href="../test/read.cgi/tech/1027080631/833" target="_blank">&gt;&gt;833</a>さんフォローありがとうございます。 <br>  <br> .bochsrcの関係ありそうな部分抜粋 <br> vgaromimage: ./VGABIOS-elpin-2.40 <br> boot: a <br> floppya: 1_44=../../higepos_v1.1/bin/higeboot.bin, status=inserted <>
832<><>02/10/31 07:35<> <a href="../test/read.cgi/tech/1027080631/833" target="_blank">&gt;&gt;833</a> , &gt;&gt;ひげぽん <br> ｻﾝｸｽです。 <br> 早速試してみます <br> ちなみにＯＳはWinMeです。 <>
デフォルトの名無しさん<><>02/10/31 09:48<> <a href="../test/read.cgi/tech/1027080631/834" target="_blank">&gt;&gt;834</a> <br> POSIXになんとなく準拠していく予定ってことにしとけば最後にXついててもいいんじゃない？ <br>  <br> EXCITEMENT（騒動、騒ぎ）のXでそれ以上深く考えなくてもいいと思うけど。（笑） <br> 祭りってのは若干意訳な気もするけど、まあ、いわゆる２ｃｈの「祭り」と考えれば意味はあってる。 <>
832<><>02/10/31 16:08<> 00000000000i[     ] using log file bochsout.txt <br> って出るのはどう対処すればいいんでしょうか… <br> これが出たあとちょっとしてからBochsが終了します。 <>
832<><>02/10/31 16:29<> 解決 <>
がんばれひげぽん<><>02/11/01 00:04<> ひげぽんに影響されて、 <br>  <br>     オペレーティングシステム＜第二版＞ 設計と理論およびMINIXによる実装」  <br>     著：A.S.タネンバウム ＋ A.S.ウッドハル  <br>     訳：千輝 順子  <br>     監修：今泉 貴史  <br>     プレンティスホール出版 ￥8,800  <br>  <br> かって読んだんだけど・・・・・・ <br> 何を書いてあるのか全くわかりません。 <br> こんなの読んでわかる人いるの？ <br>  <br> というか、わかる人は今までどんな人生送ってきたのよ？ <>
デフォルトの名無しさん<><>02/11/01 01:29<> 理学部数学科とか工学部情報工学科とかで暗い人生では？ <>
デフォルトの名無しさん<>sage<>02/11/01 01:31<> 普通に文系だけどなんとなくなら分ったよ。 <br> 実際にコードいじるとなると全然次元が違うけど。 <>
電波５号<><>02/11/01 04:05<> 今日このスレッドをみつけて面白かったので <br> 全部よみました。 <br> 前スレは読んでいません。 <br> 僕はプログラミングは得意じゃないですが <br> Monaxに一票・・・とかだ投稿させて頂きます。 <>
デフォルトの名無しさん<>sage<>02/11/01 06:05<> <a href="../test/read.cgi/tech/1027080631/841" target="_blank">&gt;&gt;841</a> <br> それはOS関係では古典的かつ易しい部類の本だぞ <br> いわば基本 <>
戸塚ヨット<>sage<>02/11/01 17:10<> <a href="../test/read.cgi/tech/1027080631/841" target="_blank">&gt;&gt;841</a> <br> &gt;何を書いてあるのか全くわかりません。  <br> どんなことがわからないの？ <>
デフォルトの名無しさん<>sage<>02/11/01 17:32<> <a href="../test/read.cgi/tech/1027080631/846" target="_blank">&gt;&gt;846</a> <br> 多分日本語が読めてない。 <br> 多分ちょn <>
デフォルトの名無しさん<><>02/11/01 19:14<> 大変幸運なことに、Monolithicの頭文字もMである。 <>
デフォルトの名無しさん<>sage<>02/11/01 19:20<> マナマナの頭文字もMという罠。ｶﾞｸｶﾞｸ(ﾟДﾟ;)ﾌﾞﾙﾌﾞﾙ <>
デフォルトの名無しさん<>sage<>02/11/01 21:25<> <a href="../test/read.cgi/tech/1027080631/849" target="_blank">&gt;&gt;849</a> <br> エロゲ板へ(･∀･)ｶｴﾚ! <>
ひげぽん<><>02/11/01 23:25<> <a href="../test/read.cgi/tech/1027080631/841" target="_blank">&gt;&gt;841</a> <br> &gt;かって読んだんだけど・・・・・・ <br> &gt;何を書いてあるのか全くわかりません。 <br> &gt;こんなの読んでわかる人いるの？ <br> &gt;というか、わかる人は今までどんな人生送ってきたのよ？ <br>  <br> <a href="../test/read.cgi/tech/1027080631/845" target="_blank">&gt;&gt;845</a> <br> &gt;それはOS関係では古典的かつ易しい部類の本だぞ <br> &gt;いわば基本 <br>  <br> まじめにレスします。 <br> ひげぽんはかなり理解力がないので、1回目に軽く目を通したとき <br> 5%位しか理解できませんでした。 <br> その後読んでみた感想は、 <br> 1章オペレーティングシステム概論→まあ言っていることは分かるかな？ <br> 2章プロセス→プロセスの競合等の理論はなんとなく分かったが、実際実装してみないと分からないかな･･ <br> 3章入出力→つまみ食い程度・・・まだちゃんと読んでない。 <br> 4章メモリ管理→カーネル内メモリ管理の実装の前に熟読しました。でも理解したのは40%位かな。 <br> 5章ファイルシステム→面白かったです。iノードとか勉強になります。一番理解したかも･･ <>
ひげぽん<>sage<>02/11/01 23:27<> <a href="../test/read.cgi/tech/1027080631/848" target="_blank">&gt;&gt;848</a> <br> Monaxいいかも。 <>
デフォルトの名無しさん<><>02/11/01 23:58<> おい、おまいら！ <br> Woodchuck(ウッドチャック)っつー北米産のリスの学名が <br> Marmota monax だぞ！！！！ <br>  <br> http://museum.nhm.uga.edu/gawildlife/mammals/rodentia/sciuridae/mmonax.jpg <br>  <br> 早くもマスコットが決定ｗ <br>  <br> オライリーの表紙に使ってもらえ。 <>
ブー<><>02/11/02 00:03<> ひげぽんさん、先ほどは私が立てたスレにお越しいただきありがとうございます。 <br> 私もOSを作ってみたいと思っていたのですが、その力がないのと、 <br> なかなか行動に移せないでいました。 <br> ですが、このひげぽんさんのスレをみて、私もOSを作成する決心がつきました。 <br>  <br> 私は、ひげぽんさんのずっと後ろのほうにいますが、早く追いつくように、 <br> がんばって行きます。 <br> 先を行っているひげぽんさんに、質問させていただくときがあると思いますが、 <br> そのときは、なにとぞよろしくお願いします。 <>
デフォルトの名無しさん<>sage<>02/11/02 00:05<> <a href="../test/read.cgi/tech/1027080631/852" target="_blank">&gt;&gt;852</a> <br> ひげぽん殿、 <br> そういえばファイルシステムどーいう形式にすんの？ <br> あと、プロセス管理とかは？マルチスレッド対応するんでつか？ <br> プロセス管理わかんねならシングルタスクOSにするのもありかも。(w <br>  <>
ひげぽん </b>◆Ngzcp/NZpA <b><><>02/11/02 00:08<> <a href="../test/read.cgi/tech/1027080631/854" target="_blank">&gt;&gt;854</a>さん <br> お互いプログラム版@2chで成長して行けると良いですね。 <br> 是非いろいろ情報交換させてください。 <>
ひげぽん </b>◆Ngzcp/NZpA <b><><>02/11/02 00:13<> <a href="../test/read.cgi/tech/1027080631/855" target="_blank">&gt;&gt;855</a> <br> &gt;ひげぽん殿、 <br> &gt;そういえばファイルシステムどーいう形式にすんの <br> FDDの間は、FAT12にするのが有力ですが、勉強のため <br> ヘボファイルシステムを実装するかもしれません。 <br>  <br> プロセス管理は、マルチタスクにするのが目標です。 <br> 分かるまで勉強するつもりです。 <br> マルチスレッドに対応するかどうかは、まだ考えていません。 <>
FreeDOS教徒<>osage<>02/11/02 00:55<> こんなのつくりますた。 <br> http://guriponn.tripod.co.jp/guri/2chos.lzh <br> 日本語表示できなくても、起動時はこれで大丈夫？ <>
デフォルトの名無しさん<>sage<>02/11/02 02:16<> 最高！、ﾜﾗﾀよ。 <>
デフォルトの名無しさん<><>02/11/02 03:06<> レベル高いな <>
デフォルトの名無しさん<>sage<>02/11/02 03:08<> この程度でか？ <>
デフォルトの名無しさん<>sage<>02/11/02 03:13<> <a href="../test/read.cgi/tech/1027080631/861" target="_blank">&gt;&gt;861</a> <br> あんたは、何か作ったのか？ <br> その言葉は実際に作ってからいえ。 <>
FreeDOS教徒<>osage<>02/11/02 11:05<> <a href="../test/read.cgi/tech/1027080631/859" target="_blank">&gt;&gt;859</a> <br> そう言われるとネタ準備してよかったなと思いまス。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/860" target="_blank">&gt;&gt;860</a> <br> 実はたくさん手抜きしてます。まあ動いたからよかったな、と。 <br> まともなAAに書き換えたりしたやつを上げときました。 <>
ひげぽん<><>02/11/02 12:50<> &gt;&gt;FreeDOS教徒殿 <br> おもしろいっす。最高です。 <br> こいつをhigeposで実現するのは難しいでせうか？ <br> どういう技術を使っているのかいまいちピンときません。 <>
デフォルトの名無しさん<>sage<>02/11/02 13:14<> ブートさせたあとに、メモリ内のイメージを表示させてるんじゃないの？ <br> ダンプしてみたら"FF FD FD FF FF"ってな具合に出てきたから、 <br> で、キーボードを押したらリセットすると、 <br>  <br> 逆アセンブラとか使ってみたらいいじゃん？＞ひげぽん <br>  <>
デフォルトの名無しさん<>sage<>02/11/02 16:51<> まさかx86で走らせるのですか？ <>
デフォルトの名無しさん<>sage<>02/11/02 17:03<> いいえ、8080です。 <>
超先生@OS板  </b>◆mz/OS/KoRM <b><>sage<>02/11/02 17:11<> この手のプラットフォームとしてはP/ECEが最強！ <br> ttp://www.piece-me.com/ <>
デフォルトの名無しさん<>sage<>02/11/02 17:18<> <a href="../test/read.cgi/tech/1027080631/868" target="_blank">&gt;&gt;868</a> <br> いや、それならWSの方が遙かに良いと思うんだが… <>
デフォルトの名無しさん<>sage<>02/11/02 17:39<> WSではOSレベルでいじれませんよ。 <br> P/ECEはカーネルからなにから全部いじれる。 <>
デフォルトの名無しさん<>sage<>02/11/02 17:50<> WSってBIOSじゃなくてOSなの？ <br> ぜんぜん知らんかった…というより、ﾓｯﾃﾅｲ。 <>
デフォルトの名無しさん<>sage<>02/11/02 17:54<> WSっていうか、うぃっち？ <>
デフォルトの名無しさん<>sage<>02/11/02 20:42<> Linux (not closs)で <br> [CPU  ] exception(): 3rd exception with no resolution <br> になりました。FDCDriver.cppの変更後です。 <br> # 昨日までは大丈夫だったんだけどなー <>
832<><>02/11/02 21:23<> <a href="../test/read.cgi/tech/1027080631/858" target="_blank">&gt;&gt;858</a> <br> これがひげぽすの起動画面になったら（・∀・）ｲｲ!な・・・ <>
デフォルトの名無しさん<><>02/11/02 21:26<> ketype は普通のキーと重複しないように２５６あたりからはじめないと， <br> いけないんじゃないかな。 <>
デフォルトの名無しさん<><>02/11/02 21:32<> ）873 <br>  <br> higeKenel.cppのｖｅｃｔｏｒのテストの辺りじゃないかな。 <>
デフォルトの名無しさん<><>02/11/02 21:42<>  isShift_ = (modifiers & KEY_MODIFIER_UP) ? false : true; <br> これって， <br>  isShift_ = !(modifiers & KEY_MODIFIER_UP)  <br> と同じじゃない？ <>
ひげぽん<><>02/11/02 21:45<> <a href="../test/read.cgi/tech/1027080631/873" target="_blank">&gt;&gt;873</a>,876 <br> 申し訳ありません。現在調査中です。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/877" target="_blank">&gt;&gt;877</a> <br> 仰るとおりです。あとで直しときます。 <br> ソースを公開するとバカコードが発見されて品質が上がります(涙) <br> ご指摘ありがとうございます。へこみますた。 <br>  <>
デフォルトの名無しさん<>sage<>02/11/02 21:55<> <a href="../test/read.cgi/tech/1027080631/876" target="_blank">&gt;&gt;876</a> <br> &gt; higeKenel.cppのｖｅｃｔｏｒのテストの辺りじゃないかな。 <br> Bochs上に "idt set done\n" が出力されないので、その前かもしれません。 <br> よく分からんです。ちょっと調べてみます。 <br> # 報告無かったら分からんかったと言うことでスマソ <br>  <>
デフォルトの名無しさん<><>02/11/02 22:16<> ＞879 <br> テストの部分をコメントアウトしてみれば，すぐにわかります。 <>
デフォルトの名無しさん<>sage<>02/11/02 22:20<> ＯＳ上でＯＳと同様に動かせるＯＳもどきなら作れるんだけどなぁ。。。（藁 <br> みなさん凄いです。 <>
デフォルトの名無しさん<>sage<>02/11/02 22:29<> <a href="../test/read.cgi/tech/1027080631/880" target="_blank">&gt;&gt;880</a> <br> &gt; テストの部分をコメントアウトしてみれば，すぐにわかります。 <br>     _sysUnlock(); <br> をコメントアウトしたら <br> [CPU  ] exception(): 3rd exception with no resolution <br> が無くなりました。当然動きませんが ;-) <>
PJメンバ<>sage<>02/11/03 00:45<> 原因はバイナリの大きさがfirstboot.asmで読み込んでる大きさを超えたた <br> めのようです。 <br> が、読み込む量を増やそうとしても今度は一定量以上読み込ませようとする <br> とそこで止まってしまう現象が起きるようです。 <br>  <br> ということで差し戻しを行いました。お騒がせしました。 <>
デフォルトの名無しさん <><>02/11/03 02:19<> &gt;&gt; FDDの間は、FAT12... <br> 役に立つかどうかわかりませんが、Interface誌2001年7月号に、 <br> FATの概要があります。 <>
ひげぽん<><>02/11/03 15:02<> <a href="../test/read.cgi/tech/1027080631/884" target="_blank">&gt;&gt;884</a>さん <br> 情報ありがとうございます。バックナンバーあるかな･･･ <br> <a href="../test/read.cgi/tech/1027080631/883" target="_blank">&gt;&gt;883</a> <br> ということでhigeposPJメンバーが改善に努めております。 <br> 今しばらくお待ちください。 <br> 悪いのはひげぽんの書いたfirstboot.asmです。 <br> ご迷惑をおかけいたします。 <>
ひげぽん<><>02/11/04 00:48<> 今日はつくづくハードウェアの知識が足りないと痛感。 <br> 勉強せねば。 <br> しかもあほなコード書くし･･･ <br> バグよりも性質が悪い･･･ <br> と、ぼやきでした。 <>
デフォルトの名無しさん<><>02/11/04 01:15<> <a href="../test/read.cgi/tech/1027080631/886" target="_blank">&gt;&gt;886</a> <br> 自分が馬鹿だと気づいただけでも上出来です。 <br> あなたには向上する余地が残っているということです。 <br> 安心めされい。 <>
デフォルトの名無しさん<>sage<>02/11/04 01:16<> ひげぽんは♀ですか？ <>
デフォルトの名無しさん<>sage<>02/11/04 02:34<> ♂→♀を♀と認められるなら、そうです。 <>
デフォルトの名無しさん<>sage<>02/11/04 05:12<> なにやら、NWSOSが着々とVerUPしてますな・・・ <>
ひげぽん<>sage<>02/11/04 13:04<> <a href="../test/read.cgi/tech/1027080631/888" target="_blank">&gt;&gt;888</a>,889 <br> ♂です。 <>
謎の探偵Ｘ<><>02/11/04 17:40<> 陰乍ら、応援してるけど・・・・ <br> 俺も勉強してみようかな・・・・ <br> ひげぽんさん、ファイd！ <>
デフォルトの名無しさん<>sage<>02/11/04 17:47<> ひげぽーん <br> IntelのPDF読んだ？ <br> 俺やっとフォーマット理解できたよ写し <>
ひげぽん<><>02/11/04 17:49<> <a href="../test/read.cgi/tech/1027080631/892" target="_blank">&gt;&gt;892</a> <br> ありがとうございます。 <br> 一緒に勉強しましょう(巻き添え） <br> <a href="../test/read.cgi/tech/1027080631/893" target="_blank">&gt;&gt;893</a> <br> &gt;ひげぽーん <br> &gt;IntelのPDF読んだ？ <br> &gt;俺やっとフォーマット理解できたよ写し <br> どの部分ですか。まだ1/4も読んでいないです。 <br> ごめんなさい。 <>
デフォルトの名無しさん<>sage<>02/11/04 17:52<> <a href="../test/read.cgi/tech/1027080631/893" target="_blank">&gt;&gt;893</a> <br> 何のPDF? <>
デフォルトの名無しさん<>sage<>02/11/04 18:38<> IA32 <>
デフォルトの名無しさん<>sage<>02/11/04 22:47<> ひょっとして、げーはなさん？ <>
デフォルトの名無しさん<>sage<>02/11/05 01:23<> http://www.intel.co.jp/jp/developer/design/litcentr/index.htm <br> Intelプロセッサーマニュアル <br>  <br> のことだよね？ <>
デフォルトの名無しさん<><>02/11/05 21:58<> 根本的で初歩的なこと聞きますが <br> 開発環境はどんなもんですか？ <br> Win+VisualCではなさげだけど・・・ <>
デフォルトの名無しさん<>sage<>02/11/05 22:00<> <a href="../test/read.cgi/tech/1027080631/899" target="_blank">&gt;&gt;899</a> <br> 過去ログ読め <>
ひげぽん<><>02/11/06 00:17<> <a href="../test/read.cgi/tech/1027080631/899" target="_blank">&gt;&gt;899</a> <br> 開発環境 <br> Windows + gnu_tool@cygwin + nasm <br> または <br> Linux + gnu_tool + nasm <br> です。 <>
デフォルトの名無しさん<><>02/11/06 16:07<> &gt;901 <br> windwowsではｗｉｎ用のnasmwを使ったほうがいいです。 <br> ｎａｓｍだと動きがチョット変じゃないですか？ <>
デフォルトの名無しさん<>sage<>02/11/06 19:18<> <a href="../test/read.cgi/tech/1027080631/902" target="_blank">&gt;&gt;902</a> <br> そんなこと無いと思います <br>  <br> windowsね！ <>
デフォルトの名無しさん<>sage<>02/11/06 20:19<> 動きが変というのは、多分NTでコマンドプロンプトを使っていると <br> 一度エミュレーションが走って過去のコンソールバッファが消えるとかじゃない？ <>
ひげぽん<><>02/11/07 00:29<> <a href="../test/read.cgi/tech/1027080631/902" target="_blank">&gt;&gt;902</a>,903,904 <br> 言葉足らずでした。Windows環境ではnasmwを使っています。 <br> すいませんm(__)m <br>  <br> ちょっと仕事が忙しくてあまり進展していないhigeposですが <br> 週末にはブートストラップ問題を片付けられればとおもいます。 <br> 新名称は Mona はどうでしょうか。 <br> 読み方は　もなー　または、　もな　。 <>
デフォルトの名無しさん<>sage<>02/11/07 00:53<> ひげぽんが良いと思う名前で良いと思います。 <br> 個人的には『x』を付けると響きが良いなぁと思うけど、LinuxとかUnixとは違いますもんね。 <br> MOna is Not unix. it is new operAting system　かなり苦しいです。ｗ <>
デフォルトの名無しさん<>sage<>02/11/07 01:29<> もなー（or もな） ：MOna is moNA <br>  <br> こんであかんのか？ <br> gnuだってそんなもんだろ？ <br>  <br> マスコットのリス、いいなぁと思いました。 <>
デフォルトの名無しさん<>sage<>02/11/07 01:45<> Mona Operating system is Not Atari <br>  <br> …古！！ <>
デフォルトの名無しさん<>sage<>02/11/07 01:49<> MONAPONがいい！ <>
デフォルトの名無しさん<>sage<>02/11/07 02:03<> Mona is Operating-system, Not Application! <>
デフォルトの名無しさん<>sage<>02/11/07 03:10<> &gt; Not Application! <br> 滅茶苦茶必死臭いな(藁 <>
FreeDOS教徒<>osage<>02/11/07 08:21<> <a href="../test/read.cgi/tech/1027080631/909" target="_blank">&gt;&gt;909</a> <br> ｲｲ!! <>
デフォルトの名無しさん<><>02/11/07 14:40<> a Microkernel Operating system for the Next Age. <br>  <br> 次世代のマイクロカーネルオペレーティングシステム。 <>
デフォルトの名無しさん<><>02/11/07 14:41<> <a href="../test/read.cgi/tech/1027080631/907" target="_blank">&gt;&gt;907</a> <br> リスの名前はmonaではなくmonax <>
デフォルトの名無しさん<><>02/11/07 15:03<> Mona is Operating-system, Not ASCII-Art! <>
デフォルトの名無しさん<>sage<>02/11/07 17:29<> んじゃNeXT信者な折れは <br> HiGESTEPかMoNASTEPで <>
デフォルトの名無しさん<>sage<>02/11/07 20:29<> Net/2みたいな感じで、Channel/2なんてどうよ？ <>
FreeDOS教徒<>osage<>02/11/07 20:59<> ひげぽんごめん。 <br>  <br> 原因わかった。ディスク読み込みでブートコード破壊してた。 <br> ブートコードをいったん上位のアドレスに移したらふつーに動いた。 <br>  <br> ・・・吊ってくるぽ（汗 <>
ひげぽん<><>02/11/07 21:52<> &gt;909 <br> MONAPONって英語圏の人にはなじむ語感なのかな? <br> ぽんぽんぽん <br> <a href="../test/read.cgi/tech/1027080631/913" target="_blank">&gt;&gt;913</a> <br> いいっすね。でもちょっとまじめすぎ？ <>
デフォルトの名無しさん<>sage<>02/11/07 22:53<> 普通にmonaxでいいじゃん <>
デフォルトの名無しさん<>sage<>02/11/07 22:57<> <a href="../test/read.cgi/tech/1027080631/920" target="_blank">&gt;&gt;920</a> <br> unixクローンと誤解されるのがいやなんじゃ? <>
ひげぽん<><>02/11/07 23:39<> &gt;&gt;FreeDOS教徒 <br> &gt;原因わかった。ディスク読み込みでブートコード破壊してた。 <br> &gt;ートコードをいったん上位のアドレスに移したらふつーに動いた。 <br> 直します。詳細を是非教えてください。 <br>  <br> <a href="../test/read.cgi/tech/1027080631/920" target="_blank">&gt;&gt;920</a> <br> <a href="../test/read.cgi/tech/1027080631/921" target="_blank">&gt;&gt;921</a> <br> &gt;unixクローンと誤解されるのがいやなんじゃ? <br> POSIX準拠だと思われたらかなわない･･･という意図はあります。 <br>  <>
デフォルトの名無しさん<><>02/11/08 00:14<> 名前よりまずは中身ｗ <>
デフォルトの名無しさん<><>02/11/08 00:17<> まじでＯＳ造ろうって言うのいんの？ <>
デフォルトの名無しさん<>sage<>02/11/08 00:33<> <a href="../test/read.cgi/tech/1027080631/924" target="_blank">&gt;&gt;924</a> <br> 現に<a href="../test/read.cgi/tech/1027080631/1" target="_blank">&gt;&gt;1</a>はそう申しておりますが <br>  <br> 漏れも言うだけなら言えるぞ <>
FreeDOS教徒<>osage<>02/11/08 05:03<> org 0 <br>  <br> start: <br> xor ax,ax <br> mov ds,ax <br> mov si,0x7c00 <br> mov ax,0x9e00 <br> mov es,ax <br> xor di,di <br> mov cx,0x0200 <br>  <br> rep movsb <br>  <br> jmp 0x9e00:next <br>  <br> next: <br> mov ds,ax <br> mov ax,0x8e00 <br> mov ss,ax <br> mov sp,0xfffe <br>  <br> 以下略（ぉ <br> まさか携帯でニーモニック打つとは思わなんだ。。 <>
デフォルトの名無しさん<>sage<>02/11/08 05:56<> <a href="../test/read.cgi/tech/1027080631/926" target="_blank">&gt;&gt;926</a> <br> ん？それをFDのブートセクトに書き込むと、起動するの？ <>
FreeDOS教徒<>osage<>02/11/08 06:48<> <a href="../test/read.cgi/tech/1027080631/927" target="_blank">&gt;&gt;927</a> <br> このままでも一応動くけど・・・ <br>  <br> &gt;&gt;ひげぽん <br> これを適切な位置に置き換えて使ってぽ。 <br> firstboot.asmが手元にないけど、ちょっと書き替えたら動くはず。 <>
デフォルトの名無しさん<><>02/11/08 18:53<> MIPSﾏﾝｾｰ！！ <br> x86なんて糞ですよ(マジで)。 <>
デフォルトの名無しさん<>sage<>02/11/08 19:11<> ARMﾏﾝｾｰ！！ <br> MIPSなんて糞ですよ(マジで)。 <>
デフォルトの名無しさん<>sage<>02/11/08 19:33<> x86ﾏﾝｾｰ！！ <br> ARMなんて糞ですよ(マジで)。 <>
ひげぽん<><>02/11/09 00:41<> <a href="../test/read.cgi/tech/1027080631/928" target="_blank">&gt;&gt;928</a> ：FreeDOS教徒さん <br> 携帯からの入力thanx!! <br>  <br> ところで <br> &gt;原因わかった。ディスク読み込みでブートコード破壊してた <br> これは、 <br> 最初の512byteだけですか、それとも？？？ <br> ブートコードを破壊してる場所が明確で、修正が簡単に可能ならば <br> そちらを修正しようと思っています。 <br>  <br> &gt;start: <br> &gt;xor ax,ax <br> &gt;mov ds,ax <br> &gt;mov si,0x7c00 <br> &gt;mov ax,0x9e00 <br> &gt;mov es,ax <br> &gt;xor di,di <br> &gt;mov cx,0x0200 <br> &gt;rep movsb <br>  <br> 0x7c00:0000→0x9e00:0000へ1024byte分コピー <>
ひげぽん<><>02/11/09 00:43<> mp 0x9e00:next <br>  <br> &gt;next: <br> &gt;mov ds,ax <br> &gt;mov ax,0x8e00 <br> &gt;mov ss,ax <br> &gt;mov sp,0xfffe <br> 上位アドレス0x9e00:nextにて実行を続行？？？ <br>  <br> ちょっと今日は、特に頭が回らない・・・ <br> 明日考えます。 <>
 <>sage<>02/11/09 06:54<> show-mona... <>
FreeDOS教徒<>osage<>02/11/09 07:45<> &gt;&gt;ひげぽん <br> 54セクタ読もうとすると <br> 0x1000+(0x200*0x36)=0x7c00 <br> でブートコードを破壊するのは分かりますよね。 <br>  <br> だからブートコードを上位の空きメモリに移してそこで実行を続けています。 <br> こうすることで最大640KB程度のカーネルまで読み込めるはずです。 <>
FreeDOS教徒<>osage<>02/11/09 08:04<> ちょっとつっこみ。 <br>  <br> ×0x7c00:0000 <br> ○0x07c0:0000(0x0000:7c00) <br> ×1024バイト読み込み <br> ○512バイト読み込み <>
929<>sage<>02/11/09 22:34<> はじめて読む486っていう本読みました？＞ひげぽそ <>
デフォルトの名無しさん<>sage<>02/11/10 02:05<> <a href="../test/read.cgi/tech/1027080631/937" target="_blank">&gt;&gt;937</a> <br> まぁ、過去ログでも読めや <>
ひげぽん<><>02/11/10 15:30<> FreeDOS教徒さん <br>  <br> ひげぽんの遅い理解を以下にまとめて見ます。 <br> 間違い等ありましたら、突っ込みをお願いいたします。 <br>  <br>  <br> 512byteのブートコードは　0x07C0:0000(0000:0x7C00)　に読み込まれます。 <br>  <br> そのブートコード中では　0x0100:0000(0000:0x1000)　をバッファの先頭として <br> 後続のコードをFDより読み込みます。 <br>  <br> ところが54セクタ読み込むと <br>  <br> 読み込まれるサイズは　512byte　*　54　=　0x6C00　となり <br> 0x0100:0000(0000:0x1000)　から読み込んだ場合 <br> 0x07C0:0000(0000:0x7C00)　にあるブートコードを上書きしてしまいます。 <br>  <br> これが問題となるのは <br> secondboot.bin　+　third.binのコードサイズが <br> 54セクタ(512　*　54　=　27Kbyte)を超えたときです。 <br>  <br> これを回避するためにFreeDOS教徒さんは <br>  <br> ブートコードが　0x07C0:0000(0000:0x7C00)　が読み込まれて実行されている <br> 途中でブートコードを <br> まるごと　0x9E00:0000(0000:0x9E000)　へコピーしてそちらで実行を続けるという策を <br> とられています。 <br>  <br> この方法を使えば理論上 <br> (0x9E000　-　0x1000)　=　628kbyte　まで読み込むことが可能になります。 <>
ひげぽん<><>02/11/10 15:31<> <a href="../test/read.cgi/tech/1027080631/937" target="_blank">&gt;&gt;937</a> <br> いぜんhigeposのブートコードを書くときに <br> エイッと読んでいたのですが、すっかり忘れていました。 <br> もう一度読み返しているところです。 <>
デフォルトの名無しさん<>sage<>02/11/10 20:58<> ブーに注意 <>
FreeDOS教徒<>osage<>02/11/10 23:16<> &gt;&gt;ひげぽんさん <br> それで正解です。ただ実際に示したコードや移すアドレスは詰めが甘いので、適宜書き換えて使われてください。 <>
デフォルトの名無しさん<><>02/11/10 23:29<> <a href="../test/read.cgi/tech/1027080631/942" target="_blank">&gt;&gt;942</a> FreeDOS教徒 さん <br>  <br> &gt;それで正解です。 <br> ありがとうございます。 <br>  <br> &gt;ただ実際に示したコードや移すアドレスは詰めが甘いので、適宜書き換えて使われてください。 <br> 　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　~~~~~~~~~~~~~~~ <br> 　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　↑ <br> 　　　　　　　　　　　　　　　　　　　　　　　　　　この辺が重要なんでしょうね。 <br> ちょっとうまくいっていないのですが、もう少しがんばってみます。 <>
ひげぽん<><>02/11/11 21:15<> <a href="../test/read.cgi/tech/1027080631/943" target="_blank">&gt;&gt;943</a>の書き込みは私です。 <br>  <br> ブートコード問題多分解決しますた。 <br> 今現在higepos PJメンバーに動作確認してもらっています。 <>
デフォルトの名無しさん<>sage<>02/11/11 22:17<> Linux(not cross)で動作確認OKでした。 <>
ひげぽん<><>02/11/11 22:25<> <a href="../test/read.cgi/tech/1027080631/945" target="_blank">&gt;&gt;945</a> <br> ありがとうございます。 <br> 原因は後ほど、報告いたします。 <>
ひげぽん<><>02/11/11 22:57<> 確認が取れましたので <br>  <br> ■現象 <br> 最新版マルチセクタ読み込みfirstboot.asmで正しく <br> 読み込まれているはずなのに、 <br>  <br> int_trap_gate(): selector nullのエラーがでる。 <br>  <br> ■原因 <br>  <br> idtrのアドレスがhigeIdt.hで0x6800に設定されていました。 <br> これじゃあ上書きされてしまいます。 <br>  <br> ■対処 <br>  <br> higeIdt.h:0x6800→0x0500(ここなら安全か？？) <>
LightCone </b>◆sSJBc30S5w <b><>sage<>02/11/12 10:33<> <a href="../test/read.cgi/tech/1027080631/947" target="_blank">&gt;&gt;947</a> <br> ひげぽんさん。お久しぶりです。 <br>  <br> お忙しいならご返答は適当でいいのですが、DISK BIOSでセクタを <br> 読むとき、複数回のBIOS呼び出しで、1セクタずつ読むより、 <br> 連続セクタを一回のBIOS呼び出しで読んだ方がやはり速いんでしょうか？ <>
超先生@OS板  </b>◆mz/OS/KoRM <b><>sage<>02/11/12 12:21<>   　∧＿∧ <br> ＜　｀ー´＞-~~~ <br> PC/AT機のBIOSだと、readコール発行する毎に <br> シリンダをシークしてるような機械的挙動ですね。 <br> 1セクタ毎だと倍程度の読み込み時間がかかってしまう。 <>
デフォルトの名無しさん<><>02/11/12 15:37<> &gt;947 ひげぽんさん <br> &gt;■原因 <br> &gt; <br> &gt;idtrのアドレスがhigeIdt.hで0x6800に設定されていました。 <br> &gt;これじゃあ上書きされてしまいます。 <br> &gt; <br> &gt;■対処 <br> &gt; <br> &gt;higeIdt.h:0x6800→0x0500(ここなら安全か？？) <br>  <br> 配列を使えば，そんなもんだいは解決します。 <br>  <br> ソースはこんな感じで <br>     idt_st idt[HANDLER_NUM]; <br>      <br>     for (int i=0;i &lt; HANDLER_NUM; i++) <br>     { <br>         void* p = handlers[i].handler; <br>         idt[i].offsetL  =  (int)(p)           & 0xFFFF; <br>         idt[i].offsetH  = ((int)(p) &gt;&gt; 16 & 0xFFFF ; <br>         idt[i].selector = 0x08; <br>         idt[i].type     = 0x8E; <br>         idt[i].unused   = IDT_UNUSED; <br>     } <br>  <br>     idtr.limit    = sizeof(idt_st) * HANDLER_NUM -1; <br>     idtr.highbase = (int)(&idt) &gt;&gt; 16 & 0xffff;  <br>     idtr.lowbase  = (int)(&idt)       & 0xffff; <br>  <>
ひげぽん<><>02/11/12 18:06<> LightConeさん、超先生@OS板さんおひさしぶりです。 <br>  <br> LightConeさんwrote <br> &gt;お忙しいならご返答は適当でいいのですが、DISK BIOSでセクタを <br> &gt;読むとき、複数回のBIOS呼び出しで、1セクタずつ読むより、 <br> &gt;連続セクタを一回のBIOS呼び出しで読んだ方がやはり速いんでしょうか？ <br> 超先生@OS板さん wrote <br> &gt;PC/AT機のBIOSだと、readコール発行する毎に <br> &gt;シリンダをシークしてるような機械的挙動ですね。 <br> &gt;1セクタ毎だと倍程度の読み込み時間がかかってしまう。 <br>  <br> 数値で具体的に示せないのが申し訳ないのですが <br> 1セクタ毎だと60セクタ程度でもちょっと遅いと体感できます。 <br> 1秒にも満たない時間ですが･･･ <br>  <>
ひげぽん<><>02/11/12 18:24<> <a href="../test/read.cgi/tech/1027080631/950" target="_blank">&gt;&gt;950</a> <br> ありがとうございます。 <br> なるほどそんな方法があるのですね。 <br> ちょっと良く考えてみます。 <>
FreeDOS教徒<>osage<>02/11/12 19:14<> そろそろ次スレ立てねぇ？＞ひげぽん <>
ひげぽん<><>02/11/12 19:22<> <a href="../test/read.cgi/tech/1027080631/953" target="_blank">&gt;&gt;953</a> <br> 次スレたてますた。 <br> こちらへ移行をお願いします。 <br> http://pc3.2ch.net/test/read.cgi/tech/1037096449/ <>
LightCone </b>◆sSJBc30S5w <b><>sage<>02/11/13 07:41<> <a href="../test/read.cgi/tech/1027080631/951" target="_blank">&gt;&gt;951</a> <br> お忙しい所、返答有難うございます。 <br>  <br> &gt;数値で具体的に示せないのが申し訳ないのですが <br> &gt;1セクタ毎だと60セクタ程度でもちょっと遅いと体感できます。 <br> &gt;1秒にも満たない時間ですが･･･ <br>  <br> これは、60セクタ程度を、1セクタずつBIOSコールで読み込むのが、 <br> トータル1秒未満で行える、ということですか。 <br>  <br> 間違っていたらすみません。 <>
LightCone </b>◆sSJBc30S5w <b><>sage<>02/11/13 07:50<> <a href="../test/read.cgi/tech/1027080631/955" target="_blank">&gt;&gt;955</a> <br> higeposのソースを見てみると、最大1トラック(18セクタ)をちゃんと <br> 一度に読むようになってるみたいですね。 <>
デフォルトの名無しさん<>qffbpp<>02/12/08 02:28<>          <>
デフォルトの名無しさん<>sage<>02/12/09 23:32<> うめてよいよね？ <br>  <br>  <br>  <br> だめ？ <>
デフォルトの名無しさん<>sage<>02/12/10 16:02<> <a href="../test/read.cgi/tech/1027080631/958" target="_blank">&gt;&gt;958</a> <br> 協力しましょう。 <>
デフォルトの名無しさん<>たまには釣られてみるか...。<>02/12/10 22:44<> <a href="../test/read.cgi/tech/1027080631/958" target="_blank">&gt;&gt;958</a> <br> いいと思うよ。 <>
デフォルトの名無しさん<>sage<>02/12/11 00:56<> また〜りと　うめたて <>
ひげぽん<>sage<>02/12/11 00:57<> 気づいてしまいました（笑） <>
デフォルトの名無しさん<>sage<>02/12/11 12:50<> まったり埋め立て作業中 <>
sage<><>02/12/11 14:24<> うめ <>
デフォルトの名無しさん<>sage<>02/12/11 19:11<> 本当にまったりだね。ひげぽんの人徳ですな。 <>
デフォルトの名無しさん<>sage<>02/12/12 00:25<> だよねー。ひげぽんちゃんと頑張ってたし、適度に高度な話題だから、厨房が寄り付かなかったしね。 <>
デフォルトの名無しさん<>sage<>02/12/12 20:34<> 上げないでね <>
sage<>sage<>02/12/12 22:23<> sageつつ、埋め！ <>
デフォルトの名無しさん<>sage<>02/12/12 23:34<> 本擦れ上げた方がいいんじゃない？とかいいつつ埋め！ <>
みとこ  </b>◆AEqcy/sQU6 <b><>sage<>02/12/13 21:14<> ヽ(｀ー´)ノ <>
超先生＠OS板  </b>◆leaf/RYZgY <b><>sage<>02/12/13 21:16<> |[Aqua+]|ー´＞埋め立てるならｲﾏﾉｳﾁ <>
超先生＠OS板  </b>◆leaf/RYZgY <b><>sage<>02/12/13 21:16<> |[Aqua+]|ー´＞埋め立てるならｲﾏﾉｳﾁ <>
ひげぽん<>sage<>02/12/13 21:24<> ( ﾟдﾟ) <>
デフォルトの名無しさん<>sage<>02/12/13 23:24<> ひげぽんさんだ！がんばって！！ 埋め埋め埋め <>
偽ひげぽん<>sage<>02/12/14 07:04<> 埋めまくり（・∀・) <>
うふぅ<>sage<>02/12/15 01:29<> ドキドキ・・・ <>
うふぅ<>sage<>02/12/15 01:30<> ドッキンキン <>
うめ<>sage<>02/12/15 03:15<> うめまするぅ〜 <>
ひげぽん<>sage<>02/12/15 11:12<> ┐(´∇｀)┌本物 <>
デフォルトの名無しさん<>sage<>02/12/15 21:04<> うめ <>
デフォルトの名無しさん<>sage<>02/12/15 21:06<> うっめ〜〜〜〜っ。 <>
